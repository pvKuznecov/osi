"use strict";(self["webpackChunkosi"]=self["webpackChunkosi"]||[]).push([[143],{5619:function(e,s,t){t.d(s,{T:function(){return l}});var n=t(2261),i=t(144);const l=(0,n.nY)("apps",()=>{const e=(0,i.KR)({}),s=(s,t)=>{s&&(e.value[s]={...e.value[s],...t,lastUpdated:Date.now()},console.log("State saved for window:",s,e.value[s]))},t=s=>s&&e.value[s]||null,n=s=>{s&&delete e.value[s]},l=()=>{e.value={}},a=(s,t)=>{if(!t)return null;const n=e.value[t];return n&&n.appType===s?n:null};return{windowStates:e,saveWindowState:s,getWindowState:t,deleteWindowState:n,clearAllStates:l,getAppState:a}})},6524:function(e,s,t){t.r(s),t.d(s,{default:function(){return m}});var n=t(6768),i=t(4232);const l={class:"calculator-app"},a={class:"calculator-display"},r={class:"expression"},o={class:"result"},c={class:"calculator-buttons"},u=["disabled"],p={class:"calculator-history"},_=["onClick"];function d(e,s){return(0,n.uX)(),(0,n.CE)("div",l,[(0,n.Lk)("div",a,[(0,n.Lk)("div",r,(0,i.v_)(e.expression||"0"),1),(0,n.Lk)("div",o,(0,i.v_)(e.result),1)]),(0,n.Lk)("div",c,[(0,n.Lk)("button",{class:"calc-btn clear",onClick:s[0]||(s[0]=(...s)=>e.clearAll&&e.clearAll(...s))},"C"),(0,n.Lk)("button",{class:"calc-btn clear",onClick:s[1]||(s[1]=(...s)=>e.clearEntry&&e.clearEntry(...s))},"CE"),(0,n.Lk)("button",{class:"calc-btn operation",onClick:s[2]||(s[2]=(...s)=>e.backspace&&e.backspace(...s))},"⌫"),(0,n.Lk)("button",{class:"calc-btn operation",onClick:s[3]||(s[3]=s=>e.appendOperation("÷"))},"÷"),(0,n.Lk)("button",{class:"calc-btn number",onClick:s[4]||(s[4]=s=>e.appendNumber("7"))},"7"),(0,n.Lk)("button",{class:"calc-btn number",onClick:s[5]||(s[5]=s=>e.appendNumber("8"))},"8"),(0,n.Lk)("button",{class:"calc-btn number",onClick:s[6]||(s[6]=s=>e.appendNumber("9"))},"9"),(0,n.Lk)("button",{class:"calc-btn operation",onClick:s[7]||(s[7]=s=>e.appendOperation("×"))},"×"),(0,n.Lk)("button",{class:"calc-btn number",onClick:s[8]||(s[8]=s=>e.appendNumber("4"))},"4"),(0,n.Lk)("button",{class:"calc-btn number",onClick:s[9]||(s[9]=s=>e.appendNumber("5"))},"5"),(0,n.Lk)("button",{class:"calc-btn number",onClick:s[10]||(s[10]=s=>e.appendNumber("6"))},"6"),(0,n.Lk)("button",{class:"calc-btn operation",onClick:s[11]||(s[11]=s=>e.appendOperation("-"))},"-"),(0,n.Lk)("button",{class:"calc-btn number",onClick:s[12]||(s[12]=s=>e.appendNumber("1"))},"1"),(0,n.Lk)("button",{class:"calc-btn number",onClick:s[13]||(s[13]=s=>e.appendNumber("2"))},"2"),(0,n.Lk)("button",{class:"calc-btn number",onClick:s[14]||(s[14]=s=>e.appendNumber("3"))},"3"),(0,n.Lk)("button",{class:"calc-btn operation",onClick:s[15]||(s[15]=s=>e.appendOperation("+"))},"+"),(0,n.Lk)("button",{class:"calc-btn number zero",onClick:s[16]||(s[16]=s=>e.appendNumber("0"))},"0"),(0,n.Lk)("button",{class:"calc-btn number",onClick:s[17]||(s[17]=s=>e.appendDecimal())},"."),(0,n.Lk)("button",{class:"calc-btn equals",onClick:s[18]||(s[18]=(...s)=>e.calculateAndAddHistory&&e.calculateAndAddHistory(...s)),disabled:!e.expression},"=",8,u)]),(0,n.Lk)("div",p,[s[20]||(s[20]=(0,n.Lk)("h3",null,"История",-1)),(0,n.Lk)("ul",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.reversedHistory,(s,t)=>((0,n.uX)(),(0,n.CE)("li",{key:t,onClick:t=>e.useHistoryItem(s)},(0,i.v_)(s.expression)+" = "+(0,i.v_)(s.result),9,_))),128))]),e.history.length>0?((0,n.uX)(),(0,n.CE)("button",{key:0,class:"clear-history",onClick:s[19]||(s[19]=(...s)=>e.clearHistory&&e.clearHistory(...s))},"Очистить историю")):(0,n.Q3)("",!0)])])}var h=t(7292),b=t(1241);const k=(0,b.A)(h.A,[["render",d]]);var m=k},7292:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){var core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(4114),core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__),_stores_apps_store__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(5619),pinia__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(2261);__webpack_exports__.A={name:"CalculatorApp",props:{windowId:{type:String,required:!0}},data(){return{expression:"",result:"0",history:[],lastResult:null}},computed:{...(0,pinia__WEBPACK_IMPORTED_MODULE_2__.n2)(_stores_apps_store__WEBPACK_IMPORTED_MODULE_1__.T),reversedHistory(){return[...this.history].reverse().slice(0,5)}},watch:{history:{handler(){this.saveState()},deep:!0}},methods:{initFromStore(){if(!this.windowId)return;const e=this.appsStore.getWindowState(this.windowId);e&&(this.expression=e.expression||"",this.result=e.result||"0",this.history=e.history||this.history,this.lastResult=e.lastResult||null)},saveState(){if(!this.windowId||!this.appsStore)return;const e={appType:"calculator",expression:this.expression,result:this.result,lastResult:this.lastResult,history:[...this.history],timestamp:Date.now()};this.appsStore.saveWindowState(this.windowId,e)},appendNumber(e){null===this.lastResult||this.expression.includes("+")||this.expression.includes("-")||this.expression.includes("×")||this.expression.includes("÷")||(this.expression="",this.lastResult=null),this.expression+=e,this.calculate()},appendOperation(e){if(this.expression){const s=this.expression.slice(-1);["+","-","×","÷"].includes(s)?this.expression=this.expression.slice(0,-1)+e:this.expression+=e}else{if(null===this.lastResult)return;this.expression=this.lastResult+e}this.lastResult=null},appendDecimal(){!this.expression||["+","-","×","÷"].includes(this.expression.slice(-1))?this.expression+="0.":this.expression.split(/[+\-×÷]/).pop().includes(".")||(this.expression+=".")},calculate(){if(this.expression)try{let expr=this.expression.replace(/×/g,"*").replace(/÷/g,"/"),calcResult=eval(expr);calcResult%1!==0&&(calcResult=parseFloat(calcResult.toFixed(10))),this.result=calcResult}catch(error){this.result="Ошибка"}else this.result="0"},calculateAndAddHistory(){if(!this.expression)return;const e=this.expression;this.calculate(),"Ошибка"!==this.result&&(this.addToHistory(e,this.result),this.lastResult=this.result,this.expression="")},addToHistory(e,s){this.history.push({expression:e||this.expression,result:s||this.result,timestamp:(new Date).toLocaleTimeString()})},clearAll(){this.expression="",this.result="0",this.lastResult=null},clearEntry(){this.expression="",this.calculate()},backspace(){this.expression&&(this.expression=this.expression.slice(0,-1),this.calculate())},clearHistory(){this.history=[]},useHistoryItem(e){this.expression=e.expression,this.result=e.result,this.lastResult=e.result},handleKeyPress(e){const s=e.key;/[0-9]/.test(s)?(this.appendNumber(s),e.preventDefault()):"+"===s?(this.appendOperation("+"),e.preventDefault()):"-"===s?(this.appendOperation("-"),e.preventDefault()):"*"===s?(this.appendOperation("×"),e.preventDefault()):"/"===s?(this.appendOperation("÷"),e.preventDefault()):"."===s||","===s?(this.appendDecimal(),e.preventDefault()):"Enter"===s||"="===s?(this.calculateAndAddHistory(),e.preventDefault()):"Escape"===s?(this.clearAll(),e.preventDefault()):"Backspace"===s&&(this.backspace(),e.preventDefault())}},mounted(){console.log("AppWiki mounted with windowId:",this.windowId),window.addEventListener("keydown",this.handleKeyPress),this.initFromStore()},beforeUnmount(){window.removeEventListener("keydown",this.handleKeyPress)}}}}]);
//# sourceMappingURL=143.4bf4b742.js.map