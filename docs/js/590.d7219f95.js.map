{"version":3,"file":"js/590.d7219f95.js","mappings":"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","sources":["webpack://osi/./src/apps/system/OSIAppManager/template.html","webpack://osi/./src/apps/system/OSIAppManager/OSIAppManager.vue","webpack://osi/./src/apps/system/OSIAppManager/OSIAppManager.vue?0477"],"sourcesContent":["<div class=\"appmanager-app\">\n    <div class=\"row\">\n        <div class=\"search-area\">\n            <label for=\"search_input\">Поиск:</label>\n            <input id=\"search_input\" type=\"text\" v-model=\"searchInputTxt\">\n        </div>\n        \n        <div v-if=\"isNeedReload\" class=\"warning-text-area\">\n            <h3>Для того, чтобы изменения вступили в силу, необходимо перезагрузить систему.</h3>\n            <div @click=\"reloadPage()\">Перезагрузить</div>\n        </div>\n        <div v-else></div>\n\n        <div v-if=\"searchInputTxt.length ===0\" class=\"appslist-area\">\n            <div v-for=\"cat in Object.keys(sortedAppsByCategory)\" :key=\"cat\">\n                <h3>{{cat}}</h3>\n                <div class=\"row\">\n                    <div v-for=\"app in sortedAppsByCategory[cat]\" :key=\"app.id\" class=\"appslist-elem col-4 d-flex\">\n                        <div class=\"appslist-elem-ico d-flex justify-content-center align-items-center\" :class=\"app.iconclass || ''\" :style=\"app.iconclass ? 'color: white' : ''\" @click=\"launchApp(app)\"></div>\n                        <div class=\"appslist-elem-info\">\n                            <div class=\"appslist-elem-showDesk d-flex justify-content-center align-items-center\" title=\"Отображать на рабочем столе.\">\n                                <i class=\"bi bi-display-fill me-1\"></i>\n                                <input type=\"checkbox\" name=\"\" :id=\"app.id + '_showOnDesktop'\" v-model=\"app.showOnDesktop\" :checked=\"app.showOnDesktop\" @change=\"Chng_showOnDesktop(app)\">\n                            </div>\n                            <div class=\"appslist-elem-showStart d-flex justify-content-center align-items-center\" title=\"Отображать в меню запуска.\">\n                                <i class=\"bi bi-house-fill me-1\"></i>\n                                <input type=\"checkbox\" name=\"\" :id=\"app.id + '_showInStartMenu'\" :checked=\"app.showInStartMenu\" v-model=\"app.showInStartMenu\" @change=\"Chng_showInStartMenu(app)\">\n                            </div>\n                            <i class=\"appslist-elem-category\">{{app.category}}</i>\n                            <h3>{{app.label}}</h3>\n                            <i>{{app.description}}</i>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div v-else class=\"appslist-area\">\n            <div v-if=\"hasSearchResults\">\n                <h3>Результаты поиска</h3>\n                <div class=\"row\">\n                    <div v-for=\"app in filteredApps\" :key=\"app.id\" class=\"appslist-elem col-4 d-flex\">\n                        <div class=\"appslist-elem-ico d-flex justify-content-center align-items-center\" :class=\"app.iconclass || ''\" :style=\"app.iconclass ? 'color: white' : ''\" @click=\"launchApp(app)\"></div>\n                        <div class=\"appslist-elem-info\">\n                            <div class=\"appslist-elem-showDesk d-flex justify-content-center align-items-center\">\n                                <i class=\"bi bi-display-fill me-1\"></i>\n                                <input type=\"checkbox\" name=\"\" :id=\"app.id + '_showOnDesktop'\" v-model=\"app.showOnDesktop\" :checked=\"app.showOnDesktop\" @change=\"Chng_showOnDesktop(app)\">\n                            </div>\n                            <div class=\"appslist-elem-showStart d-flex justify-content-center align-items-center\">\n                                <i class=\"bi bi-house-fill me-1\"></i>\n                                <input type=\"checkbox\" name=\"\" :id=\"app.id + '_showInStartMenu'\" :checked=\"app.showInStartMenu\" v-model=\"app.showInStartMenu\" @change=\"Chng_showInStartMenu(app)\">\n                            </div>\n                            <i class=\"appslist-elem-category\">{{app.category}}</i>\n                            <h3>{{app.label}}</h3>\n                            <i>{{app.description}}</i>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div v-else class=\"no-results\">Ничего не найдено по запросу \"{{searchInputTxt}}\"</div>\n        </div>\n    </div>\n</div>","<template src=\"./template.html\"></template>\n<style src=\"./style.css\"></style>\n<script>\n    import { appsConfig } from '@/config/applications';\n    import { usersTable } from '@/idb/db';\n\n    export default {\n        name: 'OSIAppManager',\n\n        props: {\n            windowId: {type: String, required: true},\n            USERID: {type: Number, default: 0},\n        },\n\n        inject: [ 'reloadDesk' ],\n\n        data() {\n            return {\n                appsList: [],\n                searchInputTxt: '',\n                USERApps: [],\n                USER: null,\n                isNeedReload: false,\n            }\n        },\n\n        computed: {\n            // Отфильтрованные приложения по поисковому запросу\n            filteredApps() {\n                if (!this.searchInputTxt.trim()) {\n                    return this.USERApps;\n                } else {\n                    const query = this.searchInputTxt.toLowerCase().trim();\n\n                    return this.USERApps.filter(app => {\n                        // Ищем по label и description для лучшего поиска\n                        return app.label.toLowerCase().includes(query) || \n                            (app.description && app.description.toLowerCase().includes(query));\n                    });\n                }\n            },\n\n            // Группировка по категориям для обычного отображения\n            sortedAppsByCategory() {\n                const resultObj = {};\n                \n                this.USERApps.forEach(element => {\n                    const category = element.category;\n                    \n                    if (!resultObj[category]) { \n                        resultObj[category] = []; \n                    }\n                    resultObj[category].push(element);\n                });\n\n                // Сортировка внутри категорий по названию (label)\n                Object.keys(resultObj).forEach(key => {\n                    resultObj[key].sort((a, b) => {\n                        return a.label.localeCompare(b.label);\n                    });\n                });\n\n                return resultObj;\n            },\n\n            // Проверка есть ли результаты поиска\n            hasSearchResults() { return this.filteredApps.length > 0; },\n\n            // Есть ли поисковый запрос\n            isSearching() { return this.searchInputTxt.trim().length > 0; },\n        },\n\n        async mounted() {\n            const defAppsList = appsConfig.getAllApps();\n            const findUserApps = await usersTable.getApps(this.USERID);\n\n            await this.findUser();\n\n            this.appsList = defAppsList;\n            this.USERApps = (findUserApps) ? findUserApps : defAppsList;\n        },\n\n        methods: {\n            // перезагрузка страницы\n            reloadPage() { document.location.reload(); },\n\n            async findUser() {\n                try {                    \n                    this.USER = await usersTable.getbyId(this.USERID);\n                } catch (error) {\n                    console.error('Ошибка поиска пользователя:', error);\n                    this.$toast.error('Не удалось загрузить данные пользователя');\n                }\n            },\n\n            async Chng_showOnDesktop(app) {\n                try {\n                    const appId = app.id;\n\n                    await usersTable.updateAppSetting(this.USERID, appId, 'showOnDesktop', app.showOnDesktop);\n                    this.reloadDesk();\n                } catch (error) {\n                    console.error('Ошибка обновления данных:', error);\n                }\n            },\n            async Chng_showInStartMenu(app) {\n                try {\n                    const appId = app.id;\n                    \n                    await usersTable.updateAppSetting(this.USERID, appId, 'showInStartMenu', app.showInStartMenu);\n                    // TODO: пока это перезапишет в indexeddb конфиг в учетке, но не приведет к динамическому перестроению меню \"пуск\", надо подумать\n                    this.isNeedReload = true;\n                } catch (error) {\n                    console.error('Ошибка обновления данных:', error);\n                }\n            },\n\n            async launchApp(appData) {                \n                if (!this.USERID) {\n                    console.error('USERID not set');\n                    return;\n                }\n                \n                try {\n                    // Ищем существующее окно по конфигурации приложения\n                    const existWindow_byConfig = await usersTable.windows.getWindow_byConfig(this.USERID, appData);\n                    \n                    // окно есть и оно свернуто\n                    if (existWindow_byConfig && existWindow_byConfig.isMinimized) {\n                        console.log('point-2 - Window exists and is minimized, restoring...');\n                        \n                        // Вариант 1: Используем activate (рекомендуется, если activate снимает свернутость)\n                        await usersTable.windows.activate(this.USERID, existWindow_byConfig.id);\n                        \n                        // Вариант 2: Если есть отдельный метод restore\n                        // if (usersTable.windows.restore) {\n                        //     await usersTable.windows.restore(this.USERID, existWindow_byConfig.id);\n                        // } else {\n                        //     await usersTable.windows.activate(this.USERID, existWindow_byConfig.id);\n                        // }\n                    } else if (existWindow_byConfig) {  // окно есть и оно НЕ свернуто\n                        await usersTable.windows.activate(this.USERID, existWindow_byConfig.id);\n                    } else {    // окна нет - создаем новое                        \n                        // Создаем новое окно с параметрами из appData\n                        await usersTable.windows.create(this.USERID, { \n                            ...appData,\n                            isMinimized: false, // Новое окно не свернуто\n                        });\n                    }\n                    \n                    // Обновляем список окон для синхронизации\n                    await usersTable.windows.reupdate(this.USERID);\n                    \n                    console.log('Launch app completed');                    \n                } catch (error) {\n                    console.error('Error in launchApp:', error);\n                }\n            },\n        },\n    }\n</script>","import { render } from \"./template.html?vue&type=template&id=27647e72&external\"\nimport script from \"./OSIAppManager.vue?vue&type=script&lang=js\"\nexport * from \"./OSIAppManager.vue?vue&type=script&lang=js\"\n\nimport \"./style.css?vue&type=style&index=0&lang=css&external\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","title","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","for","id","type","_ctx","searchInputTxt","$event","isNeedReload","_hoisted_4","onClick","_cache","reloadPage","_hoisted_5","length","_hoisted_6","_Fragment","_renderList","Object","keys","sortedAppsByCategory","cat","key","_toDisplayString","_hoisted_7","app","_normalizeClass","iconclass","style","_normalizeStyle","launchApp","_hoisted_9","_hoisted_10","name","showOnDesktop","checked","onChange","Chng_showOnDesktop","_hoisted_12","showInStartMenu","Chng_showInStartMenu","_hoisted_14","category","label","description","_hoisted_15","hasSearchResults","_hoisted_16","_hoisted_17","filteredApps","_hoisted_19","_hoisted_20","_hoisted_22","_hoisted_24","_hoisted_25","props","windowId","String","required","USERID","Number","default","inject","data","appsList","USERApps","USER","computed","this","trim","query","toLowerCase","filter","includes","resultObj","forEach","element","push","sort","a","b","localeCompare","isSearching","mounted","defAppsList","appsConfig","getAllApps","findUserApps","usersTable","getApps","findUser","methods","document","location","reload","getbyId","error","console","$toast","appId","updateAppSetting","reloadDesk","appData","existWindow_byConfig","windows","getWindow_byConfig","isMinimized","log","activate","create","reupdate","__exports__","render"],"ignoreList":[],"sourceRoot":""}