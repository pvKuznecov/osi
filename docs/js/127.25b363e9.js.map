{"version":3,"file":"js/127.25b363e9.js","mappings":"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","sources":["webpack://osi/./src/stores/apps.store.js","webpack://osi/./src/apps/learn/AppWiki/AppWiki.vue","webpack://osi/./src/apps/learn/AppWiki/AppWiki.vue?15ee"],"sourcesContent":["import { defineStore } from 'pinia';\nimport { ref } from 'vue';\n\nexport const useAppsStore = defineStore('apps', () => {\n    // Храним состояния окон по их ID\n    const windowStates = ref({});\n    \n    // Сохранить состояние окна\n    const saveWindowState = (windowId, state) => {\n        if (!windowId) return;\n        \n        windowStates.value[windowId] = {\n            ...windowStates.value[windowId],\n            ...state,\n            lastUpdated: Date.now()\n        };\n        \n        console.log('State saved for window:', windowId, windowStates.value[windowId]);\n    };\n    \n    // Получить состояние окна\n    const getWindowState = (windowId) => {\n        if (!windowId) return null;\n        return windowStates.value[windowId] || null;\n    };\n    \n    // Удалить состояние окна\n    const deleteWindowState = (windowId) => {\n        if (!windowId) return;\n        delete windowStates.value[windowId];\n    };\n    \n    // Очистить все состояния\n    const clearAllStates = () => {\n        windowStates.value = {};\n    };\n    \n    // Получить состояние конкретного приложения по типу\n    const getAppState = (appType, windowId) => {\n        if (!windowId) return null;\n        const state = windowStates.value[windowId];\n        return state && state.appType === appType ? state : null;\n    };\n    \n    return {\n        windowStates,\n        saveWindowState,\n        getWindowState,\n        deleteWindowState,\n        clearAllStates,\n        getAppState\n    };\n});","<template>\n    <div class=\"browser-app\">    \n        <!-- Панель управления браузером -->\n        <div class=\"browser-controls\" v-if=\"showControls\">\n            <div class=\"url-bar\">\n                <button @click=\"goBack\" :disabled=\"!canGoBack\" title=\"Назад\">←</button>\n                <button @click=\"goForward\" :disabled=\"!canGoForward\" title=\"Вперёд\">→</button>\n                <button @click=\"reload\" title=\"Обновить\">↻</button>\n                \n                <input \n                    v-model=\"currentUrl\" \n                    @keyup.enter=\"navigate\" \n                    class=\"url-input\" \n                    placeholder=\"Введите URL...\"\n                />\n                \n                <button @click=\"navigate\" class=\"go-btn\">Перейти</button>\n            </div>\n        </div>\n        \n        <div class=\"iframe-wrapper\">\n            <iframe \n                ref=\"iframeRef\" \n                :src=\"iframeSrc\" \n                @load=\"onIframeLoad\" \n                @error=\"onIframeError\" \n                sandbox=\"allow-scripts allow-same-origin allow-forms allow-popups\" \n                referrerpolicy=\"no-referrer\" \n            ></iframe>\n        </div>    \n        \n        <div v-if=\"loading\" class=\"loading-indicator\">\n            <div class=\"spinner\"></div>\n            <span>Загрузка...</span>\n        </div>\n        \n        <div v-if=\"error\" class=\"error-message\">\n            <p>⚠️ Не удалось загрузить страницу</p>\n            <button @click=\"reload\">Повторить</button>\n        </div>\n    </div>\n</template>\n\n<script>\nimport { useAppsStore } from '@/stores/apps.store';\nimport { mapStores } from 'pinia';\n\nexport default {\n    name: 'AppWiki',\n\n    props: {\n        windowId: {\n            type: String,\n            required: true\n        },\n        showControls: {\n            type: Boolean,\n            default: true\n        }\n    },\n    \n    data() {\n        const defLink = 'https://ru.wikipedia.org/wiki/%D0%97%D0%B0%D0%B3%D0%BB%D0%B0%D0%B2%D0%BD%D0%B0%D1%8F_%D1%81%D1%82%D1%80%D0%B0%D0%BD%D0%B8%D1%86%D0%B0';\n\n        // В data() мы НЕ можем использовать this.appsStore\n        // Возвращаем только базовые данные\n        return {\n            currentUrl: defLink,\n            iframeSrc: defLink,\n            loading: true,\n            error: false,\n            history: [defLink],\n            currentHistoryIndex: 0\n        };\n    },\n    \n    computed: {\n        // Подключаем store через mapStores\n        ...mapStores(useAppsStore),\n        \n        canGoBack() {\n            return this.currentHistoryIndex > 0;\n        },\n        \n        canGoForward() {\n            return this.currentHistoryIndex < this.history.length - 1;\n        }\n    },\n\n    watch: {\n        currentUrl(newUrl) {\n            console.log(\"URL changed to:\", newUrl);\n            this.saveState();\n        },\n        currentHistoryIndex() {\n            this.saveState();\n        },\n        history: {\n            handler() {\n                this.saveState();\n            },\n            deep: true\n        }\n    },\n\n    methods: {\n        // Инициализация из store (вызывается в mounted)\n        initFromStore() {\n            if (!this.windowId) return;\n            \n            const savedState = this.appsStore.getWindowState(this.windowId);\n            console.log('Loaded state from store:', savedState);\n            \n            if (savedState) {\n                this.currentUrl = savedState.currentUrl || this.currentUrl;\n                this.iframeSrc = savedState.currentUrl || this.iframeSrc;\n                this.history = savedState.history || this.history;\n                this.currentHistoryIndex = savedState.currentHistoryIndex || this.currentHistoryIndex;\n            }\n        },\n\n        // Сохраняем текущее состояние в store\n        saveState() {\n            if (!this.windowId || !this.appsStore) return;\n            \n            const state = {\n                appType: 'wiki',\n                currentUrl: this.currentUrl,\n                history: [...this.history],\n                currentHistoryIndex: this.currentHistoryIndex,\n                timestamp: Date.now()\n            };\n            \n            this.appsStore.saveWindowState(this.windowId, state);\n        },\n\n        // Навигация по URL\n        navigate() {\n            let url = this.currentUrl.trim();\n            \n            // Добавляем протокол если нужно\n            if (!url.startsWith('http://') && !url.startsWith('https://')) {\n                url = 'https://' + url;\n            }\n            \n            try {\n                // Валидация URL\n                new URL(url);\n                this.iframeSrc = url;\n                this.loading = true;\n                this.error = false;\n                \n                // Добавляем в историю\n                if (url !== this.history[this.currentHistoryIndex]) {\n                    // Отрезаем будущее если мы не на конце истории\n                    this.history = this.history.slice(0, this.currentHistoryIndex + 1);\n                    this.history.push(url);\n                    this.currentHistoryIndex = this.history.length - 1;\n                }\n                \n            } catch (e) {\n                console.error('Invalid URL:', url);\n                this.error = true;\n                this.loading = false;\n            }\n        },\n        \n        // Назад по истории\n        goBack() {\n            if (this.canGoBack) {\n                this.currentHistoryIndex--;\n                this.currentUrl = this.history[this.currentHistoryIndex];\n                this.iframeSrc = this.currentUrl;\n                this.loading = true;\n            }\n        },\n        \n        // Вперёд по истории\n        goForward() {\n            if (this.canGoForward) {\n                this.currentHistoryIndex++;\n                this.currentUrl = this.history[this.currentHistoryIndex];\n                this.iframeSrc = this.currentUrl;\n                this.loading = true;\n            }\n        },\n\n        // Обновление страницы\n        reload() {\n            this.loading = true;\n            this.error = false;\n            \n            // Форсируем перезагрузку iframe\n            const tempSrc = this.iframeSrc;\n            this.iframeSrc = '';\n            \n            // Небольшая задержка для гарантии перезагрузки\n            setTimeout(() => {\n                this.iframeSrc = tempSrc;\n            }, 50);\n        },\n\n        // Загрузка завершена\n        onIframeLoad() {\n            console.log('Wiki iframe loaded successfully');\n            this.loading = false;\n            this.error = false;\n            this.safeGetTitle();\n        },\n\n        // Ошибка загрузки\n        onIframeError() {\n            console.error('Wiki iframe failed to load');\n            this.loading = false;\n            this.error = true;\n        },\n\n        // Безопасное получение заголовка\n        safeGetTitle() {\n            try {\n                const iframe = this.$refs.iframeRef;\n                if (iframe && iframe.contentDocument) {\n                    const title = iframe.contentDocument.title;\n                    if (title) {\n                        console.log('Wiki page title:', title);\n                        // Можно обновить заголовок окна, если нужно\n                        this.$emit('title-change', title);\n                    }\n                }\n            } catch (e) {\n                console.log('Cannot access iframe content due to CORS');\n            }\n        },\n        \n        // Открыть в новой вкладке\n        openInNewTab() {\n            window.open(this.currentUrl, '_blank', 'noopener,noreferrer');\n        }\n    },\n\n    mounted() {\n        console.log('AppWiki mounted with windowId:', this.windowId);\n        \n        // Инициализируем данные из store после монтирования\n        this.initFromStore();\n        \n        // Сохраняем начальное состояние\n        this.saveState();\n    },\n\n    beforeUnmount() {\n        console.log('AppWiki unmounting, windowId:', this.windowId);\n        // Решите, нужно ли удалять состояние при закрытии окна\n        // this.appsStore.deleteWindowState(this.windowId);\n    }\n};\n</script>\n\n<style scoped>\n/* Стили остаются без изменений */\n.browser-app {\n    width: 100%;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n    background: white;\n    position: relative;\n}\n\n.browser-controls {\n    background: #f8f9fa;\n    border-bottom: 1px solid #dee2e6;\n    padding: 10px;\n    flex-shrink: 0;\n}\n\n.url-bar {\n    display: flex;\n    gap: 8px;\n    align-items: center;\n}\n\n.url-bar button {\n    padding: 6px 12px;\n    border: 1px solid #ced4da;\n    background: white;\n    border-radius: 4px;\n    cursor: pointer;\n    font-size: 14px;\n    min-width: 36px;\n    transition: all 0.2s;\n}\n\n.url-bar button:hover:not(:disabled) {\n    background: #e9ecef;\n}\n\n.url-bar button:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n}\n\n.url-input {\n    flex: 1;\n    padding: 8px 12px;\n    border: 1px solid #ced4da;\n    border-radius: 4px;\n    font-size: 14px;\n}\n\n.go-btn {\n    background: #007bff !important;\n    color: white !important;\n    border-color: #007bff !important;\n}\n\n.go-btn:hover {\n    background: #0056b3;\n}\n\n.iframe-wrapper {\n    flex: 1;\n    position: relative;\n    overflow: hidden;\n}\n\n.iframe-wrapper iframe {\n    width: 100%;\n    height: 100%;\n    border: none;\n    display: block;\n}\n\n.loading-indicator {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 10px;\n    background: rgba(255, 255, 255, 0.9);\n    padding: 20px;\n    border-radius: 8px;\n    box-shadow: 0 2px 10px rgba(0,0,0,0.1);\n    z-index: 10;\n}\n\n.spinner {\n    width: 40px;\n    height: 40px;\n    border: 4px solid #f3f3f3;\n    border-top: 4px solid #007bff;\n    border-radius: 50%;\n    animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n}\n\n.error-message {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    text-align: center;\n    background: #f8d7da;\n    border: 1px solid #f5c6cb;\n    padding: 20px;\n    border-radius: 8px;\n    color: #721c24;\n    z-index: 10;\n}\n\n.error-message button {\n    margin-top: 10px;\n    padding: 8px 16px;\n    background: #dc3545;\n    color: white;\n    border: none;\n    border-radius: 4px;\n    cursor: pointer;\n}\n</style>","import { render } from \"./AppWiki.vue?vue&type=template&id=c1a6590c&scoped=true\"\nimport script from \"./AppWiki.vue?vue&type=script&lang=js\"\nexport * from \"./AppWiki.vue?vue&type=script&lang=js\"\n\nimport \"./AppWiki.vue?vue&type=style&index=0&id=c1a6590c&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-c1a6590c\"]])\n\nexport default __exports__"],"names":["useAppsStore","defineStore","windowStates","ref","saveWindowState","windowId","state","value","lastUpdated","Date","now","console","log","getWindowState","deleteWindowState","clearAllStates","getAppState","appType","class","_createElementBlock","_hoisted_1","$props","showControls","_hoisted_2","_createElementVNode","_hoisted_3","onClick","_cache","args","$options","goBack","disabled","canGoBack","title","_hoisted_4","goForward","canGoForward","_hoisted_5","reload","$data","currentUrl","$event","onKeyup","_withKeys","navigate","placeholder","_hoisted_6","src","iframeSrc","onLoad","onIframeLoad","onError","onIframeError","sandbox","referrerpolicy","loading","_hoisted_8","error","_hoisted_9","name","props","type","String","required","Boolean","default","data","defLink","history","currentHistoryIndex","computed","mapStores","this","length","watch","newUrl","saveState","handler","deep","methods","initFromStore","savedState","appsStore","timestamp","url","trim","startsWith","URL","slice","push","e","tempSrc","setTimeout","safeGetTitle","iframe","$refs","iframeRef","contentDocument","$emit","openInNewTab","window","open","mounted","beforeUnmount","__exports__","render"],"ignoreList":[],"sourceRoot":""}