{"version":3,"file":"js/792.dcee5ce6.js","mappings":"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","sources":["webpack://osi/./src/apps/system/OSIAppManager/template.html","webpack://osi/./src/apps/system/OSIAppManager/OSIAppManager.vue","webpack://osi/./src/apps/system/OSIAppManager/OSIAppManager.vue?0477"],"sourcesContent":["<div class=\"appmanager-app\">\n    <div class=\"row\">\n        <div class=\"search-area\">\n            <label for=\"search_input\">Поиск:</label>\n            <input id=\"search_input\" type=\"text\" v-model=\"searchInputTxt\">\n        </div>\n        \n        <div v-if=\"isNeedReload\" class=\"warning-text-area\">\n            <h3>Для того, чтобы изменения вступили в силу, необходимо перезагрузить систему.</h3>\n        </div>\n        <div v-else></div>\n\n        <div v-if=\"searchInputTxt.length ===0\" class=\"appslist-area\">\n            <div v-for=\"cat in Object.keys(sortedAppsByCategory)\" :key=\"cat\">\n                <h3>{{cat}}</h3>\n                <div class=\"row\">\n                    <div v-for=\"app in sortedAppsByCategory[cat]\" :key=\"app.id\" class=\"appslist-elem col-4 d-flex\">\n                        <div class=\"appslist-elem-ico d-flex justify-content-center align-items-center\" :class=\"app.iconclass || ''\" :style=\"app.iconclass ? 'color: white' : ''\" @click=\"launchApp(app)\"></div>\n                        <div class=\"appslist-elem-info\">\n                            <div class=\"appslist-elem-showDesk d-flex justify-content-center align-items-center\" title=\"Отображать на рабочем столе.\">\n                                <i class=\"bi bi-display-fill me-1\"></i>\n                                <input type=\"checkbox\" name=\"\" :id=\"app.id + '_showOnDesktop'\" v-model=\"app.showOnDesktop\" :checked=\"app.showOnDesktop\" @change=\"Chng_showOnDesktop(app)\">\n                            </div>\n                            <div class=\"appslist-elem-showStart d-flex justify-content-center align-items-center\" title=\"Отображать в меню запуска.\">\n                                <i class=\"bi bi-house-fill me-1\"></i>\n                                <input type=\"checkbox\" name=\"\" :id=\"app.id + '_showInStartMenu'\" :checked=\"app.showInStartMenu\" v-model=\"app.showInStartMenu\" @change=\"Chng_showInStartMenu(app)\">\n                            </div>\n                            <i class=\"appslist-elem-category\">{{app.category}}</i>\n                            <h3>{{app.label}}</h3>\n                            <i>{{app.description}}</i>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div v-else class=\"appslist-area\">\n            <div v-if=\"hasSearchResults\">\n                <h3>Результаты поиска</h3>\n                <div class=\"row\">\n                    <div v-for=\"app in filteredApps\" :key=\"app.id\" class=\"appslist-elem col-4 d-flex\">\n                        <div class=\"appslist-elem-ico d-flex justify-content-center align-items-center\" :class=\"app.iconclass || ''\" :style=\"app.iconclass ? 'color: white' : ''\" @click=\"launchApp(app)\"></div>\n                        <div class=\"appslist-elem-info\">\n                            <div class=\"appslist-elem-showDesk d-flex justify-content-center align-items-center\">\n                                <i class=\"bi bi-display-fill me-1\"></i>\n                                <input type=\"checkbox\" name=\"\" :id=\"app.id + '_showOnDesktop'\" v-model=\"app.showOnDesktop\" :checked=\"app.showOnDesktop\" @change=\"Chng_showOnDesktop(app)\">\n                            </div>\n                            <div class=\"appslist-elem-showStart d-flex justify-content-center align-items-center\">\n                                <i class=\"bi bi-house-fill me-1\"></i>\n                                <input type=\"checkbox\" name=\"\" :id=\"app.id + '_showInStartMenu'\" :checked=\"app.showInStartMenu\" v-model=\"app.showInStartMenu\" @change=\"Chng_showInStartMenu(app)\">\n                            </div>\n                            <i class=\"appslist-elem-category\">{{app.category}}</i>\n                            <h3>{{app.label}}</h3>\n                            <i>{{app.description}}</i>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <div v-else class=\"no-results\">Ничего не найдено по запросу \"{{searchInputTxt}}\"</div>\n        </div>\n    </div>\n</div>","<template src=\"./template.html\"></template>\n<style src=\"./style.css\"></style>\n<script>\n    import { appsConfig } from '@/config/applications';\n    import { usersTable } from '@/idb/db';\n    import { useOsStore } from '@/stores/os.store';\n\n    export default {\n        name: 'OSIAppManager',\n\n        props: {\n            windowId: {type: String, required: true},\n            USERID: {type: Number, default: 0},\n        },\n\n        inject: [ 'reloadDesk' ],\n\n        data() {\n            return {\n                appsList: [],\n                searchInputTxt: '',\n                USERApps: [],\n                USER: null,\n                isNeedReload: false,\n            }\n        },\n\n        computed: {\n            osStore() {\n                return useOsStore();\n            },\n            // Отфильтрованные приложения по поисковому запросу\n            filteredApps() {\n                if (!this.searchInputTxt.trim()) {\n                    return this.USERApps;\n                } else {\n                    const query = this.searchInputTxt.toLowerCase().trim();\n\n                    return this.USERApps.filter(app => {\n                        // Ищем по label и description для лучшего поиска\n                        return app.label.toLowerCase().includes(query) || \n                            (app.description && app.description.toLowerCase().includes(query));\n                    });\n                }\n            },\n\n            // Группировка по категориям для обычного отображения\n            sortedAppsByCategory() {\n                const resultObj = {};\n                \n                this.USERApps.forEach(element => {\n                    const category = element.category;\n                    \n                    if (!resultObj[category]) { \n                        resultObj[category] = []; \n                    }\n                    resultObj[category].push(element);\n                });\n\n                // Сортировка внутри категорий по названию (label)\n                Object.keys(resultObj).forEach(key => {\n                    resultObj[key].sort((a, b) => {\n                        return a.label.localeCompare(b.label);\n                    });\n                });\n\n                return resultObj;\n            },\n\n            // Проверка есть ли результаты поиска\n            hasSearchResults() { return this.filteredApps.length > 0; },\n\n            // Есть ли поисковый запрос\n            isSearching() { return this.searchInputTxt.trim().length > 0; },\n        },\n\n        async mounted() {\n            const defAppsList = appsConfig.getAllApps();\n            const findUserApps = await usersTable.getApps(this.USERID);\n\n            await this.findUser();\n\n            this.appsList = defAppsList;\n            this.USERApps = (findUserApps) ? findUserApps : defAppsList;\n        },\n\n        methods: {\n            async findUser() {\n                try {                    \n                    this.USER = await usersTable.getbyId(this.USERID);\n                } catch (error) {\n                    console.error('Ошибка поиска пользователя:', error);\n                    this.$toast.error('Не удалось загрузить данные пользователя');\n                }\n            },\n\n            async Chng_showOnDesktop(app) {\n                try {\n                    const appId = app.id;\n\n                    await usersTable.updateAppSetting(this.USERID, appId, 'showOnDesktop', app.showOnDesktop);\n                    this.reloadDesk();\n                } catch (error) {\n                    console.error('Ошибка обновления данных:', error);\n                }\n            },\n            async Chng_showInStartMenu(app) {\n                try {\n                    const appId = app.id;\n                    \n                    await usersTable.updateAppSetting(this.USERID, appId, 'showInStartMenu', app.showInStartMenu);\n                    // TODO: пока это перезапишет в indexeddb конфиг в учетке, но не приведет к динамическому перестроению меню \"пуск\", надо подумать\n                    this.isNeedReload = true;\n                } catch (error) {\n                    console.error('Ошибка обновления данных:', error);\n                }\n            },\n\n            launchApp(_appData) {\n                const appData = {..._appData};\n                console.log('appData', appData);\n                const appName = appData.name;\n                const contentApp = appData.contentapp;\n\n                console.log('appName', appName);\n                console.log('contentApp', contentApp);\n\n                // Ищем окно по windowId или по типу приложения\n                const existingWindow = this.osStore.windows.find(\n                    w => w.appName === appName && w.contentApp === contentApp\n                );\n                \n                if (existingWindow) {\n                    // Если окно существует, активируем его\n                    if (existingWindow.isMinimized) {\n                        this.osStore.restoreWindow(existingWindow.id);\n                    } else {\n                        this.osStore.activateWindow(existingWindow.id);\n                    }\n                } else {\n                    // Создаем новое окно\n                    this.osStore.openWindow({\n                        ...appData,\n                        defWidth: appData.defWidth || 800,\n                        defHeight: appData.defHeight || 600\n                    });\n                }             \n            },\n        },\n    }\n</script>","import { render } from \"./template.html?vue&type=template&id=fb96b318&external\"\nimport script from \"./OSIAppManager.vue?vue&type=script&lang=js\"\nexport * from \"./OSIAppManager.vue?vue&type=script&lang=js\"\n\nimport \"./style.css?vue&type=style&index=0&lang=css&external\"\n\nimport exportComponent from \"../../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","title","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","for","id","type","_ctx","searchInputTxt","$event","isNeedReload","_hoisted_4","_cache","_hoisted_5","length","_hoisted_6","_Fragment","_renderList","Object","keys","sortedAppsByCategory","cat","key","_toDisplayString","_hoisted_7","app","_normalizeClass","iconclass","style","_normalizeStyle","onClick","launchApp","_hoisted_9","_hoisted_10","name","showOnDesktop","checked","onChange","Chng_showOnDesktop","_hoisted_12","showInStartMenu","Chng_showInStartMenu","_hoisted_14","category","label","description","_hoisted_15","hasSearchResults","_hoisted_16","_hoisted_17","filteredApps","_hoisted_19","_hoisted_20","_hoisted_22","_hoisted_24","_hoisted_25","props","windowId","String","required","USERID","Number","default","inject","data","appsList","USERApps","USER","computed","osStore","useOsStore","this","trim","query","toLowerCase","filter","includes","resultObj","forEach","element","push","sort","a","b","localeCompare","isSearching","mounted","defAppsList","appsConfig","getAllApps","findUserApps","usersTable","getApps","findUser","methods","getbyId","error","console","$toast","appId","updateAppSetting","reloadDesk","_appData","appData","log","appName","contentApp","contentapp","existingWindow","windows","find","w","isMinimized","restoreWindow","activateWindow","openWindow","defWidth","defHeight","__exports__","render"],"ignoreList":[],"sourceRoot":""}