{"version":3,"file":"js/755.f49726de.js","mappings":"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","sources":["webpack://osi/./node_modules/music-metadata/lib/asf/GUID.js","webpack://osi/./node_modules/music-metadata/lib/asf/AsfUtil.js","webpack://osi/./node_modules/music-metadata/lib/asf/AsfObject.js","webpack://osi/./node_modules/music-metadata/lib/asf/AsfParser.js"],"sourcesContent":["import { hexToUint8Array, uint8ArrayToHex } from 'uint8array-extras';\r\n/**\r\n * Ref:\r\n * - https://tools.ietf.org/html/draft-fleischman-asf-01, Appendix A: ASF GUIDs\r\n * - http://drang.s4.xrea.com/program/tips/id3tag/wmp/10_asf_guids.html\r\n * - http://drang.s4.xrea.com/program/tips/id3tag/wmp/index.html\r\n * - http://drang.s4.xrea.com/program/tips/id3tag/wmp/10_asf_guids.html\r\n *\r\n * ASF File Structure:\r\n * - https://msdn.microsoft.com/en-us/library/windows/desktop/ee663575(v=vs.85).aspx\r\n *\r\n * ASF GUIDs:\r\n * - http://drang.s4.xrea.com/program/tips/id3tag/wmp/10_asf_guids.html\r\n * - https://github.com/dji-sdk/FFmpeg/blob/master/libavformat/asf.c\r\n */\r\nclass GUID {\r\n    static fromBin(bin, offset = 0) {\r\n        return new GUID(GUID.decode(bin, offset));\r\n    }\r\n    /**\r\n     * Decode GUID in format like \"B503BF5F-2EA9-CF11-8EE3-00C00C205365\"\r\n     * @param objectId Binary GUID\r\n     * @param offset Read offset in bytes, default 0\r\n     * @returns GUID as dashed hexadecimal representation\r\n     */\r\n    static decode(objectId, offset = 0) {\r\n        const view = new DataView(objectId.buffer, offset);\r\n        const guid = `${view.getUint32(0, true).toString(16)}-${view.getUint16(4, true).toString(16)}-${view.getUint16(6, true).toString(16)}-${view.getUint16(8).toString(16)}-${uint8ArrayToHex(objectId.subarray(offset + 10, offset + 16))}`;\r\n        return guid.toUpperCase();\r\n    }\r\n    /**\r\n     * Decode stream type\r\n     * @param mediaType Media type GUID\r\n     * @returns Media type\r\n     */\r\n    static decodeMediaType(mediaType) {\r\n        switch (mediaType.str) {\r\n            case GUID.AudioMedia.str: return 'audio';\r\n            case GUID.VideoMedia.str: return 'video';\r\n            case GUID.CommandMedia.str: return 'command';\r\n            case GUID.Degradable_JPEG_Media.str: return 'degradable-jpeg';\r\n            case GUID.FileTransferMedia.str: return 'file-transfer';\r\n            case GUID.BinaryMedia.str: return 'binary';\r\n        }\r\n    }\r\n    /**\r\n     * Encode GUID\r\n     * @param guid GUID like: \"B503BF5F-2EA9-CF11-8EE3-00C00C205365\"\r\n     * @returns Encoded Binary GUID\r\n     */\r\n    static encode(str) {\r\n        const bin = new Uint8Array(16);\r\n        const view = new DataView(bin.buffer);\r\n        view.setUint32(0, Number.parseInt(str.substring(0, 8), 16), true);\r\n        view.setUint16(4, Number.parseInt(str.substring(9, 13), 16), true);\r\n        view.setUint16(6, Number.parseInt(str.substring(14, 18), 16), true);\r\n        bin.set(hexToUint8Array(str.substring(19, 23)), 8);\r\n        bin.set(hexToUint8Array(str.substring(24)), 10);\r\n        return bin;\r\n    }\r\n    constructor(str) {\r\n        this.str = str;\r\n    }\r\n    equals(guid) {\r\n        return this.str === guid.str;\r\n    }\r\n    toBin() {\r\n        return GUID.encode(this.str);\r\n    }\r\n}\r\n// 10.1 Top-level ASF object GUIDs\r\nGUID.HeaderObject = new GUID(\"75B22630-668E-11CF-A6D9-00AA0062CE6C\");\r\nGUID.DataObject = new GUID(\"75B22636-668E-11CF-A6D9-00AA0062CE6C\");\r\nGUID.SimpleIndexObject = new GUID(\"33000890-E5B1-11CF-89F4-00A0C90349CB\");\r\nGUID.IndexObject = new GUID(\"D6E229D3-35DA-11D1-9034-00A0C90349BE\");\r\nGUID.MediaObjectIndexObject = new GUID(\"FEB103F8-12AD-4C64-840F-2A1D2F7AD48C\");\r\nGUID.TimecodeIndexObject = new GUID(\"3CB73FD0-0C4A-4803-953D-EDF7B6228F0C\");\r\n// 10.2 Header Object GUIDs\r\nGUID.FilePropertiesObject = new GUID(\"8CABDCA1-A947-11CF-8EE4-00C00C205365\");\r\nGUID.StreamPropertiesObject = new GUID(\"B7DC0791-A9B7-11CF-8EE6-00C00C205365\");\r\nGUID.HeaderExtensionObject = new GUID(\"5FBF03B5-A92E-11CF-8EE3-00C00C205365\");\r\nGUID.CodecListObject = new GUID(\"86D15240-311D-11D0-A3A4-00A0C90348F6\");\r\nGUID.ScriptCommandObject = new GUID(\"1EFB1A30-0B62-11D0-A39B-00A0C90348F6\");\r\nGUID.MarkerObject = new GUID(\"F487CD01-A951-11CF-8EE6-00C00C205365\");\r\nGUID.BitrateMutualExclusionObject = new GUID(\"D6E229DC-35DA-11D1-9034-00A0C90349BE\");\r\nGUID.ErrorCorrectionObject = new GUID(\"75B22635-668E-11CF-A6D9-00AA0062CE6C\");\r\nGUID.ContentDescriptionObject = new GUID(\"75B22633-668E-11CF-A6D9-00AA0062CE6C\");\r\nGUID.ExtendedContentDescriptionObject = new GUID(\"D2D0A440-E307-11D2-97F0-00A0C95EA850\");\r\nGUID.ContentBrandingObject = new GUID(\"2211B3FA-BD23-11D2-B4B7-00A0C955FC6E\");\r\nGUID.StreamBitratePropertiesObject = new GUID(\"7BF875CE-468D-11D1-8D82-006097C9A2B2\");\r\nGUID.ContentEncryptionObject = new GUID(\"2211B3FB-BD23-11D2-B4B7-00A0C955FC6E\");\r\nGUID.ExtendedContentEncryptionObject = new GUID(\"298AE614-2622-4C17-B935-DAE07EE9289C\");\r\nGUID.DigitalSignatureObject = new GUID(\"2211B3FC-BD23-11D2-B4B7-00A0C955FC6E\");\r\nGUID.PaddingObject = new GUID(\"1806D474-CADF-4509-A4BA-9AABCB96AAE8\");\r\n// 10.3 Header Extension Object GUIDs\r\nGUID.ExtendedStreamPropertiesObject = new GUID(\"14E6A5CB-C672-4332-8399-A96952065B5A\");\r\nGUID.AdvancedMutualExclusionObject = new GUID(\"A08649CF-4775-4670-8A16-6E35357566CD\");\r\nGUID.GroupMutualExclusionObject = new GUID(\"D1465A40-5A79-4338-B71B-E36B8FD6C249\");\r\nGUID.StreamPrioritizationObject = new GUID(\"D4FED15B-88D3-454F-81F0-ED5C45999E24\");\r\nGUID.BandwidthSharingObject = new GUID(\"A69609E6-517B-11D2-B6AF-00C04FD908E9\");\r\nGUID.LanguageListObject = new GUID(\"7C4346A9-EFE0-4BFC-B229-393EDE415C85\");\r\nGUID.MetadataObject = new GUID(\"C5F8CBEA-5BAF-4877-8467-AA8C44FA4CCA\");\r\nGUID.MetadataLibraryObject = new GUID(\"44231C94-9498-49D1-A141-1D134E457054\");\r\nGUID.IndexParametersObject = new GUID(\"D6E229DF-35DA-11D1-9034-00A0C90349BE\");\r\nGUID.MediaObjectIndexParametersObject = new GUID(\"6B203BAD-3F11-48E4-ACA8-D7613DE2CFA7\");\r\nGUID.TimecodeIndexParametersObject = new GUID(\"F55E496D-9797-4B5D-8C8B-604DFE9BFB24\");\r\nGUID.CompatibilityObject = new GUID(\"26F18B5D-4584-47EC-9F5F-0E651F0452C9\");\r\nGUID.AdvancedContentEncryptionObject = new GUID(\"43058533-6981-49E6-9B74-AD12CB86D58C\");\r\n// 10.4 Stream Properties Object Stream Type GUIDs\r\nGUID.AudioMedia = new GUID(\"F8699E40-5B4D-11CF-A8FD-00805F5C442B\");\r\nGUID.VideoMedia = new GUID(\"BC19EFC0-5B4D-11CF-A8FD-00805F5C442B\");\r\nGUID.CommandMedia = new GUID(\"59DACFC0-59E6-11D0-A3AC-00A0C90348F6\");\r\nGUID.JFIF_Media = new GUID(\"B61BE100-5B4E-11CF-A8FD-00805F5C442B\");\r\nGUID.Degradable_JPEG_Media = new GUID(\"35907DE0-E415-11CF-A917-00805F5C442B\");\r\nGUID.FileTransferMedia = new GUID(\"91BD222C-F21C-497A-8B6D-5AA86BFC0185\");\r\nGUID.BinaryMedia = new GUID(\"3AFB65E2-47EF-40F2-AC2C-70A90D71D343\");\r\nGUID.ASF_Index_Placeholder_Object = new GUID(\"D9AADE20-7C17-4F9C-BC28-8555DD98E2A2\");\r\nexport default GUID;\r\n","import * as Token from 'token-types';\r\nimport * as util from '../common/Util.js';\r\nexport function getParserForAttr(i) {\r\n    return attributeParsers[i];\r\n}\r\nexport function parseUnicodeAttr(uint8Array) {\r\n    return util.stripNulls(util.decodeString(uint8Array, 'utf-16le'));\r\n}\r\nconst attributeParsers = [\r\n    parseUnicodeAttr,\r\n    parseByteArrayAttr,\r\n    parseBoolAttr,\r\n    parseDWordAttr,\r\n    parseQWordAttr,\r\n    parseWordAttr,\r\n    parseByteArrayAttr\r\n];\r\nfunction parseByteArrayAttr(buf) {\r\n    return new Uint8Array(buf);\r\n}\r\nfunction parseBoolAttr(buf, offset = 0) {\r\n    return parseWordAttr(buf, offset) === 1;\r\n}\r\nfunction parseDWordAttr(buf, offset = 0) {\r\n    return Token.UINT32_LE.get(buf, offset);\r\n}\r\nfunction parseQWordAttr(buf, offset = 0) {\r\n    return Token.UINT64_LE.get(buf, offset);\r\n}\r\nfunction parseWordAttr(buf, offset = 0) {\r\n    return Token.UINT16_LE.get(buf, offset);\r\n}\r\n","// ASF Objects\r\nimport * as Token from 'token-types';\r\nimport * as util from '../common/Util.js';\r\nimport GUID from './GUID.js';\r\nimport { getParserForAttr, parseUnicodeAttr } from './AsfUtil.js';\r\nimport { AttachedPictureType } from '../id3v2/ID3v2Token.js';\r\nimport { makeUnexpectedFileContentError } from '../ParseError.js';\r\nexport class AsfContentParseError extends makeUnexpectedFileContentError('ASF') {\r\n}\r\n/**\r\n * Data Type: Specifies the type of information being stored. The following values are recognized.\r\n */\r\nexport const DataType = {\r\n    /**\r\n     * Unicode string. The data consists of a sequence of Unicode characters.\r\n     */\r\n    UnicodeString: 0,\r\n    /**\r\n     * BYTE array. The type of data is implementation-specific.\r\n     */\r\n    ByteArray: 1,\r\n    /**\r\n     * BOOL. The data is 2 bytes long and should be interpreted as a 16-bit unsigned integer. Only 0x0000 or 0x0001 are permitted values.\r\n     */\r\n    Bool: 2,\r\n    /**\r\n     * DWORD. The data is 4 bytes long and should be interpreted as a 32-bit unsigned integer.\r\n     */\r\n    DWord: 3,\r\n    /**\r\n     * QWORD. The data is 8 bytes long and should be interpreted as a 64-bit unsigned integer.\r\n     */\r\n    QWord: 4,\r\n    /**\r\n     * WORD. The data is 2 bytes long and should be interpreted as a 16-bit unsigned integer.\r\n     */\r\n    Word: 5\r\n};\r\n/**\r\n * Token for: 3. ASF top-level Header Object\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/03_asf_top_level_header_object.html#3\r\n */\r\nexport const TopLevelHeaderObjectToken = {\r\n    len: 30,\r\n    get: (buf, off) => {\r\n        return {\r\n            objectId: GUID.fromBin(buf, off),\r\n            objectSize: Number(Token.UINT64_LE.get(buf, off + 16)),\r\n            numberOfHeaderObjects: Token.UINT32_LE.get(buf, off + 24)\r\n            // Reserved: 2 bytes\r\n        };\r\n    }\r\n};\r\n/**\r\n * Token for: 3.1 Header Object (mandatory, one only)\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/03_asf_top_level_header_object.html#3_1\r\n */\r\nexport const HeaderObjectToken = {\r\n    len: 24,\r\n    get: (buf, off) => {\r\n        return {\r\n            objectId: GUID.fromBin(buf, off),\r\n            objectSize: Number(Token.UINT64_LE.get(buf, off + 16))\r\n        };\r\n    }\r\n};\r\nexport class State {\r\n    constructor(header) {\r\n        this.len = Number(header.objectSize) - HeaderObjectToken.len;\r\n    }\r\n    postProcessTag(tags, name, valueType, data) {\r\n        if (name === 'WM/Picture') {\r\n            tags.push({ id: name, value: WmPictureToken.fromBuffer(data) });\r\n        }\r\n        else {\r\n            const parseAttr = getParserForAttr(valueType);\r\n            if (!parseAttr) {\r\n                throw new AsfContentParseError(`unexpected value headerType: ${valueType}`);\r\n            }\r\n            tags.push({ id: name, value: parseAttr(data) });\r\n        }\r\n    }\r\n}\r\n// ToDo: use ignore type\r\nexport class IgnoreObjectState extends State {\r\n    get(_buf, _off) {\r\n        return null;\r\n    }\r\n}\r\n/**\r\n * Token for: 3.2: File Properties Object (mandatory, one only)\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/03_asf_top_level_header_object.html#3_2\r\n */\r\nexport class FilePropertiesObject extends State {\r\n    get(buf, off) {\r\n        return {\r\n            fileId: GUID.fromBin(buf, off),\r\n            fileSize: Token.UINT64_LE.get(buf, off + 16),\r\n            creationDate: Token.UINT64_LE.get(buf, off + 24),\r\n            dataPacketsCount: Token.UINT64_LE.get(buf, off + 32),\r\n            playDuration: Token.UINT64_LE.get(buf, off + 40),\r\n            sendDuration: Token.UINT64_LE.get(buf, off + 48),\r\n            preroll: Token.UINT64_LE.get(buf, off + 56),\r\n            flags: {\r\n                broadcast: util.getBit(buf, off + 64, 24),\r\n                seekable: util.getBit(buf, off + 64, 25)\r\n            },\r\n            // flagsNumeric: Token.UINT32_LE.get(buf, off + 64),\r\n            minimumDataPacketSize: Token.UINT32_LE.get(buf, off + 68),\r\n            maximumDataPacketSize: Token.UINT32_LE.get(buf, off + 72),\r\n            maximumBitrate: Token.UINT32_LE.get(buf, off + 76)\r\n        };\r\n    }\r\n}\r\nFilePropertiesObject.guid = GUID.FilePropertiesObject;\r\n/**\r\n * Token for: 3.3 Stream Properties Object (mandatory, one per stream)\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/03_asf_top_level_header_object.html#3_3\r\n */\r\nexport class StreamPropertiesObject extends State {\r\n    get(buf, off) {\r\n        return {\r\n            streamType: GUID.decodeMediaType(GUID.fromBin(buf, off)),\r\n            errorCorrectionType: GUID.fromBin(buf, off + 8)\r\n            // ToDo\r\n        };\r\n    }\r\n}\r\nStreamPropertiesObject.guid = GUID.StreamPropertiesObject;\r\n/**\r\n * 3.4: Header Extension Object (mandatory, one only)\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/03_asf_top_level_header_object.html#3_4\r\n */\r\nexport class HeaderExtensionObject {\r\n    constructor() {\r\n        this.len = 22;\r\n    }\r\n    get(buf, off) {\r\n        const view = new DataView(buf.buffer, off);\r\n        return {\r\n            reserved1: GUID.fromBin(buf, off),\r\n            reserved2: view.getUint16(16, true),\r\n            extensionDataSize: view.getUint16(18, true)\r\n        };\r\n    }\r\n}\r\nHeaderExtensionObject.guid = GUID.HeaderExtensionObject;\r\n/**\r\n * 3.5: The Codec List Object provides user-friendly information about the codecs and formats used to encode the content found in the ASF file.\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/03_asf_top_level_header_object.html#3_5\r\n */\r\nconst CodecListObjectHeader = {\r\n    len: 20,\r\n    get: (buf, off) => {\r\n        const view = new DataView(buf.buffer, off);\r\n        return {\r\n            entryCount: view.getUint16(16, true)\r\n        };\r\n    }\r\n};\r\nasync function readString(tokenizer) {\r\n    const length = await tokenizer.readNumber(Token.UINT16_LE);\r\n    return (await tokenizer.readToken(new Token.StringType(length * 2, 'utf-16le'))).replace('\\0', '');\r\n}\r\n/**\r\n * 3.5: Read the Codec-List-Object, which provides user-friendly information about the codecs and formats used to encode the content found in the ASF file.\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/03_asf_top_level_header_object.html#3_5\r\n */\r\nexport async function readCodecEntries(tokenizer) {\r\n    const codecHeader = await tokenizer.readToken(CodecListObjectHeader);\r\n    const entries = [];\r\n    for (let i = 0; i < codecHeader.entryCount; ++i) {\r\n        entries.push(await readCodecEntry(tokenizer));\r\n    }\r\n    return entries;\r\n}\r\nasync function readInformation(tokenizer) {\r\n    const length = await tokenizer.readNumber(Token.UINT16_LE);\r\n    const buf = new Uint8Array(length);\r\n    await tokenizer.readBuffer(buf);\r\n    return buf;\r\n}\r\n/**\r\n * Read Codec-Entries\r\n * @param tokenizer\r\n */\r\nasync function readCodecEntry(tokenizer) {\r\n    const type = await tokenizer.readNumber(Token.UINT16_LE);\r\n    return {\r\n        type: {\r\n            videoCodec: (type & 0x0001) === 0x0001,\r\n            audioCodec: (type & 0x0002) === 0x0002\r\n        },\r\n        codecName: await readString(tokenizer),\r\n        description: await readString(tokenizer),\r\n        information: await readInformation(tokenizer)\r\n    };\r\n}\r\n/**\r\n * 3.10 Content Description Object (optional, one only)\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/03_asf_top_level_header_object.html#3_10\r\n */\r\nexport class ContentDescriptionObjectState extends State {\r\n    get(buf, off) {\r\n        const tags = [];\r\n        const view = new DataView(buf.buffer, off);\r\n        let pos = 10;\r\n        for (let i = 0; i < ContentDescriptionObjectState.contentDescTags.length; ++i) {\r\n            const length = view.getUint16(i * 2, true);\r\n            if (length > 0) {\r\n                const tagName = ContentDescriptionObjectState.contentDescTags[i];\r\n                const end = pos + length;\r\n                tags.push({ id: tagName, value: parseUnicodeAttr(buf.subarray(off + pos, off + end)) });\r\n                pos = end;\r\n            }\r\n        }\r\n        return tags;\r\n    }\r\n}\r\nContentDescriptionObjectState.guid = GUID.ContentDescriptionObject;\r\nContentDescriptionObjectState.contentDescTags = ['Title', 'Author', 'Copyright', 'Description', 'Rating'];\r\n/**\r\n * 3.11 Extended Content Description Object (optional, one only)\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/03_asf_top_level_header_object.html#3_11\r\n */\r\nexport class ExtendedContentDescriptionObjectState extends State {\r\n    get(buf, off) {\r\n        const tags = [];\r\n        const view = new DataView(buf.buffer, off);\r\n        const attrCount = view.getUint16(0, true);\r\n        let pos = 2;\r\n        for (let i = 0; i < attrCount; i += 1) {\r\n            const nameLen = view.getUint16(pos, true);\r\n            pos += 2;\r\n            const name = parseUnicodeAttr(buf.subarray(off + pos, off + pos + nameLen));\r\n            pos += nameLen;\r\n            const valueType = view.getUint16(pos, true);\r\n            pos += 2;\r\n            const valueLen = view.getUint16(pos, true);\r\n            pos += 2;\r\n            const value = buf.subarray(off + pos, off + pos + valueLen);\r\n            pos += valueLen;\r\n            this.postProcessTag(tags, name, valueType, value);\r\n        }\r\n        return tags;\r\n    }\r\n}\r\nExtendedContentDescriptionObjectState.guid = GUID.ExtendedContentDescriptionObject;\r\n/**\r\n * 4.1 Extended Stream Properties Object (optional, 1 per media stream)\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/04_objects_in_the_asf_header_extension_object.html#4_1\r\n */\r\nexport class ExtendedStreamPropertiesObjectState extends State {\r\n    get(buf, off) {\r\n        const view = new DataView(buf.buffer, off);\r\n        return {\r\n            startTime: Token.UINT64_LE.get(buf, off),\r\n            endTime: Token.UINT64_LE.get(buf, off + 8),\r\n            dataBitrate: view.getInt32(12, true),\r\n            bufferSize: view.getInt32(16, true),\r\n            initialBufferFullness: view.getInt32(20, true),\r\n            alternateDataBitrate: view.getInt32(24, true),\r\n            alternateBufferSize: view.getInt32(28, true),\r\n            alternateInitialBufferFullness: view.getInt32(32, true),\r\n            maximumObjectSize: view.getInt32(36, true),\r\n            flags: {\r\n                reliableFlag: util.getBit(buf, off + 40, 0),\r\n                seekableFlag: util.getBit(buf, off + 40, 1),\r\n                resendLiveCleanpointsFlag: util.getBit(buf, off + 40, 2)\r\n            },\r\n            // flagsNumeric: Token.UINT32_LE.get(buf, off + 64),\r\n            streamNumber: view.getInt16(42, true),\r\n            streamLanguageId: view.getInt16(44, true),\r\n            averageTimePerFrame: view.getInt32(52, true),\r\n            streamNameCount: view.getInt32(54, true),\r\n            payloadExtensionSystems: view.getInt32(56, true),\r\n            streamNames: [], // ToDo\r\n            streamPropertiesObject: null\r\n        };\r\n    }\r\n}\r\nExtendedStreamPropertiesObjectState.guid = GUID.ExtendedStreamPropertiesObject;\r\n/**\r\n * 4.7  Metadata Object (optional, 0 or 1)\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/04_objects_in_the_asf_header_extension_object.html#4_7\r\n */\r\nexport class MetadataObjectState extends State {\r\n    get(uint8Array, off) {\r\n        const tags = [];\r\n        const view = new DataView(uint8Array.buffer, off);\r\n        const descriptionRecordsCount = view.getUint16(0, true);\r\n        let pos = 2;\r\n        for (let i = 0; i < descriptionRecordsCount; i += 1) {\r\n            pos += 4;\r\n            const nameLen = view.getUint16(pos, true);\r\n            pos += 2;\r\n            const dataType = view.getUint16(pos, true);\r\n            pos += 2;\r\n            const dataLen = view.getUint32(pos, true);\r\n            pos += 4;\r\n            const name = parseUnicodeAttr(uint8Array.subarray(off + pos, off + pos + nameLen));\r\n            pos += nameLen;\r\n            const data = uint8Array.subarray(off + pos, off + pos + dataLen);\r\n            pos += dataLen;\r\n            this.postProcessTag(tags, name, dataType, data);\r\n        }\r\n        return tags;\r\n    }\r\n}\r\nMetadataObjectState.guid = GUID.MetadataObject;\r\n// 4.8\tMetadata Library Object (optional, 0 or 1)\r\nexport class MetadataLibraryObjectState extends MetadataObjectState {\r\n}\r\nMetadataLibraryObjectState.guid = GUID.MetadataLibraryObject;\r\n/**\r\n * Ref: https://msdn.microsoft.com/en-us/library/windows/desktop/dd757977(v=vs.85).aspx\r\n */\r\nexport class WmPictureToken {\r\n    static fromBuffer(buffer) {\r\n        const pic = new WmPictureToken(buffer.length);\r\n        return pic.get(buffer, 0);\r\n    }\r\n    constructor(len) {\r\n        this.len = len;\r\n    }\r\n    get(buffer, offset) {\r\n        const view = new DataView(buffer.buffer, offset);\r\n        const typeId = view.getUint8(0);\r\n        const size = view.getInt32(1, true);\r\n        let index = 5;\r\n        while (view.getUint16(index) !== 0) {\r\n            index += 2;\r\n        }\r\n        const format = new Token.StringType(index - 5, 'utf-16le').get(buffer, 5);\r\n        while (view.getUint16(index) !== 0) {\r\n            index += 2;\r\n        }\r\n        const description = new Token.StringType(index - 5, 'utf-16le').get(buffer, 5);\r\n        return {\r\n            type: AttachedPictureType[typeId],\r\n            format,\r\n            description,\r\n            size,\r\n            data: buffer.slice(index + 4)\r\n        };\r\n    }\r\n}\r\n","import initDebug from 'debug';\r\nimport { TrackType } from '../type.js';\r\nimport GUID from './GUID.js';\r\nimport * as AsfObject from './AsfObject.js';\r\nimport { BasicParser } from '../common/BasicParser.js';\r\nimport { AsfContentParseError } from './AsfObject.js';\r\nconst debug = initDebug('music-metadata:parser:ASF');\r\nconst headerType = 'asf';\r\n/**\r\n * Windows Media Metadata Usage Guidelines\r\n * - Ref: https://msdn.microsoft.com/en-us/library/ms867702.aspx\r\n *\r\n * Ref:\r\n * - https://tools.ietf.org/html/draft-fleischman-asf-01\r\n * - https://hwiegman.home.xs4all.nl/fileformats/asf/ASF_Specification.pdf\r\n * - http://drang.s4.xrea.com/program/tips/id3tag/wmp/index.html\r\n * - https://msdn.microsoft.com/en-us/library/windows/desktop/ee663575(v=vs.85).aspx\r\n */\r\nexport class AsfParser extends BasicParser {\r\n    async parse() {\r\n        const header = await this.tokenizer.readToken(AsfObject.TopLevelHeaderObjectToken);\r\n        if (!header.objectId.equals(GUID.HeaderObject)) {\r\n            throw new AsfContentParseError(`expected asf header; but was not found; got: ${header.objectId.str}`);\r\n        }\r\n        try {\r\n            await this.parseObjectHeader(header.numberOfHeaderObjects);\r\n        }\r\n        catch (err) {\r\n            debug('Error while parsing ASF: %s', err);\r\n        }\r\n    }\r\n    async parseObjectHeader(numberOfObjectHeaders) {\r\n        let tags;\r\n        do {\r\n            // Parse common header of the ASF Object (3.1)\r\n            const header = await this.tokenizer.readToken(AsfObject.HeaderObjectToken);\r\n            // Parse data part of the ASF Object\r\n            debug('header GUID=%s', header.objectId.str);\r\n            switch (header.objectId.str) {\r\n                case AsfObject.FilePropertiesObject.guid.str: { // 3.2\r\n                    const fpo = await this.tokenizer.readToken(new AsfObject.FilePropertiesObject(header));\r\n                    this.metadata.setFormat('duration', Number(fpo.playDuration / BigInt(1000)) / 10000 - Number(fpo.preroll) / 1000);\r\n                    this.metadata.setFormat('bitrate', fpo.maximumBitrate);\r\n                    break;\r\n                }\r\n                case AsfObject.StreamPropertiesObject.guid.str: { // 3.3\r\n                    const spo = await this.tokenizer.readToken(new AsfObject.StreamPropertiesObject(header));\r\n                    this.metadata.setFormat('container', `ASF/${spo.streamType}`);\r\n                    break;\r\n                }\r\n                case AsfObject.HeaderExtensionObject.guid.str: { // 3.4\r\n                    const extHeader = await this.tokenizer.readToken(new AsfObject.HeaderExtensionObject());\r\n                    await this.parseExtensionObject(extHeader.extensionDataSize);\r\n                    break;\r\n                }\r\n                case AsfObject.ContentDescriptionObjectState.guid.str: // 3.10\r\n                    tags = await this.tokenizer.readToken(new AsfObject.ContentDescriptionObjectState(header));\r\n                    await this.addTags(tags);\r\n                    break;\r\n                case AsfObject.ExtendedContentDescriptionObjectState.guid.str: // 3.11\r\n                    tags = await this.tokenizer.readToken(new AsfObject.ExtendedContentDescriptionObjectState(header));\r\n                    await this.addTags(tags);\r\n                    break;\r\n                case GUID.CodecListObject.str: {\r\n                    const codecs = await AsfObject.readCodecEntries(this.tokenizer);\r\n                    codecs.forEach(codec => {\r\n                        this.metadata.addStreamInfo({\r\n                            type: codec.type.videoCodec ? TrackType.video : TrackType.audio,\r\n                            codecName: codec.codecName\r\n                        });\r\n                    });\r\n                    const audioCodecs = codecs.filter(codec => codec.type.audioCodec).map(codec => codec.codecName).join('/');\r\n                    this.metadata.setFormat('codec', audioCodecs);\r\n                    break;\r\n                }\r\n                case GUID.StreamBitratePropertiesObject.str:\r\n                    // ToDo?\r\n                    await this.tokenizer.ignore(header.objectSize - AsfObject.HeaderObjectToken.len);\r\n                    break;\r\n                case GUID.PaddingObject.str:\r\n                    // ToDo: register bytes pad\r\n                    debug('Padding: %s bytes', header.objectSize - AsfObject.HeaderObjectToken.len);\r\n                    await this.tokenizer.ignore(header.objectSize - AsfObject.HeaderObjectToken.len);\r\n                    break;\r\n                default:\r\n                    this.metadata.addWarning(`Ignore ASF-Object-GUID: ${header.objectId.str}`);\r\n                    debug('Ignore ASF-Object-GUID: %s', header.objectId.str);\r\n                    await this.tokenizer.readToken(new AsfObject.IgnoreObjectState(header));\r\n            }\r\n        } while (--numberOfObjectHeaders);\r\n        // done\r\n    }\r\n    async addTags(tags) {\r\n        await Promise.all(tags.map(({ id, value }) => this.metadata.addTag(headerType, id, value)));\r\n    }\r\n    async parseExtensionObject(extensionSize) {\r\n        do {\r\n            // Parse common header of the ASF Object (3.1)\r\n            const header = await this.tokenizer.readToken(AsfObject.HeaderObjectToken);\r\n            const remaining = header.objectSize - AsfObject.HeaderObjectToken.len;\r\n            // Parse data part of the ASF Object\r\n            switch (header.objectId.str) {\r\n                case AsfObject.ExtendedStreamPropertiesObjectState.guid.str: // 4.1\r\n                    // ToDo: extended stream header properties are ignored\r\n                    await this.tokenizer.readToken(new AsfObject.ExtendedStreamPropertiesObjectState(header));\r\n                    break;\r\n                case AsfObject.MetadataObjectState.guid.str: { // 4.7\r\n                    const moTags = await this.tokenizer.readToken(new AsfObject.MetadataObjectState(header));\r\n                    await this.addTags(moTags);\r\n                    break;\r\n                }\r\n                case AsfObject.MetadataLibraryObjectState.guid.str: { // 4.8\r\n                    const mlTags = await this.tokenizer.readToken(new AsfObject.MetadataLibraryObjectState(header));\r\n                    await this.addTags(mlTags);\r\n                    break;\r\n                }\r\n                case GUID.PaddingObject.str:\r\n                    // ToDo: register bytes pad\r\n                    await this.tokenizer.ignore(remaining);\r\n                    break;\r\n                case GUID.CompatibilityObject.str:\r\n                    await this.tokenizer.ignore(remaining);\r\n                    break;\r\n                case GUID.ASF_Index_Placeholder_Object.str:\r\n                    await this.tokenizer.ignore(remaining);\r\n                    break;\r\n                default:\r\n                    this.metadata.addWarning(`Ignore ASF-Object-GUID: ${header.objectId.str}`);\r\n                    // console.log(\"Ignore ASF-Object-GUID: %s\", header.objectId.str);\r\n                    await this.tokenizer.readToken(new AsfObject.IgnoreObjectState(header));\r\n                    break;\r\n            }\r\n            extensionSize -= header.objectSize;\r\n        } while (extensionSize > 0);\r\n    }\r\n}\r\n"],"names":["GUID","fromBin","bin","offset","decode","objectId","view","DataView","buffer","guid","getUint32","toString","getUint16","uint8ArrayToHex","subarray","toUpperCase","decodeMediaType","mediaType","str","AudioMedia","VideoMedia","CommandMedia","Degradable_JPEG_Media","FileTransferMedia","BinaryMedia","encode","Uint8Array","setUint32","Number","parseInt","substring","setUint16","set","hexToUint8Array","constructor","this","equals","toBin","HeaderObject","DataObject","SimpleIndexObject","IndexObject","MediaObjectIndexObject","TimecodeIndexObject","FilePropertiesObject","StreamPropertiesObject","HeaderExtensionObject","CodecListObject","ScriptCommandObject","MarkerObject","BitrateMutualExclusionObject","ErrorCorrectionObject","ContentDescriptionObject","ExtendedContentDescriptionObject","ContentBrandingObject","StreamBitratePropertiesObject","ContentEncryptionObject","ExtendedContentEncryptionObject","DigitalSignatureObject","PaddingObject","ExtendedStreamPropertiesObject","AdvancedMutualExclusionObject","GroupMutualExclusionObject","StreamPrioritizationObject","BandwidthSharingObject","LanguageListObject","MetadataObject","MetadataLibraryObject","IndexParametersObject","MediaObjectIndexParametersObject","TimecodeIndexParametersObject","CompatibilityObject","AdvancedContentEncryptionObject","JFIF_Media","ASF_Index_Placeholder_Object","getParserForAttr","i","attributeParsers","parseUnicodeAttr","uint8Array","util","parseByteArrayAttr","parseBoolAttr","parseDWordAttr","parseQWordAttr","parseWordAttr","buf","Token","get","AsfContentParseError","makeUnexpectedFileContentError","TopLevelHeaderObjectToken","len","off","objectSize","numberOfHeaderObjects","HeaderObjectToken","State","header","postProcessTag","tags","name","valueType","data","push","id","value","WmPictureToken","fromBuffer","parseAttr","IgnoreObjectState","_buf","_off","fileId","fileSize","creationDate","dataPacketsCount","playDuration","sendDuration","preroll","flags","broadcast","seekable","minimumDataPacketSize","maximumDataPacketSize","maximumBitrate","streamType","errorCorrectionType","reserved1","reserved2","extensionDataSize","CodecListObjectHeader","entryCount","async","readString","tokenizer","length","readNumber","readToken","replace","readCodecEntries","codecHeader","entries","readCodecEntry","readInformation","readBuffer","type","videoCodec","audioCodec","codecName","description","information","ContentDescriptionObjectState","pos","contentDescTags","tagName","end","ExtendedContentDescriptionObjectState","attrCount","nameLen","valueLen","ExtendedStreamPropertiesObjectState","startTime","endTime","dataBitrate","getInt32","bufferSize","initialBufferFullness","alternateDataBitrate","alternateBufferSize","alternateInitialBufferFullness","maximumObjectSize","reliableFlag","seekableFlag","resendLiveCleanpointsFlag","streamNumber","getInt16","streamLanguageId","averageTimePerFrame","streamNameCount","payloadExtensionSystems","streamNames","streamPropertiesObject","MetadataObjectState","descriptionRecordsCount","dataType","dataLen","MetadataLibraryObjectState","pic","typeId","getUint8","size","index","format","AttachedPictureType","slice","debug","initDebug","headerType","AsfParser","BasicParser","parse","AsfObject","parseObjectHeader","err","numberOfObjectHeaders","fpo","metadata","setFormat","BigInt","spo","extHeader","parseExtensionObject","addTags","codecs","forEach","codec","addStreamInfo","TrackType","video","audio","audioCodecs","filter","map","join","ignore","addWarning","Promise","all","addTag","extensionSize","remaining","moTags","mlTags"],"ignoreList":[],"sourceRoot":""}