{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/web.url-search-params.delete.js\";\nimport \"core-js/modules/web.url-search-params.has.js\";\nimport \"core-js/modules/web.url-search-params.size.js\";\nimport { useAppsStore } from '@/stores/apps.store';\nimport { LangPack } from './lang';\nimport { mapStores } from 'pinia';\nimport { parseBlob } from 'music-metadata';\nimport debounce from 'lodash/debounce';\nexport default {\n  name: 'OSIMPlayer',\n  props: {\n    windowId: {\n      type: String,\n      required: true\n    }\n  },\n  data() {\n    return {\n      lang_data: {},\n      PlayList: [],\n      isPlaying: false,\n      durationAll: 0,\n      TargetTrack: null,\n      ShowConfig: {\n        playlist: {\n          artist: true,\n          album: true,\n          duration: true\n        }\n      },\n      isLoading: false,\n      totalFiles: 0,\n      MAX_FILE_SIZE: 100 * 1024 * 1024,\n      // 100MB,\n      MAX_PLAYLIST_SIZE: 1000 * 1024 * 1024,\n      // 1000MB,\n      curFilesSize: 0,\n      audioDurations: {},\n      // Объект для \"длительностей\"\n      VolumeLvl: 0.5,\n      VolumeLvl_save: 0.5,\n      currentIndex: 0,\n      urlsData: new Map(),\n      TrackTime: {\n        current: 0,\n        duration: 0\n      },\n      SilentMode: false,\n      ShuffleMode: false,\n      currentCoverUrl: null,\n      prevCoverUrl: null,\n      CoverMode: true,\n      IsValidPlayList: false,\n      isInitialized: false,\n      trackSelector: []\n    };\n  },\n  computed: {\n    ...mapStores(useAppsStore),\n    currentTrack() {\n      const curindex = this.currentIndex + '';\n      const preplist = this.PlayList;\n      if (preplist && preplist.length > 0 && curindex) {\n        let tr = preplist[curindex];\n        return tr;\n      } else {\n        return null;\n      }\n    },\n    currentTrack_time() {\n      return this.ShowerTime(this.TrackTime.current);\n    }\n  },\n  watch: {\n    currentTrack: {\n      handler() {\n        this.updateCoverUrl();\n      },\n      immediate: true\n    },\n    trackSelector() {\n      console.log(\"trackSelector\", this.trackSelector);\n    },\n    // при изменении любого из следующих параметров (при пройденой инициализации) - вызываем фун-ю сохранения состояния\n    // PlayList() { if (this.isInitialized) { this.saveState(); } },   //плейлист\n    // ShowConfig() { if (this.isInitialized) { this.saveState(); } },   //конфиг отображения\n    VolumeLvl() {\n      if (this.isInitialized) {\n        this.saveState();\n      }\n    },\n    //уровень громкости\n    SilentMode() {\n      if (this.isInitialized) {\n        this.saveState();\n      }\n    },\n    //режим без звука\n    ShuffleMode() {\n      if (this.isInitialized) {\n        this.saveState();\n      }\n    } //режим случайного воспроизведения\n  },\n  methods: {\n    LangData(key) {\n      return this.lang_data[key] || '';\n    },\n    // Инициализация из store\n    initFromStore() {\n      console.log('START:: initFromStore');\n      if (!this.windowId || !this.appsStore) {\n        console.error('OSIMPlayer: windowId or appsStore is missing');\n        return;\n      }\n      const savedState = this.appsStore.getWindowState(this.windowId);\n      console.log('OSIMPlayer loaded state:', savedState);\n      if (savedState && savedState.appType === 'mplayer') {\n        this.durationAll = savedState.durationAll || 0;\n        this.ShowConfig = savedState.ShowConfig || {\n          playlist: {\n            artist: true,\n            album: true,\n            genre: true,\n            duration: true\n          }\n        };\n        this.totalFiles = savedState.totalFiles || 0;\n        this.curFilesSize = savedState.curFilesSize || 0;\n        this.audioDurations = savedState.audioDurations || {};\n        this.VolumeLvl = savedState.VolumeLvl || 0.5;\n        this.VolumeLvl_save = savedState.VolumeLvl_save || 0.5;\n        this.SilentMode = savedState.SilentMode || false;\n        this.ShuffleMode = savedState.ShuffleMode || false;\n        this.PlayList = savedState.PlayList || [];\n      }\n      this.isInitialized = true;\n      console.log('OSIMPlayer initialized');\n    },\n    async saveState() {\n      console.log('START:: saveState');\n      if (!this.windowId || !this.appsStore || !this.isInitialized) return;\n\n      // let newPlayList = this.PlayList;\n      // newPlayList.map(function(elem) {\n      //     elem.common = {\n      //         album: elem.common.album || null,\n      //         artist: elem.common.artist || null,\n      //         id: elem.common.id || null,\n      //         title: elem.common.title || null,\n      //         duration: elem.duration || null,\n      //     };\n\n      //     return elem;\n      // });\n      const playlistMetadata = this.PlayList.map(track => ({\n        name: track.name,\n        size: track.size,\n        type: track.type,\n        lastModified: track.lastModified,\n        webkitRelativePath: track.webkitRelativePath,\n        common: {\n          album: track.common?.album || null,\n          artist: track.common?.artist || null,\n          id: track.common?.id || null,\n          title: track.common?.title || null,\n          duration: track.common?.duration || null\n        }\n      }));\n      const state = {\n        appType: 'mplayer',\n        durationAll: this.durationAll,\n        ShowConfig: this.ShowConfig,\n        totalFiles: this.totalFiles,\n        curFilesSize: this.curFilesSize,\n        audioDurations: this.audioDurations,\n        VolumeLvl: this.VolumeLvl,\n        VolumeLvl_save: this.VolumeLvl_save,\n        SilentMode: this.SilentMode,\n        ShuffleMode: this.ShuffleMode,\n        // PlayList: newPlayList,\n        // PlayList: this.PlayList,\n        PlayList: playlistMetadata,\n        timestamp: Date.now()\n      };\n      console.log('OSIMPlayer saving state:', state);\n      this.appsStore.saveWindowState(this.windowId, state);\n    },\n    // Сброс input (открывает возможность повторно загружать те-же файлы)\n    resetInput(inputElement) {\n      inputElement.value = '';\n    },\n    showError(message) {\n      alert(message);\n      console.error(message);\n    },\n    getAudioDurationSimple(track) {\n      return new Promise((resolve, reject) => {\n        const audio = new Audio();\n        const objectURL = URL.createObjectURL(track);\n        audio.src = objectURL;\n        const mkClean = () => {\n          audio.removeEventListener('loadedmetadata', onLoaded);\n          audio.removeEventListener('error', onError);\n          URL.revokeObjectURL(objectURL); // Освобождаем ссылку в памяти \"URL\" - сразу\n        };\n        const onLoaded = () => {\n          mkClean();\n          resolve(audio.duration);\n        };\n        // чистим ссылки, возвращаем ошибку\n        const onError = e => {\n          mkClean();\n          reject(e);\n        };\n        audio.addEventListener('loadedmetadata', onLoaded); //подписка на событие \"загрузка мета-данных\"\n        audio.addEventListener('error', onError); //подписка на событие \"ошибка\"\n\n        // Таймаут\n        setTimeout(() => {\n          mkClean();\n          reject(new Error('Timeout loading audio metadata'));\n        }, 3000);\n      });\n    },\n    async handleFileSelect(event) {\n      console.log('START:: handleFileSelect');\n      const files = Array.from(event.target.files);\n      const audioFiles = files.filter(file => this.isAudio(file));\n      if (audioFiles.length === 0) {\n        this.showError('Не было выбрано ни одного файла!');\n        this.resetInput(event.target);\n        return;\n      }\n      let cSize = 0;\n      files.forEach(function (item) {\n        cSize += item.size;\n      });\n      if (cSize > this.MAX_PLAYLIST_SIZE) {\n        this.showError('Превышен лимит доступной памяти! Максимальный размер - ' + this.MAX_PLAYLIST_SIZE / 1024 / 1024 + \"MB.\");\n        this.resetInput(event.target);\n        return;\n      }\n      this.isLoading = true;\n      this.totalFiles = audioFiles.length;\n      let validFiles = [];\n      for (let afile of audioFiles) {\n        try {\n          const afile_size = afile.size;\n          const afile_name = afile.name;\n          const blob = afile.slice(0, afile_size);\n          let parseData = await parseBlob(blob);\n          let trackDKey = `${afile_name}-${afile_size}`;\n          afile.common = {\n            ...parseData.common,\n            id: trackDKey\n          };\n          afile.common.url = this.getObjectURL(afile);\n          if (!this.audioDurations[trackDKey]) {\n            try {\n              let tduration = await this.getAudioDurationSimple(afile);\n              this.audioDurations[trackDKey] = tduration;\n              afile.common.duration = tduration;\n              this.durationAll += tduration;\n            } catch (error) {\n              console.warn(`Не удалось получить длительность для ${afile.name}:`, error);\n              this.audioDurations[trackDKey] = 0;\n            }\n          } else {\n            afile.common.duration = this.audioDurations[trackDKey];\n          }\n          validFiles.push(afile);\n        } catch (error) {\n          console.error('Ошибка при разборе файла: ', error);\n        }\n      }\n      this.isLoading = false;\n      if (validFiles.length > 0) {\n        this.PlayList = validFiles;\n        this.IsValidPlayList = true;\n      } else {\n        alert('Не было выбрано ни одного аудиофайла!');\n      }\n      setTimeout(() => {\n        this.saveState();\n      }, 300);\n    },\n    // проверка \"на аудиофайл\"\n    isAudio(file) {\n      if (file.size > this.MAX_FILE_SIZE) {\n        console.warn(`Файл ${file.name} слишком большой: ${file.size} bytes`);\n        return false;\n      }\n      const audioTypes = ['audio/mpeg', 'audio/wav', 'audio/flac', 'audio/ogg', 'audio/aac', 'audio/x-m4a'];\n      const extension = file.name.toLowerCase().split('.').pop();\n      const audioExtensions = ['mp3', 'wav', 'flac', 'ogg', 'aac', 'm4a'];\n      return audioTypes.includes(file.type) || audioExtensions.includes(extension);\n    },\n    formatDuration(seconds) {\n      if (!seconds || isNaN(seconds)) {\n        return '00:00';\n      } else {\n        return `${Math.floor(seconds / 60).toString().padStart(2, '0')}:${Math.floor(seconds % 60).toString().padStart(2, '0')}`;\n      }\n    },\n    VolimePlus() {\n      const AudioElement = document.querySelector('#main_audio');\n      if (AudioElement) {\n        if (this.VolumeLvl < 1) {\n          this.VolumeLvl = parseFloat((this.VolumeLvl + 0.1).toFixed(1));\n        }\n        AudioElement.volume = this.VolumeLvl;\n      }\n    },\n    VolumeMinus() {\n      const AudioElement = document.querySelector('#main_audio');\n      if (this.VolumeLvl > 0) {\n        this.VolumeLvl = parseFloat((this.VolumeLvl - 0.1).toFixed(1));\n      }\n      AudioElement.volume = this.VolumeLvl;\n    },\n    PlayerAction_Play() {\n      const AudioElement = document.querySelector('#main_audio');\n      if (AudioElement) {\n        AudioElement.play().then(() => {\n          this.isPlaying = true;\n        }).catch(error => {\n          console.error('Ошибка воспроизведения:', error);\n          this.isPlaying = false;\n          this.showError('Не удалось воспроизвести трек');\n        });\n      }\n    },\n    PlayerAction_Pause() {\n      const AudioElement = document.querySelector('#main_audio');\n      const preplist = this.PlayList;\n      if (AudioElement && preplist && preplist.length > 0) {\n        AudioElement.pause();\n        this.isPlaying = false;\n      }\n    },\n    PlayerAction_Stop() {\n      const AudioElement = document.querySelector('#main_audio');\n      const preplist = this.PlayList;\n      if (AudioElement && preplist && preplist.length > 0) {\n        this.PlayerAction_Pause();\n        setTimeout(() => {\n          this.TrackTime.current = 0;\n        }, 300);\n      }\n    },\n    PlayerAction_PrevTrack() {\n      const curindex = this.currentIndex;\n      const preplist = this.PlayList;\n      if (preplist && preplist.length > 0) {\n        this.PlayerAction_Pause();\n        if (!this.ShuffleMode) {\n          this.currentIndex = curindex == 0 ? preplist.length - 1 : curindex - 1;\n        } else {\n          this.currentIndex = this.Get_randomInteger(0, preplist.length - 1);\n        }\n        setTimeout(() => {\n          this.PlayerAction_Play();\n        }, 500);\n      }\n    },\n    PlayerAction_NextTrack() {\n      const curindex = this.currentIndex;\n      const preplist = this.PlayList;\n      if (preplist && preplist.length > 0) {\n        this.PlayerAction_Pause();\n        if (!this.ShuffleMode) {\n          this.currentIndex = curindex == preplist.length - 1 ? 0 : curindex + 1;\n        } else {\n          this.currentIndex = this.Get_randomInteger(0, preplist.length - 1);\n        }\n        setTimeout(() => {\n          this.PlayerAction_Play();\n        }, 500);\n      }\n    },\n    getObjectURL(track) {\n      const key = track.common.id;\n      if (!this.urlsData.has(key)) {\n        this.urlsData.set(key, URL.createObjectURL(track));\n      }\n      return this.urlsData.get(key);\n    },\n    Chng_TrackRangeTime() {\n      const AudioElement = document.querySelector('#main_audio');\n      const TrackTimeElement = document.querySelector('#main_tracktime');\n      AudioElement.currentTime = TrackTimeElement.value;\n    },\n    ShowerTime(iSec) {\n      if (iSec && typeof iSec == 'number') {\n        let inpSec = Math.trunc(iSec);\n        let strMin = Math.trunc(inpSec / 60) < 10 ? \"0\" + Math.trunc(inpSec / 60) : Math.trunc(inpSec / 60);\n        let strSec = inpSec % 60 < 10 ? \"0\" + inpSec % 60 : inpSec % 60;\n        return strMin + \":\" + strSec;\n      } else {\n        return \"00:00\";\n      }\n    },\n    onTimeUpdate: debounce(function (event) {\n      const audio = event.target;\n      this.TrackTime.current = audio.currentTime;\n      this.TrackTime.duration = audio.duration || 0;\n\n      // Обновляем слайдер\n      const trackTimeElement = document.querySelector('#main_tracktime');\n      if (trackTimeElement) {\n        trackTimeElement.value = this.TrackTime.current;\n      }\n    }, 100),\n    Chng_SilentMode() {\n      const Silent = this.SilentMode;\n      if (!Silent) {\n        this.VolumeLvl_save = this.VolumeLvl;\n        this.VolumeLvl = 0;\n      } else {\n        this.VolumeLvl = this.VolumeLvl_save;\n      }\n      this.SilentMode = !Silent;\n    },\n    Get_randomInteger(min, max) {\n      let rand = min + Math.random() * (max + 1 - min);\n      return Math.floor(rand);\n    },\n    Chng_ShuffleMode() {\n      this.ShuffleMode = !this.ShuffleMode;\n    },\n    SelectTrack(inpIndex) {\n      if (inpIndex !== this.currentIndex) {\n        this.PlayerAction_Pause();\n        this.currentIndex = inpIndex;\n        setTimeout(() => {\n          this.PlayerAction_Play();\n        }, 500);\n      }\n    },\n    Chng_CoverMode(modeIndex) {\n      this.CoverMode = modeIndex === 0 ? false : true;\n    },\n    updateCoverUrl() {\n      // Освобождаем предыдущий URL\n      if (this.prevCoverUrl) {\n        URL.revokeObjectURL(this.prevCoverUrl);\n      }\n      if (this.currentTrack?.common?.picture?.[0]) {\n        const cover = this.currentTrack.common.picture[0];\n        const blob = new Blob([cover.data], {\n          type: cover.format\n        });\n        this.currentCoverUrl = URL.createObjectURL(blob);\n        this.prevCoverUrl = this.currentCoverUrl;\n      } else {\n        this.currentCoverUrl = null;\n      }\n    },\n    Mk_trackSelectorAction() {\n      const actSelector = document.querySelector('#trackSelector_action');\n      let newList = [];\n      switch (actSelector.value) {\n        case 'DEL':\n          newList = this.PlayList.filter(elem => !this.trackSelector.includes(elem.common.id));\n          this.PlayerAction_Pause();\n          setTimeout(() => {\n            this.PlayList = newList;\n            this.trackSelector = [];\n            this.SelectTrack(0);\n            this.saveState();\n            this.PlayerAction_Play();\n          }, 500);\n          break;\n        default:\n          break;\n      }\n    },\n    ChngVal_ShowCOnfig(inpKey) {\n      this.ShowConfig.playlist[inpKey] = !this.ShowConfig.playlist[inpKey];\n    }\n  },\n  mounted() {\n    console.log('OSIMPlayer app mounted with windowId:', this.windowId);\n\n    // Инициализируем данные из store после монтирования\n    this.$nextTick(() => {\n      this.initFromStore();\n    });\n    const userLang = navigator.language || navigator.userLanguage;\n    const userLangS = userLang.split('-')[0];\n    this.UserLang = userLangS;\n    const LangPackData = LangPack;\n    this.lang_data = userLangS && LangPackData && LangPackData[userLangS] ? LangPackData[userLangS] : LangPackData.en;\n\n    // Сохраняем начальное состояние после небольшой задержки\n    setTimeout(() => {\n      // if (!this.isInitialized) {\n      //     this.initFromStore();\n      // }\n      this.saveState();\n    }, 100);\n  },\n  beforeUnmount() {\n    this.PlayerAction_Pause();\n\n    // Освобождаем все ObjectURL\n    if (this.currentCoverUrl) {\n      URL.revokeObjectURL(this.currentCoverUrl);\n    }\n    this.urlsData.forEach(url => URL.revokeObjectURL(url));\n    this.urlsData.clear();\n  }\n};","map":{"version":3,"names":["useAppsStore","LangPack","mapStores","parseBlob","debounce","name","props","windowId","type","String","required","data","lang_data","PlayList","isPlaying","durationAll","TargetTrack","ShowConfig","playlist","artist","album","duration","isLoading","totalFiles","MAX_FILE_SIZE","MAX_PLAYLIST_SIZE","curFilesSize","audioDurations","VolumeLvl","VolumeLvl_save","currentIndex","urlsData","Map","TrackTime","current","SilentMode","ShuffleMode","currentCoverUrl","prevCoverUrl","CoverMode","IsValidPlayList","isInitialized","trackSelector","computed","currentTrack","curindex","preplist","length","tr","currentTrack_time","ShowerTime","watch","handler","updateCoverUrl","immediate","console","log","saveState","methods","LangData","key","initFromStore","appsStore","error","savedState","getWindowState","appType","genre","playlistMetadata","map","track","size","lastModified","webkitRelativePath","common","id","title","state","timestamp","Date","now","saveWindowState","resetInput","inputElement","value","showError","message","alert","getAudioDurationSimple","Promise","resolve","reject","audio","Audio","objectURL","URL","createObjectURL","src","mkClean","removeEventListener","onLoaded","onError","revokeObjectURL","e","addEventListener","setTimeout","Error","handleFileSelect","event","files","Array","from","target","audioFiles","filter","file","isAudio","cSize","forEach","item","validFiles","afile","afile_size","afile_name","blob","slice","parseData","trackDKey","url","getObjectURL","tduration","warn","push","audioTypes","extension","toLowerCase","split","pop","audioExtensions","includes","formatDuration","seconds","isNaN","Math","floor","toString","padStart","VolimePlus","AudioElement","document","querySelector","parseFloat","toFixed","volume","VolumeMinus","PlayerAction_Play","play","then","catch","PlayerAction_Pause","pause","PlayerAction_Stop","PlayerAction_PrevTrack","Get_randomInteger","PlayerAction_NextTrack","has","set","get","Chng_TrackRangeTime","TrackTimeElement","currentTime","iSec","inpSec","trunc","strMin","strSec","onTimeUpdate","trackTimeElement","Chng_SilentMode","Silent","min","max","rand","random","Chng_ShuffleMode","SelectTrack","inpIndex","Chng_CoverMode","modeIndex","picture","cover","Blob","format","Mk_trackSelectorAction","actSelector","newList","elem","ChngVal_ShowCOnfig","inpKey","mounted","$nextTick","userLang","navigator","language","userLanguage","userLangS","UserLang","LangPackData","en","beforeUnmount","clear"],"sources":["C:\\projects\\My projects\\Vue\\osi\\src\\apps\\system\\OSIMPlayer\\OSIMPlayer.vue"],"sourcesContent":["<template src=\"./template.html\"></template>\r\n<style src=\"./style.css\"></style>\r\n<script>\r\n    import { useAppsStore } from '@/stores/apps.store';\r\n    import { LangPack } from './lang';\r\n    import { mapStores } from 'pinia';\r\n    import { parseBlob } from 'music-metadata';\r\n    import debounce from 'lodash/debounce';\r\n\r\n    export default {\r\n        name: 'OSIMPlayer',\r\n\r\n        props: {\r\n            windowId: { type: String, required: true },\r\n        },\r\n\r\n        data() {\r\n            return {\r\n                lang_data: {},\r\n                PlayList: [],\r\n                isPlaying: false,\r\n                durationAll: 0,\r\n                TargetTrack: null,\r\n                ShowConfig: {\r\n                    playlist: {\r\n                        artist: true,\r\n                        album: true,\r\n                        duration: true,\r\n                    }\r\n                },\r\n                isLoading: false,\r\n                totalFiles: 0,\r\n                MAX_FILE_SIZE: 100 * 1024 * 1024, // 100MB,\r\n                MAX_PLAYLIST_SIZE: 1000 * 1024 * 1024, // 1000MB,\r\n                curFilesSize: 0,\r\n                audioDurations: {}, // Объект для \"длительностей\"\r\n                VolumeLvl: 0.5,\r\n                VolumeLvl_save: 0.5,\r\n                currentIndex: 0,\r\n                urlsData: new Map(),\r\n                TrackTime: { current: 0, duration: 0},\r\n                SilentMode: false,\r\n                ShuffleMode: false,\r\n                currentCoverUrl: null,\r\n                prevCoverUrl: null,\r\n                CoverMode: true,\r\n                IsValidPlayList: false,\r\n                isInitialized: false,\r\n                trackSelector: [],\r\n            }\r\n        },\r\n        \r\n        computed: {\r\n            ...mapStores(useAppsStore),\r\n\r\n            currentTrack() {\r\n                const curindex = this.currentIndex + '';\r\n                const preplist = this.PlayList;\r\n\r\n                if (preplist && preplist.length > 0 && curindex) {\r\n                    let tr = preplist[curindex];\r\n                    return tr;\r\n                } else {\r\n                    return null;\r\n                }\r\n            },\r\n\r\n            currentTrack_time() {\r\n                return this.ShowerTime(this.TrackTime.current);\r\n            },\r\n        },\r\n\r\n        watch: {\r\n            currentTrack: {\r\n                handler() {\r\n                    this.updateCoverUrl();\r\n                },\r\n                immediate: true\r\n            },\r\n\r\n            trackSelector() {\r\n                console.log(\"trackSelector\", this.trackSelector);\r\n            },\r\n\r\n            // при изменении любого из следующих параметров (при пройденой инициализации) - вызываем фун-ю сохранения состояния\r\n            // PlayList() { if (this.isInitialized) { this.saveState(); } },   //плейлист\r\n            // ShowConfig() { if (this.isInitialized) { this.saveState(); } },   //конфиг отображения\r\n            VolumeLvl() { if (this.isInitialized) { this.saveState(); } },   //уровень громкости\r\n            SilentMode() { if (this.isInitialized) { this.saveState(); } },   //режим без звука\r\n            ShuffleMode() { if (this.isInitialized) { this.saveState(); } },   //режим случайного воспроизведения\r\n        },\r\n\r\n        methods: {\r\n            LangData(key) {\r\n                return this.lang_data[key] || '';\r\n            },\r\n            // Инициализация из store\r\n            initFromStore() {\r\n                console.log('START:: initFromStore');\r\n                if (!this.windowId || !this.appsStore) {\r\n                    console.error('OSIMPlayer: windowId or appsStore is missing');\r\n                    return;\r\n                }\r\n            \r\n                const savedState = this.appsStore.getWindowState(this.windowId);\r\n                console.log('OSIMPlayer loaded state:', savedState);\r\n            \r\n                if (savedState && savedState.appType === 'mplayer') {\r\n                    this.durationAll = savedState.durationAll || 0;\r\n                    this.ShowConfig = savedState.ShowConfig || { playlist: { artist: true, album: true, genre: true, duration: true } };\r\n                    this.totalFiles = savedState.totalFiles || 0;\r\n                    this.curFilesSize = savedState.curFilesSize || 0;\r\n                    this.audioDurations = savedState.audioDurations || {};\r\n                    this.VolumeLvl = savedState.VolumeLvl || 0.5;\r\n                    this.VolumeLvl_save = savedState.VolumeLvl_save || 0.5;\r\n                    this.SilentMode = savedState.SilentMode || false;\r\n                    this.ShuffleMode = savedState.ShuffleMode || false;\r\n                    this.PlayList = savedState.PlayList || [];\r\n                }\r\n                \r\n                this.isInitialized = true;\r\n                console.log('OSIMPlayer initialized');\r\n            },\r\n\r\n            async saveState() {\r\n                console.log('START:: saveState');\r\n                if (!this.windowId || !this.appsStore || !this.isInitialized) return;\r\n\r\n                // let newPlayList = this.PlayList;\r\n                // newPlayList.map(function(elem) {\r\n                //     elem.common = {\r\n                //         album: elem.common.album || null,\r\n                //         artist: elem.common.artist || null,\r\n                //         id: elem.common.id || null,\r\n                //         title: elem.common.title || null,\r\n                //         duration: elem.duration || null,\r\n                //     };\r\n                    \r\n                //     return elem;\r\n                // });\r\n                const playlistMetadata = this.PlayList.map(track => ({\r\n                    name: track.name,\r\n                    size: track.size,\r\n                    type: track.type,\r\n                    lastModified: track.lastModified,\r\n                    webkitRelativePath: track.webkitRelativePath,\r\n                    common: {\r\n                        album: track.common?.album || null,\r\n                        artist: track.common?.artist || null,\r\n                        id: track.common?.id || null,\r\n                        title: track.common?.title || null,\r\n                        duration: track.common?.duration || null,\r\n                    }\r\n                    }));\r\n                \r\n                const state = {\r\n                    appType: 'mplayer',\r\n                    durationAll: this.durationAll,\r\n                    ShowConfig: this.ShowConfig,\r\n                    totalFiles: this.totalFiles,\r\n                    curFilesSize: this.curFilesSize,\r\n                    audioDurations: this.audioDurations,\r\n                    VolumeLvl: this.VolumeLvl,\r\n                    VolumeLvl_save: this.VolumeLvl_save,\r\n                    SilentMode: this.SilentMode,\r\n                    ShuffleMode: this.ShuffleMode,\r\n                    // PlayList: newPlayList,\r\n                    // PlayList: this.PlayList,\r\n                    PlayList: playlistMetadata,\r\n                    timestamp: Date.now()\r\n                };\r\n                \r\n                console.log('OSIMPlayer saving state:', state);\r\n                this.appsStore.saveWindowState(this.windowId, state);\r\n            },\r\n\r\n            // Сброс input (открывает возможность повторно загружать те-же файлы)\r\n            resetInput(inputElement) { inputElement.value = ''; },\r\n\r\n            showError(message) {\r\n                alert(message);\r\n                console.error(message);\r\n            },\r\n\r\n            getAudioDurationSimple(track) {\r\n                return new Promise((resolve, reject) => {\r\n                    const audio = new Audio();\r\n                    const objectURL = URL.createObjectURL(track);\r\n\r\n                    audio.src = objectURL;\r\n\r\n                    const mkClean = () => {\r\n                        audio.removeEventListener('loadedmetadata', onLoaded);\r\n                        audio.removeEventListener('error', onError);\r\n                        URL.revokeObjectURL(objectURL); // Освобождаем ссылку в памяти \"URL\" - сразу\r\n                    };\r\n\r\n                    const onLoaded = () => {\r\n                        mkClean();\r\n                        resolve(audio.duration);\r\n                    };\r\n                    // чистим ссылки, возвращаем ошибку\r\n                    const onError = (e) => {\r\n                        mkClean();\r\n                        reject(e);\r\n                    };\r\n                    \r\n                    audio.addEventListener('loadedmetadata', onLoaded); //подписка на событие \"загрузка мета-данных\"\r\n                    audio.addEventListener('error', onError); //подписка на событие \"ошибка\"\r\n                    \r\n                    // Таймаут\r\n                    setTimeout(() => {\r\n                        mkClean();\r\n                        reject(new Error('Timeout loading audio metadata'));\r\n                    }, 3000);\r\n                });\r\n            },\r\n            \r\n            async handleFileSelect(event) {\r\n                console.log('START:: handleFileSelect');\r\n                const files = Array.from(event.target.files);\r\n                const audioFiles = files.filter(file => this.isAudio(file));\r\n\r\n                if (audioFiles.length === 0) {\r\n                    this.showError('Не было выбрано ни одного файла!');\r\n                    this.resetInput(event.target);\r\n                    \r\n                    return;\r\n                }\r\n\r\n                let cSize = 0;\r\n                files.forEach(function(item) { cSize += item.size; });\r\n\r\n                if (cSize > this.MAX_PLAYLIST_SIZE) {\r\n                    this.showError('Превышен лимит доступной памяти! Максимальный размер - ' + (this.MAX_PLAYLIST_SIZE / 1024 / 1024) + \"MB.\");\r\n                    this.resetInput(event.target);\r\n\r\n                    return;\r\n                }\r\n\r\n                this.isLoading = true;\r\n                this.totalFiles = audioFiles.length;\r\n\r\n                let validFiles = [];\r\n\r\n                for (let afile of audioFiles) {\r\n                    try {\r\n                        const afile_size = afile.size;\r\n                        const afile_name = afile.name;\r\n                        const blob = afile.slice(0, afile_size);\r\n\r\n                        let parseData = await parseBlob(blob);\r\n                        let trackDKey = `${afile_name}-${afile_size}`;\r\n\r\n                        afile.common = {\r\n                            ...parseData.common,\r\n                            id: trackDKey,                            \r\n                        };\r\n\r\n                        afile.common.url = this.getObjectURL(afile);                        \r\n\r\n                        if (!this.audioDurations[trackDKey]) {\r\n                            try {\r\n                                let tduration = await this.getAudioDurationSimple(afile);\r\n\r\n                                this.audioDurations[trackDKey] = tduration;\r\n                                afile.common.duration = tduration;\r\n                                this.durationAll += tduration;\r\n                            } catch (error) {\r\n                                console.warn(`Не удалось получить длительность для ${afile.name}:`, error);\r\n                                this.audioDurations[trackDKey] = 0;\r\n                            }\r\n                        } else {\r\n                            afile.common.duration = this.audioDurations[trackDKey];\r\n                        }\r\n\r\n                        validFiles.push(afile);\r\n                    } catch (error) {\r\n                        console.error('Ошибка при разборе файла: ', error);\r\n                    }\r\n                }\r\n\r\n                this.isLoading = false;\r\n\r\n                if (validFiles.length > 0) {\r\n                    this.PlayList = validFiles;\r\n                    this.IsValidPlayList = true;\r\n                } else {\r\n                    alert('Не было выбрано ни одного аудиофайла!');\r\n                }\r\n\r\n                setTimeout(() => {\r\n                    this.saveState();\r\n                }, 300);\r\n            },\r\n\r\n            // проверка \"на аудиофайл\"\r\n            isAudio(file) {\r\n                if (file.size > this.MAX_FILE_SIZE) {\r\n                    console.warn(`Файл ${file.name} слишком большой: ${file.size} bytes`);\r\n                    return false;\r\n                }\r\n\r\n                const audioTypes = [ 'audio/mpeg', 'audio/wav', 'audio/flac', 'audio/ogg', 'audio/aac', 'audio/x-m4a' ];\r\n                const extension = file.name.toLowerCase().split('.').pop();\r\n                const audioExtensions = ['mp3', 'wav', 'flac', 'ogg', 'aac', 'm4a'];\r\n            \r\n                return audioTypes.includes(file.type) || audioExtensions.includes(extension);\r\n            },\r\n\r\n            formatDuration(seconds) {\r\n                if (!seconds || isNaN(seconds)) {\r\n                    return '00:00';\r\n                } else {\r\n                    return `${Math.floor(seconds / 60).toString().padStart(2, '0')}:${Math.floor(seconds % 60).toString().padStart(2, '0')}`;\r\n                }\r\n            },\r\n\r\n            VolimePlus() {\r\n                const AudioElement = document.querySelector('#main_audio');\r\n\r\n                if (AudioElement) {\r\n                    if (this.VolumeLvl < 1) {\r\n                        this.VolumeLvl = parseFloat((this.VolumeLvl + 0.1).toFixed(1));\r\n                    }\r\n                    AudioElement.volume = this.VolumeLvl;\r\n                }\r\n            },\r\n            VolumeMinus() {\r\n                const AudioElement = document.querySelector('#main_audio');\r\n                if (this.VolumeLvl > 0) {\r\n                    this.VolumeLvl = parseFloat((this.VolumeLvl - 0.1).toFixed(1));\r\n                }\r\n                AudioElement.volume = this.VolumeLvl;\r\n            },\r\n\r\n            PlayerAction_Play() {\r\n                const AudioElement = document.querySelector('#main_audio');\r\n                \r\n                if (AudioElement) {\r\n                AudioElement.play()\r\n                    .then(() => {\r\n                        this.isPlaying = true;\r\n                    })\r\n                    .catch(error => {\r\n                        console.error('Ошибка воспроизведения:', error);\r\n                        \r\n                        this.isPlaying = false;\r\n                        this.showError('Не удалось воспроизвести трек');\r\n                    });\r\n                }\r\n            },\r\n            PlayerAction_Pause() {\r\n                const AudioElement = document.querySelector('#main_audio');\r\n                const preplist = this.PlayList;\r\n\r\n                if (AudioElement && preplist && preplist.length > 0) {\r\n                    AudioElement.pause();\r\n                    this.isPlaying = false;\r\n                }\r\n            },\r\n            PlayerAction_Stop() {\r\n                const AudioElement = document.querySelector('#main_audio');\r\n                const preplist = this.PlayList;\r\n\r\n                if (AudioElement && preplist && preplist.length > 0) {\r\n                    this.PlayerAction_Pause();\r\n                    \r\n                    setTimeout(() => {\r\n                        this.TrackTime.current = 0;\r\n                    }, 300);\r\n                }                \r\n            },\r\n            PlayerAction_PrevTrack() {\r\n                const curindex = this.currentIndex;\r\n                const preplist = this.PlayList;                \r\n\r\n                if (preplist && preplist.length > 0) {\r\n                    this.PlayerAction_Pause();\r\n\r\n                    if (!this.ShuffleMode) {\r\n                        this.currentIndex = (curindex == 0) ? (preplist.length - 1) : (curindex - 1);\r\n                    } else {\r\n                        this.currentIndex = this.Get_randomInteger(0, (preplist.length - 1));\r\n                    }\r\n\r\n                    setTimeout(() => {\r\n                        this.PlayerAction_Play();\r\n                    }, 500);\r\n                }\r\n            },\r\n            PlayerAction_NextTrack() {\r\n                const curindex = this.currentIndex;\r\n                const preplist = this.PlayList;\r\n\r\n                if (preplist && preplist.length > 0) {\r\n                    this.PlayerAction_Pause();\r\n\r\n                    if (!this.ShuffleMode) {\r\n                        this.currentIndex = (curindex == (preplist.length - 1)) ? 0 : curindex + 1;\r\n                    } else {\r\n                        this.currentIndex = this.Get_randomInteger(0, (preplist.length - 1));\r\n                    }\r\n\r\n                    setTimeout(() => {\r\n                        this.PlayerAction_Play();\r\n                    }, 500);\r\n                    \r\n                }\r\n            },\r\n\r\n            getObjectURL(track) {\r\n                const key = track.common.id;\r\n\r\n                if (!this.urlsData.has(key)) {\r\n                    this.urlsData.set(key, URL.createObjectURL(track));\r\n                }\r\n                return this.urlsData.get(key);\r\n            },\r\n\r\n            Chng_TrackRangeTime() {\r\n                const AudioElement = document.querySelector('#main_audio');\r\n                const TrackTimeElement = document.querySelector('#main_tracktime');\r\n\r\n                AudioElement.currentTime = TrackTimeElement.value;\r\n            },\r\n\r\n            ShowerTime(iSec) {\r\n                if (iSec && typeof iSec == 'number') {\r\n                    let inpSec = Math.trunc(iSec);\r\n                    let strMin = (Math.trunc(inpSec / 60) < 10) ? (\"0\" + Math.trunc(inpSec / 60)) : Math.trunc(inpSec / 60);\r\n                    let strSec = (inpSec % 60 < 10) ? (\"0\" + (inpSec % 60)) : (inpSec % 60);\r\n\r\n                    return strMin + \":\" + strSec;\r\n                } else {\r\n                    return \"00:00\";\r\n                }\r\n            },\r\n\r\n            onTimeUpdate: debounce(function(event) {\r\n                const audio = event.target;\r\n\r\n                this.TrackTime.current = audio.currentTime;\r\n                this.TrackTime.duration = audio.duration || 0;\r\n                \r\n                // Обновляем слайдер\r\n                const trackTimeElement = document.querySelector('#main_tracktime');\r\n\r\n                if (trackTimeElement) {\r\n                    trackTimeElement.value = this.TrackTime.current;\r\n                }\r\n            }, 100),\r\n\r\n            Chng_SilentMode() {\r\n                const Silent = this.SilentMode;\r\n\r\n                if (!Silent) {\r\n                    this.VolumeLvl_save = this.VolumeLvl;\r\n                    this.VolumeLvl = 0;\r\n                } else {\r\n                    this.VolumeLvl = this.VolumeLvl_save;\r\n                }\r\n\r\n                this.SilentMode = !Silent;\r\n            },\r\n\r\n            Get_randomInteger(min, max) {\r\n                let rand = min + Math.random() * (max + 1 - min);\r\n                \r\n                return Math.floor(rand);\r\n            },\r\n\r\n            Chng_ShuffleMode() { this.ShuffleMode = !this.ShuffleMode; },\r\n\r\n            SelectTrack(inpIndex) {\r\n                if (inpIndex !== this.currentIndex) {\r\n                    this.PlayerAction_Pause();\r\n                    this.currentIndex = inpIndex;\r\n\r\n                    setTimeout(() => {                    \r\n                        this.PlayerAction_Play();\r\n                    }, 500);\r\n                }\r\n            },\r\n\r\n            Chng_CoverMode(modeIndex) { this.CoverMode = (modeIndex === 0) ? false : true; },\r\n\r\n            updateCoverUrl() {\r\n                // Освобождаем предыдущий URL\r\n                if (this.prevCoverUrl) {\r\n                    URL.revokeObjectURL(this.prevCoverUrl);\r\n                }\r\n                \r\n                if (this.currentTrack?.common?.picture?.[0]) {\r\n                    const cover = this.currentTrack.common.picture[0];\r\n                    const blob = new Blob([cover.data], { type: cover.format });\r\n                    \r\n                    this.currentCoverUrl = URL.createObjectURL(blob);\r\n                    this.prevCoverUrl = this.currentCoverUrl;\r\n                } else {\r\n                    this.currentCoverUrl = null;\r\n                }\r\n            },\r\n\r\n            Mk_trackSelectorAction() {\r\n                const actSelector = document.querySelector('#trackSelector_action');\r\n                let newList = [];\r\n\r\n                switch (actSelector.value) {\r\n                    case 'DEL':\r\n                        newList = this.PlayList.filter(elem => !this.trackSelector.includes(elem.common.id));\r\n                        \r\n                        this.PlayerAction_Pause();\r\n                        \r\n                        setTimeout(() => {                    \r\n                            this.PlayList = newList;\r\n                            this.trackSelector = [];\r\n                            this.SelectTrack(0);\r\n                            this.saveState();\r\n                            this.PlayerAction_Play();\r\n                        }, 500);\r\n\r\n                        break;\r\n                    default:\r\n                        break;\r\n                }\r\n            },\r\n\r\n            ChngVal_ShowCOnfig(inpKey) {\r\n                this.ShowConfig.playlist[inpKey] = !this.ShowConfig.playlist[inpKey];\r\n            },\r\n        },\r\n\r\n        mounted() {\r\n            console.log('OSIMPlayer app mounted with windowId:', this.windowId);\r\n\r\n            // Инициализируем данные из store после монтирования\r\n            this.$nextTick(() => {\r\n                this.initFromStore();\r\n            });\r\n\r\n            const userLang = navigator.language || navigator.userLanguage;\r\n            const userLangS = userLang.split('-')[0];\r\n            \r\n            this.UserLang = userLangS; \r\n            \r\n            const LangPackData = LangPack;\r\n\r\n            this.lang_data = (userLangS && LangPackData && LangPackData[userLangS]) ? LangPackData[userLangS] : LangPackData.en;\r\n\r\n            // Сохраняем начальное состояние после небольшой задержки\r\n            setTimeout(() => {\r\n                // if (!this.isInitialized) {\r\n                //     this.initFromStore();\r\n                // }\r\n                this.saveState();\r\n            }, 100);\r\n        },\r\n\r\n        beforeUnmount() {\r\n            this.PlayerAction_Pause();\r\n\r\n            // Освобождаем все ObjectURL\r\n            if (this.currentCoverUrl) {\r\n                URL.revokeObjectURL(this.currentCoverUrl);\r\n            }\r\n\r\n            this.urlsData.forEach(url => URL.revokeObjectURL(url));\r\n            this.urlsData.clear();\r\n        },\r\n    }\r\n</script>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}