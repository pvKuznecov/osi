{"ast":null,"code":"import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, renderSlot as _renderSlot, vShow as _vShow, normalizeClass as _normalizeClass, normalizeStyle as _normalizeStyle, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"title\"\n};\nconst _hoisted_2 = {\n  class: \"window-content\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _withDirectives((_openBlock(), _createElementBlock(\"div\", {\n    class: _normalizeClass([\"window\", {\n      'active': $setup.isActive\n    }]),\n    style: _normalizeStyle($setup.windowStyles),\n    onMousedown: $setup.onWindowMouseDown\n  }, [_createElementVNode(\"div\", {\n    class: \"title-bar\",\n    onMousedown: $setup.startDrag\n  }, [_createElementVNode(\"span\", _hoisted_1, _toDisplayString($props.title), 1 /* TEXT */), _createElementVNode(\"div\", {\n    class: \"window-controls\"\n  }, [_createElementVNode(\"button\", {\n    class: \"minimize-btn\",\n    onClick: $setup.minimize\n  }, \"_\"), _createElementVNode(\"button\", {\n    class: \"maximize-btn\",\n    onClick: $setup.toggleMaximize\n  }, \"□\"), _createElementVNode(\"button\", {\n    class: \"close-btn\",\n    onClick: $setup.close\n  }, \"✕\")])], 32 /* NEED_HYDRATION */), _createElementVNode(\"div\", _hoisted_2, [_renderSlot(_ctx.$slots, \"default\", {}, undefined, true)])], 38 /* CLASS, STYLE, NEED_HYDRATION */)), [[_vShow, !$setup.isMinimized]]);\n}","map":{"version":3,"names":["class","_createElementBlock","_normalizeClass","$setup","isActive","style","_normalizeStyle","windowStyles","onMousedown","onWindowMouseDown","_createElementVNode","startDrag","_hoisted_1","_toDisplayString","$props","title","onClick","minimize","toggleMaximize","close","_hoisted_2","_renderSlot","_ctx","$slots","undefined","isMinimized"],"sources":["/home/kup/my_projects/vue/osi/src/components/os/Window.vue"],"sourcesContent":["<template>\n  <div \n    class=\"window\" \n    :class=\"{ 'active': isActive }\"\n    :style=\"windowStyles\"\n    v-show=\"!isMinimized\"\n    @mousedown=\"onWindowMouseDown\"\n  >\n    <div class=\"title-bar\" @mousedown=\"startDrag\">\n      <span class=\"title\">{{ title }}</span>\n      <div class=\"window-controls\">\n        <button class=\"minimize-btn\" @click=\"minimize\">_</button>\n        <button class=\"maximize-btn\" @click=\"toggleMaximize\">□</button>\n        <button class=\"close-btn\" @click=\"close\">✕</button>\n      </div>\n    </div>\n    <div class=\"window-content\">\n      <slot></slot>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { computed, ref, onMounted, onUnmounted } from 'vue'\nimport { useOsStore } from '../../stores/os.store'\n\nconst props = defineProps({\n  windowId: {\n    type: String,\n    required: true\n  },\n  title: {\n    type: String,\n    default: 'Окно'\n  },\n  initialWidth: {\n    type: Number,\n    default: 600\n  },\n  initialHeight: {\n    type: Number,\n    default: 400\n  }\n})\n\nconst osStore = useOsStore()\n\n// Локальное состояние для перетаскивания\nconst isDragging = ref(false)\nconst dragOffset = ref({ x: 0, y: 0 })\n\n// Находим состояние окна в хранилище\nconst windowState = computed(() => \n  osStore.windows.find(w => w.id === props.windowId) || {}\n)\n\nconst isActive = computed(() => osStore.activeWindowId === props.windowId)\nconst isMinimized = computed(() => windowState.value.isMinimized || false)\n\nconst windowStyles = computed(() => ({\n  left: `${windowState.value.position?.x || 100}px`,\n  top: `${windowState.value.position?.y || 100}px`,\n  width: `${windowState.value.size?.width || props.initialWidth}px`,\n  height: `${windowState.value.size?.height || props.initialHeight}px`,\n  zIndex: windowState.value.zIndex || 1\n}))\n\n// Обработчики событий окна\nconst minimize = () => {\n  // Пока просто скрываем, позже добавим в osStore\n  osStore.windows = osStore.windows.map(w => \n    w.id === props.windowId ? { ...w, isMinimized: true } : w\n  )\n}\n\nconst toggleMaximize = () => {\n  osStore.windows = osStore.windows.map(w => \n    w.id === props.windowId ? { ...w, isMaximized: !w.isMaximized } : w\n  )\n}\n\nconst close = () => {\n  osStore.closeWindow(props.windowId)\n}\n\n// Логика перетаскивания окна\nconst startDrag = (e) => {\n  osStore.bringToFront(props.windowId)\n  \n  const rect = e.currentTarget.getBoundingClientRect()\n  dragOffset.value = {\n    x: e.clientX - rect.left,\n    y: e.clientY - rect.top\n  }\n  isDragging.value = true\n  \n  e.preventDefault()\n}\n\nconst onWindowMouseDown = () => {\n  osStore.bringToFront(props.windowId)\n}\n\n// Глобальные обработчики мыши для перетаскивания\nonMounted(() => {\n  const handleMouseMove = (e) => {\n    if (!isDragging.value) return\n    \n    const window = osStore.windows.find(w => w.id === props.windowId)\n    if (window) {\n      window.position = {\n        x: e.clientX - dragOffset.value.x,\n        y: e.clientY - dragOffset.value.y\n      }\n    }\n  }\n  \n  const handleMouseUp = () => {\n    isDragging.value = false\n  }\n  \n  document.addEventListener('mousemove', handleMouseMove)\n  document.addEventListener('mouseup', handleMouseUp)\n  \n  onUnmounted(() => {\n    document.removeEventListener('mousemove', handleMouseMove)\n    document.removeEventListener('mouseup', handleMouseUp)\n  })\n})\n</script>\n\n<style scoped>\n.window {\n  position: absolute;\n  background: white;\n  border: 1px solid #ccc;\n  border-radius: 8px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n  min-width: 200px;\n  min-height: 150px;\n}\n\n.window.active {\n  border-color: #0078d4;\n}\n\n.title-bar {\n  background: linear-gradient(to bottom, #f0f0f0, #e0e0e0);\n  padding: 8px 12px;\n  cursor: move;\n  user-select: none;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  border-bottom: 1px solid #ccc;\n}\n\n.title {\n  font-weight: bold;\n  font-size: 14px;\n}\n\n.window-controls {\n  display: flex;\n  gap: 4px;\n}\n\n.window-controls button {\n  width: 24px;\n  height: 24px;\n  border: 1px solid #aaa;\n  background: #f9f9f9;\n  border-radius: 3px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 12px;\n}\n\n.window-controls button:hover {\n  background: #e9e9e9;\n}\n\n.close-btn:hover {\n  background: #e81123 !important;\n  color: white;\n  border-color: #e81123;\n}\n\n.window-content {\n  flex: 1;\n  padding: 12px;\n  overflow: auto;\n  background: white;\n}\n</style>"],"mappings":";;EASYA,KAAK,EAAC;AAAO;;EAOhBA,KAAK,EAAC;AAAgB;;wCAf7BC,mBAAA,CAkBM;IAjBJD,KAAK,EAAAE,eAAA,EAAC,QAAQ;MAAA,UACMC,MAAA,CAAAC;IAAQ;IAC3BC,KAAK,EAAAC,eAAA,CAAEH,MAAA,CAAAI,YAAY;IAEnBC,WAAS,EAAEL,MAAA,CAAAM;MAEZC,mBAAA,CAOM;IAPDV,KAAK,EAAC,WAAW;IAAEQ,WAAS,EAAEL,MAAA,CAAAQ;MACjCD,mBAAA,CAAsC,QAAtCE,UAAsC,EAAAC,gBAAA,CAAfC,MAAA,CAAAC,KAAK,kBAC5BL,mBAAA,CAIM;IAJDV,KAAK,EAAC;EAAiB,IAC1BU,mBAAA,CAAyD;IAAjDV,KAAK,EAAC,cAAc;IAAEgB,OAAK,EAAEb,MAAA,CAAAc;KAAU,GAAC,GAChDP,mBAAA,CAA+D;IAAvDV,KAAK,EAAC,cAAc;IAAEgB,OAAK,EAAEb,MAAA,CAAAe;KAAgB,GAAC,GACtDR,mBAAA,CAAmD;IAA3CV,KAAK,EAAC,WAAW;IAAEgB,OAAK,EAAEb,MAAA,CAAAgB;KAAO,GAAC,E,8BAG9CT,mBAAA,CAEM,OAFNU,UAEM,GADJC,WAAA,CAAaC,IAAA,CAAAC,MAAA,iBAAAC,SAAA,Q,wDAZNrB,MAAA,CAAAsB,WAAW,E","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}