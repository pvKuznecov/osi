{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport { useOSIAppsStore } from '@/stores/os.apps.store';\nimport { mapStores } from 'pinia';\nexport default {\n  name: 'OSICalculator',\n  props: {\n    windowId: {\n      type: String,\n      required: true\n    }\n  },\n  data() {\n    // Инициализируем базовые значения, НЕ используем this.appsStore здесь\n    return {\n      expression: '',\n      result: '0',\n      history: [],\n      lastResult: null,\n      isInitialized: false // Флаг инициализации\n    };\n  },\n  computed: {\n    ...mapStores(useOSIAppsStore),\n    appsStore() {\n      return this.osiAppsStore;\n    },\n    reversedHistory() {\n      return [...this.history].reverse().slice(0, 5);\n    }\n  },\n  watch: {\n    // Отслеживаем изменения только после инициализации\n    expression() {\n      if (this.isInitialized) {\n        this.calculate();\n        this.saveState();\n      }\n    },\n    history: {\n      handler() {\n        if (this.isInitialized) {\n          this.saveState();\n        }\n      },\n      deep: true\n    },\n    result() {\n      if (this.isInitialized) {\n        this.saveState();\n      }\n    },\n    // Следим за активным окном в store\n    'appsStore.activeWindowId': {\n      handler(newActiveWindowId) {\n        // Если наше окно стало активным, проверяем состояние\n        if (newActiveWindowId === this.windowId && this.isInitialized) {\n          console.log('Calculator window activated, checking state...');\n          this.checkAndReloadState();\n        }\n      }\n    }\n  },\n  methods: {\n    // Проверить и перезагрузить состояние\n    checkAndReloadState() {\n      if (!this.windowId || !this.appsStore) return;\n      const savedState = this.appsStore.getWindowState(this.windowId);\n      console.log('Checking state on activation:', savedState);\n\n      // Если состояние в store отличается от текущего, загружаем его\n      if (savedState && savedState.appType === 'calculator') {\n        // Сравниваем timestamp или другие метрики\n        const currentState = {\n          expression: this.expression,\n          result: this.result,\n          history: this.history,\n          lastResult: this.lastResult\n        };\n\n        // Простая проверка - если история разная, загружаем\n        if (JSON.stringify(savedState.history) !== JSON.stringify(this.history)) {\n          console.log('State changed in store, reloading...');\n          this.expression = savedState.expression || '';\n          this.result = savedState.result || '0';\n          this.history = savedState.history || [];\n          this.lastResult = savedState.lastResult || null;\n        }\n      }\n    },\n    // Инициализация из store\n    initFromStore() {\n      console.log(\"initFromStore - windowId:\", this.windowId);\n      console.log(\"initFromStore - appsStore:\", this.appsStore);\n      if (!this.windowId) {\n        console.error('CalculatorApp: windowId is missing');\n        return;\n      }\n      if (!this.appsStore) {\n        console.error('CalculatorApp: appsStore is not available');\n        return;\n      }\n      const savedState = this.appsStore.getWindowState(this.windowId);\n      console.log('CalculatorApp loaded state for window', this.windowId, ':', savedState);\n      if (savedState && savedState.appType === 'calculator') {\n        this.expression = savedState.expression || '';\n        this.result = savedState.result || '0';\n        this.history = savedState.history || [];\n        this.lastResult = savedState.lastResult || null;\n      }\n      this.isInitialized = true;\n      console.log('CalculatorApp initialized for window:', this.windowId);\n    },\n    // Сохраняем текущее состояние в store\n    saveState() {\n      if (!this.isInitialized) return;\n      if (!this.windowId) {\n        console.error('Cannot save: windowId is missing');\n        return;\n      }\n      if (!this.appsStore || typeof this.appsStore.saveWindowState !== 'function') {\n        console.error('Cannot save: appsStore or saveWindowState is not available');\n        return;\n      }\n      const state = {\n        appType: 'calculator',\n        expression: this.expression,\n        result: this.result,\n        lastResult: this.lastResult,\n        history: [...this.history],\n        timestamp: Date.now()\n      };\n      console.log('CalculatorApp saving state for window', this.windowId, ':', state);\n      this.appsStore.saveWindowState(this.windowId, state);\n    },\n    // Добавление цифры\n    appendNumber(number) {\n      if (this.lastResult !== null && !this.expression.includes('+') && !this.expression.includes('-') && !this.expression.includes('×') && !this.expression.includes('÷')) {\n        this.expression = '';\n        this.lastResult = null;\n      }\n      this.expression += number;\n    },\n    // Добавление операции\n    appendOperation(operation) {\n      if (!this.expression) {\n        if (this.lastResult !== null) {\n          this.expression = this.lastResult + operation;\n        } else {\n          return;\n        }\n      } else {\n        const lastChar = this.expression.slice(-1);\n        if (['+', '-', '×', '÷'].includes(lastChar)) {\n          this.expression = this.expression.slice(0, -1) + operation;\n        } else {\n          this.expression += operation;\n        }\n      }\n      this.lastResult = null;\n    },\n    // Добавление десятичной точки\n    appendDecimal() {\n      if (!this.expression || ['+', '-', '×', '÷'].includes(this.expression.slice(-1))) {\n        this.expression += '0.';\n      } else if (!this.expression.split(/[+\\-×÷]/).pop().includes('.')) {\n        this.expression += '.';\n      }\n    },\n    // Вычисление результата\n    calculate() {\n      if (!this.expression) {\n        this.result = '0';\n        return;\n      }\n      try {\n        let expr = this.expression.replace(/×/g, '*').replace(/÷/g, '/');\n        let calcResult = eval(expr);\n        if (calcResult % 1 !== 0) {\n          calcResult = parseFloat(calcResult.toFixed(10));\n        }\n        this.result = calcResult;\n      } catch (error) {\n        this.result = 'Ошибка';\n      }\n    },\n    // Выполнить вычисление и добавить в историю\n    calculateAndAddHistory() {\n      if (!this.expression) return;\n      const oldExpression = this.expression;\n      this.calculate();\n      if (this.result !== 'Ошибка') {\n        this.addToHistory(oldExpression, this.result);\n        this.lastResult = this.result;\n        this.expression = '';\n      }\n    },\n    // Добавить в историю\n    addToHistory(expression, result) {\n      this.history.push({\n        expression: expression,\n        result: result,\n        timestamp: new Date().toLocaleTimeString()\n      });\n\n      // Автоматически сохраняем после добавления в историю\n      if (this.isInitialized) {\n        this.saveState();\n      }\n    },\n    // Очистить все\n    clearAll() {\n      this.expression = '';\n      this.result = '0';\n      this.lastResult = null;\n    },\n    // Очистить последнюю запись\n    clearEntry() {\n      this.expression = '';\n      this.calculate();\n    },\n    // Удалить последний символ\n    backspace() {\n      if (this.expression) {\n        this.expression = this.expression.slice(0, -1);\n        this.calculate();\n      }\n    },\n    // Очистить историю\n    clearHistory() {\n      this.history = [];\n      if (this.isInitialized) {\n        this.saveState();\n      }\n    },\n    // Использовать результат из истории\n    useHistoryItem(item) {\n      this.expression = item.expression;\n      this.result = item.result;\n      this.lastResult = item.result;\n    },\n    // Обработка нажатия клавиш\n    handleKeyPress(event) {\n      const key = event.key;\n      if (/[0-9]/.test(key)) {\n        this.appendNumber(key);\n        event.preventDefault();\n      } else if (key === '+') {\n        this.appendOperation('+');\n        event.preventDefault();\n      } else if (key === '-') {\n        this.appendOperation('-');\n        event.preventDefault();\n      } else if (key === '*') {\n        this.appendOperation('×');\n        event.preventDefault();\n      } else if (key === '/') {\n        this.appendOperation('÷');\n        event.preventDefault();\n      } else if (key === '.' || key === ',') {\n        this.appendDecimal();\n        event.preventDefault();\n      } else if (key === 'Enter' || key === '=') {\n        this.calculateAndAddHistory();\n        event.preventDefault();\n      } else if (key === 'Escape') {\n        this.clearAll();\n        event.preventDefault();\n      } else if (key === 'Backspace') {\n        this.backspace();\n        event.preventDefault();\n      }\n    }\n  },\n  mounted() {\n    console.log('CalculatorApp mounted with windowId:', this.windowId);\n\n    // Добавляем поддержку клавиатуры\n    window.addEventListener('keydown', this.handleKeyPress);\n\n    // Инициализируем данные из store после монтирования\n    this.$nextTick(() => {\n      this.initFromStore();\n    });\n\n    // Сохраняем начальное состояние после небольшой задержки\n    setTimeout(() => {\n      if (!this.isInitialized) {\n        this.initFromStore();\n      }\n      this.saveState();\n    }, 100);\n  },\n  beforeUnmount() {\n    window.removeEventListener('keydown', this.handleKeyPress);\n\n    // Сохраняем состояние перед размонтированием\n    if (this.isInitialized) {\n      this.saveState();\n    }\n  }\n};","map":{"version":3,"names":["useOSIAppsStore","mapStores","name","props","windowId","type","String","required","data","expression","result","history","lastResult","isInitialized","computed","appsStore","osiAppsStore","reversedHistory","reverse","slice","watch","calculate","saveState","handler","deep","newActiveWindowId","console","log","checkAndReloadState","methods","savedState","getWindowState","appType","currentState","JSON","stringify","initFromStore","error","saveWindowState","state","timestamp","Date","now","appendNumber","number","includes","appendOperation","operation","lastChar","appendDecimal","split","pop","expr","replace","calcResult","eval","parseFloat","toFixed","calculateAndAddHistory","oldExpression","addToHistory","push","toLocaleTimeString","clearAll","clearEntry","backspace","clearHistory","useHistoryItem","item","handleKeyPress","event","key","test","preventDefault","mounted","window","addEventListener","$nextTick","setTimeout","beforeUnmount","removeEventListener"],"sources":["/home/kup/my_projects/vue/osi/src/apps/system/OSICalculator/OSICalculator.vue"],"sourcesContent":["<template src=\"./template.html\"></template>\n<style src=\"./style.css\"></style>\n<script>\n    import { useOSIAppsStore } from '@/stores/os.apps.store';\n    import { mapStores } from 'pinia';\n\n    export default {\n        name: 'OSICalculator',\n\n        props: {\n            windowId: {\n                type: String,\n                required: true\n            },\n        },\n  \n        data() {\n            // Инициализируем базовые значения, НЕ используем this.appsStore здесь\n            return {\n                expression: '',\n                result: '0',\n                history: [],\n                lastResult: null,\n                isInitialized: false // Флаг инициализации\n            }\n        },\n  \n        computed: {\n            ...mapStores(useOSIAppsStore),\n\n            appsStore() {\n                return this.osiAppsStore;\n            },\n\n            reversedHistory() {\n                return [...this.history].reverse().slice(0, 5);\n            }\n        },\n  \n        watch: {\n            // Отслеживаем изменения только после инициализации\n            expression() {\n                if (this.isInitialized) {\n                    this.calculate();\n                    this.saveState();\n                }\n            },\n            history: {\n                handler() { \n                    if (this.isInitialized) {\n                        this.saveState(); \n                    }\n                },\n                deep: true\n            },\n            result() {\n                if (this.isInitialized) {\n                    this.saveState();\n                }\n            },\n\n            // Следим за активным окном в store\n            'appsStore.activeWindowId': {\n                handler(newActiveWindowId) {\n                    // Если наше окно стало активным, проверяем состояние\n                    if (newActiveWindowId === this.windowId && this.isInitialized) {\n                        console.log('Calculator window activated, checking state...');\n                        this.checkAndReloadState();\n                    }\n                }\n            }\n        },\n\n        methods: {\n            // Проверить и перезагрузить состояние\n            checkAndReloadState() {\n                if (!this.windowId || !this.appsStore) return;\n                \n                const savedState = this.appsStore.getWindowState(this.windowId);\n                console.log('Checking state on activation:', savedState);\n                \n                // Если состояние в store отличается от текущего, загружаем его\n                if (savedState && savedState.appType === 'calculator') {\n                    // Сравниваем timestamp или другие метрики\n                    const currentState = {\n                        expression: this.expression,\n                        result: this.result,\n                        history: this.history,\n                        lastResult: this.lastResult\n                    };\n                    \n                    // Простая проверка - если история разная, загружаем\n                    if (JSON.stringify(savedState.history) !== JSON.stringify(this.history)) {\n                        console.log('State changed in store, reloading...');\n                        this.expression = savedState.expression || '';\n                        this.result = savedState.result || '0';\n                        this.history = savedState.history || [];\n                        this.lastResult = savedState.lastResult || null;\n                    }\n                }\n            },\n            \n            // Инициализация из store\n            initFromStore() {\n                console.log(\"initFromStore - windowId:\", this.windowId);\n                console.log(\"initFromStore - appsStore:\", this.appsStore);\n                \n                if (!this.windowId) {\n                    console.error('CalculatorApp: windowId is missing');\n                    return;\n                }\n                \n                if (!this.appsStore) {\n                    console.error('CalculatorApp: appsStore is not available');\n                    return;\n                }\n            \n                const savedState = this.appsStore.getWindowState(this.windowId);\n                console.log('CalculatorApp loaded state for window', this.windowId, ':', savedState);\n            \n                if (savedState && savedState.appType === 'calculator') {\n                    this.expression = savedState.expression || '';\n                    this.result = savedState.result || '0';\n                    this.history = savedState.history || [];\n                    this.lastResult = savedState.lastResult || null;\n                }\n                \n                this.isInitialized = true;\n                console.log('CalculatorApp initialized for window:', this.windowId);\n            },\n\n            // Сохраняем текущее состояние в store\n            saveState() {\n                if (!this.isInitialized) return;\n                \n                if (!this.windowId) {\n                    console.error('Cannot save: windowId is missing');\n                    return;\n                }\n                \n                if (!this.appsStore || typeof this.appsStore.saveWindowState !== 'function') {\n                    console.error('Cannot save: appsStore or saveWindowState is not available');\n                    return;\n                }\n                \n                const state = {\n                    appType: 'calculator',\n                    expression: this.expression,\n                    result: this.result,\n                    lastResult: this.lastResult,\n                    history: [...this.history],\n                    timestamp: Date.now()\n                };\n                \n                console.log('CalculatorApp saving state for window', this.windowId, ':', state);\n                this.appsStore.saveWindowState(this.windowId, state);\n            },\n\n            // Добавление цифры\n            appendNumber(number) {\n                if (this.lastResult !== null && !this.expression.includes('+') && \n                    !this.expression.includes('-') && !this.expression.includes('×') && \n                    !this.expression.includes('÷')) {\n                    this.expression = '';\n                    this.lastResult = null;\n                }\n      \n                this.expression += number;\n            },\n    \n            // Добавление операции\n            appendOperation(operation) {\n                if (!this.expression) {\n                    if (this.lastResult !== null) {\n                        this.expression = this.lastResult + operation;\n                    } else {\n                        return;\n                    }\n                } else {\n                    const lastChar = this.expression.slice(-1);\n                    if (['+', '-', '×', '÷'].includes(lastChar)) {\n                        this.expression = this.expression.slice(0, -1) + operation;\n                    } else {\n                        this.expression += operation;\n                    }\n                }\n      \n                this.lastResult = null;\n            },\n    \n            // Добавление десятичной точки\n            appendDecimal() {\n                if (!this.expression || ['+', '-', '×', '÷'].includes(this.expression.slice(-1))) {\n                    this.expression += '0.';\n                } else if (!this.expression.split(/[+\\-×÷]/).pop().includes('.')) {\n                    this.expression += '.';\n                }\n            },\n    \n            // Вычисление результата\n            calculate() {\n                if (!this.expression) {\n                    this.result = '0';\n                    return;\n                }\n      \n                try {\n                    let expr = this.expression.replace(/×/g, '*').replace(/÷/g, '/');\n                    let calcResult = eval(expr);\n        \n                    if (calcResult % 1 !== 0) {\n                        calcResult = parseFloat(calcResult.toFixed(10));\n                    }\n        \n                    this.result = calcResult;\n                } catch (error) {\n                    this.result = 'Ошибка';\n                }\n            },\n    \n            // Выполнить вычисление и добавить в историю\n            calculateAndAddHistory() {\n                if (!this.expression) return;\n      \n                const oldExpression = this.expression;\n                this.calculate();\n      \n                if (this.result !== 'Ошибка') {\n                    this.addToHistory(oldExpression, this.result);\n                    this.lastResult = this.result;\n                    this.expression = '';\n                }\n            },\n    \n            // Добавить в историю\n            addToHistory(expression, result) {\n                this.history.push({\n                    expression: expression,\n                    result: result,\n                    timestamp: new Date().toLocaleTimeString()\n                });\n                \n                // Автоматически сохраняем после добавления в историю\n                if (this.isInitialized) {\n                    this.saveState();\n                }\n            },\n    \n            // Очистить все\n            clearAll() {\n                this.expression = '';\n                this.result = '0';\n                this.lastResult = null;\n            },\n    \n            // Очистить последнюю запись\n            clearEntry() {\n                this.expression = '';\n                this.calculate();\n            },\n    \n            // Удалить последний символ\n            backspace() {\n                if (this.expression) {\n                    this.expression = this.expression.slice(0, -1);\n                    this.calculate();\n                }\n            },\n    \n            // Очистить историю\n            clearHistory() { \n                this.history = []; \n                if (this.isInitialized) {\n                    this.saveState();\n                }\n            },\n    \n            // Использовать результат из истории\n            useHistoryItem(item) {\n                this.expression = item.expression;\n                this.result = item.result;\n                this.lastResult = item.result;\n            },\n    \n            // Обработка нажатия клавиш\n            handleKeyPress(event) {\n                const key = event.key;\n      \n                if (/[0-9]/.test(key)) {\n                    this.appendNumber(key);\n                    event.preventDefault();\n                } else if (key === '+') {\n                    this.appendOperation('+');\n                    event.preventDefault();\n                } else if (key === '-') {\n                    this.appendOperation('-');\n                    event.preventDefault();\n                } else if (key === '*') {\n                    this.appendOperation('×');\n                    event.preventDefault();\n                } else if (key === '/') {\n                    this.appendOperation('÷');\n                    event.preventDefault();\n                } else if (key === '.' || key === ',') {\n                    this.appendDecimal();\n                    event.preventDefault();\n                } else if (key === 'Enter' || key === '=') {\n                    this.calculateAndAddHistory();\n                    event.preventDefault();\n                } else if (key === 'Escape') {\n                    this.clearAll();\n                    event.preventDefault();\n                } else if (key === 'Backspace') {\n                    this.backspace();\n                    event.preventDefault();\n                }\n            }\n        },\n  \n        mounted() {\n            console.log('CalculatorApp mounted with windowId:', this.windowId);\n    \n            // Добавляем поддержку клавиатуры\n            window.addEventListener('keydown', this.handleKeyPress);\n\n            // Инициализируем данные из store после монтирования\n            this.$nextTick(() => {\n                this.initFromStore();\n            });\n            \n            // Сохраняем начальное состояние после небольшой задержки\n            setTimeout(() => {\n                if (!this.isInitialized) {\n                    this.initFromStore();\n                }\n                this.saveState();\n            }, 100);\n        },\n  \n        beforeUnmount() {\n            window.removeEventListener('keydown', this.handleKeyPress);\n            \n            // Сохраняем состояние перед размонтированием\n            if (this.isInitialized) {\n                this.saveState();\n            }\n        }\n    }\n</script>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}