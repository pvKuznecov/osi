{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport * as Token from 'token-types';\nimport initDebug from 'debug';\nimport { FourCcToken } from '../common/FourCC.js';\nimport { makeUnexpectedFileContentError } from '../ParseError.js';\nimport * as util from '../common/Util.js';\nconst debug = initDebug('music-metadata:parser:MP4:atom');\nexport class Mp4ContentError extends makeUnexpectedFileContentError('MP4') {}\nexport const Header = {\n  len: 8,\n  get: (buf, off) => {\n    const length = Token.UINT32_BE.get(buf, off);\n    if (length < 0) throw new Mp4ContentError('Invalid atom header length');\n    return {\n      length: BigInt(length),\n      name: new Token.StringType(4, 'latin1').get(buf, off + 4)\n    };\n  },\n  put: (buf, off, hdr) => {\n    Token.UINT32_BE.put(buf, off, Number(hdr.length));\n    return FourCcToken.put(buf, off + 4, hdr.name);\n  }\n};\n/**\r\n * Ref: https://developer.apple.com/library/archive/documentation/QuickTime/QTFF/QTFFChap1/qtff1.html#//apple_ref/doc/uid/TP40000939-CH203-38190\r\n */\nexport const ExtendedSize = Token.UINT64_BE;\nexport const ftyp = {\n  len: 4,\n  get: (buf, off) => {\n    return {\n      type: new Token.StringType(4, 'ascii').get(buf, off)\n    };\n  }\n};\n/**\r\n * Token: Movie Header Atom\r\n */\nexport const mhdr = {\n  len: 8,\n  get: (buf, off) => {\n    return {\n      version: Token.UINT8.get(buf, off),\n      flags: Token.UINT24_BE.get(buf, off + 1),\n      nextItemID: Token.UINT32_BE.get(buf, off + 4)\n    };\n  }\n};\n/**\r\n * Base class for 'fixed' length atoms.\r\n * In some cases these atoms are longer then the sum of the described fields.\r\n * Issue: https://github.com/Borewit/music-metadata/issues/120\r\n */\nexport class FixedLengthAtom {\n  /**\r\n   *\r\n   * @param {number} len Length as specified in the size field\r\n   * @param {number} expLen Total length of sum of specified fields in the standard\r\n   * @param atomId Atom ID\r\n   */\n  constructor(len, expLen, atomId) {\n    if (len < expLen) {\n      throw new Mp4ContentError(`Atom ${atomId} expected to be ${expLen}, but specifies ${len} bytes long.`);\n    }\n    if (len > expLen) {\n      debug(`Warning: atom ${atomId} expected to be ${expLen}, but was actually ${len} bytes long.`);\n    }\n    this.len = len;\n  }\n}\n/**\r\n * Timestamp stored in seconds since Mac Epoch (1 January 1904)\r\n */\nconst SecondsSinceMacEpoch = {\n  len: 4,\n  get: (buf, off) => {\n    const secondsSinceUnixEpoch = Token.UINT32_BE.get(buf, off) - 2082844800;\n    return new Date(secondsSinceUnixEpoch * 1000);\n  }\n};\n/**\r\n * Token: Media Header Atom\r\n * Ref:\r\n * - https://developer.apple.com/library/archive/documentation/QuickTime/QTFF/QTFFChap2/qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-SW34\r\n * - https://wiki.multimedia.cx/index.php/QuickTime_container#mdhd\r\n */\nexport class MdhdAtom extends FixedLengthAtom {\n  constructor(len) {\n    super(len, 24, 'mdhd');\n  }\n  get(buf, off) {\n    return {\n      version: Token.UINT8.get(buf, off + 0),\n      flags: Token.UINT24_BE.get(buf, off + 1),\n      creationTime: SecondsSinceMacEpoch.get(buf, off + 4),\n      modificationTime: SecondsSinceMacEpoch.get(buf, off + 8),\n      timeScale: Token.UINT32_BE.get(buf, off + 12),\n      duration: Token.UINT32_BE.get(buf, off + 16),\n      language: Token.UINT16_BE.get(buf, off + 20),\n      quality: Token.UINT16_BE.get(buf, off + 22)\n    };\n  }\n}\n/**\r\n * Token: Movie Header Atom\r\n */\nexport class MvhdAtom extends FixedLengthAtom {\n  constructor(len) {\n    super(len, 100, 'mvhd');\n  }\n  get(buf, off) {\n    return {\n      version: Token.UINT8.get(buf, off),\n      flags: Token.UINT24_BE.get(buf, off + 1),\n      creationTime: SecondsSinceMacEpoch.get(buf, off + 4),\n      modificationTime: SecondsSinceMacEpoch.get(buf, off + 8),\n      timeScale: Token.UINT32_BE.get(buf, off + 12),\n      duration: Token.UINT32_BE.get(buf, off + 16),\n      preferredRate: Token.UINT32_BE.get(buf, off + 20),\n      preferredVolume: Token.UINT16_BE.get(buf, off + 24),\n      // ignore reserver: 10 bytes\n      // ignore matrix structure: 36 bytes\n      previewTime: Token.UINT32_BE.get(buf, off + 72),\n      previewDuration: Token.UINT32_BE.get(buf, off + 76),\n      posterTime: Token.UINT32_BE.get(buf, off + 80),\n      selectionTime: Token.UINT32_BE.get(buf, off + 84),\n      selectionDuration: Token.UINT32_BE.get(buf, off + 88),\n      currentTime: Token.UINT32_BE.get(buf, off + 92),\n      nextTrackID: Token.UINT32_BE.get(buf, off + 96)\n    };\n  }\n}\n/**\r\n * Data Atom Structure\r\n */\nexport class DataAtom {\n  constructor(len) {\n    this.len = len;\n  }\n  get(buf, off) {\n    return {\n      type: {\n        set: Token.UINT8.get(buf, off + 0),\n        type: Token.UINT24_BE.get(buf, off + 1)\n      },\n      locale: Token.UINT24_BE.get(buf, off + 4),\n      value: new Token.Uint8ArrayType(this.len - 8).get(buf, off + 8)\n    };\n  }\n}\n/**\r\n * Data Atom Structure\r\n * Ref: https://developer.apple.com/library/content/documentation/QuickTime/QTFF/Metadata/Metadata.html#//apple_ref/doc/uid/TP40000939-CH1-SW31\r\n */\nexport class NameAtom {\n  constructor(len) {\n    this.len = len;\n  }\n  get(buf, off) {\n    return {\n      version: Token.UINT8.get(buf, off),\n      flags: Token.UINT24_BE.get(buf, off + 1),\n      name: new Token.StringType(this.len - 4, 'utf-8').get(buf, off + 4)\n    };\n  }\n}\n/**\r\n * Track Header Atoms structure (`tkhd`)\r\n * Ref: https://developer.apple.com/library/content/documentation/QuickTime/QTFF/QTFFChap2/qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25550\r\n */\nexport class TrackHeaderAtom {\n  constructor(len) {\n    this.len = len;\n  }\n  get(buf, off) {\n    return {\n      version: Token.UINT8.get(buf, off),\n      flags: Token.UINT24_BE.get(buf, off + 1),\n      creationTime: SecondsSinceMacEpoch.get(buf, off + 4),\n      modificationTime: SecondsSinceMacEpoch.get(buf, off + 8),\n      trackId: Token.UINT32_BE.get(buf, off + 12),\n      // reserved 4 bytes\n      duration: Token.UINT32_BE.get(buf, off + 20),\n      layer: Token.UINT16_BE.get(buf, off + 24),\n      alternateGroup: Token.UINT16_BE.get(buf, off + 26),\n      volume: Token.UINT16_BE.get(buf, off + 28) // ToDo: fixed point\n      // ToDo: add remaining fields\n    };\n  }\n}\n/**\r\n * Atom: Sample Description Atom ('stsd')\r\n * Ref: https://developer.apple.com/library/archive/documentation/QuickTime/QTFF/QTFFChap2/qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25691\r\n */\nconst stsdHeader = {\n  len: 8,\n  get: (buf, off) => {\n    return {\n      version: Token.UINT8.get(buf, off),\n      flags: Token.UINT24_BE.get(buf, off + 1),\n      numberOfEntries: Token.UINT32_BE.get(buf, off + 4)\n    };\n  }\n};\n/**\r\n * Atom: Sample Description Atom ('stsd')\r\n * Ref: https://developer.apple.com/documentation/quicktime-file-format/sample_description_atom\r\n */\nclass SampleDescriptionTable {\n  constructor(len) {\n    this.len = len;\n  }\n  get(buf, off) {\n    const descrLen = this.len - 12;\n    return {\n      dataFormat: FourCcToken.get(buf, off),\n      dataReferenceIndex: Token.UINT16_BE.get(buf, off + 10),\n      description: descrLen > 0 ? new Token.Uint8ArrayType(descrLen).get(buf, off + 12) : undefined\n    };\n  }\n}\n/**\r\n * Atom: Sample-description Atom ('stsd')\r\n * Ref: https://developer.apple.com/library/archive/documentation/QuickTime/QTFF/QTFFChap2/qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25691\r\n */\nexport class StsdAtom {\n  constructor(len) {\n    this.len = len;\n  }\n  get(buf, off) {\n    const header = stsdHeader.get(buf, off);\n    off += stsdHeader.len;\n    const table = [];\n    for (let n = 0; n < header.numberOfEntries; ++n) {\n      const size = Token.UINT32_BE.get(buf, off); // Sample description size\n      off += Token.UINT32_BE.len;\n      table.push(new SampleDescriptionTable(size - Token.UINT32_BE.len).get(buf, off));\n      off += size;\n    }\n    return {\n      header,\n      table\n    };\n  }\n}\n/**\r\n * Common Sound Sample Description (version & revision)\r\n * Ref: https://developer.apple.com/library/archive/documentation/QuickTime/QTFF/QTFFChap3/qtff3.html#//apple_ref/doc/uid/TP40000939-CH205-57317\r\n */\nexport const SoundSampleDescriptionVersion = {\n  len: 8,\n  get(buf, off) {\n    return {\n      version: Token.INT16_BE.get(buf, off),\n      revision: Token.INT16_BE.get(buf, off + 2),\n      vendor: Token.INT32_BE.get(buf, off + 4)\n    };\n  }\n};\n/**\r\n * Sound Sample Description (Version 0)\r\n * Ref: https://developer.apple.com/library/archive/documentation/QuickTime/QTFF/QTFFChap3/qtff3.html#//apple_ref/doc/uid/TP40000939-CH205-130736\r\n */\nexport const SoundSampleDescriptionV0 = {\n  len: 12,\n  get(buf, off) {\n    return {\n      numAudioChannels: Token.INT16_BE.get(buf, off + 0),\n      sampleSize: Token.INT16_BE.get(buf, off + 2),\n      compressionId: Token.INT16_BE.get(buf, off + 4),\n      packetSize: Token.INT16_BE.get(buf, off + 6),\n      sampleRate: Token.UINT16_BE.get(buf, off + 8) + Token.UINT16_BE.get(buf, off + 10) / 10000\n    };\n  }\n};\nclass SimpleTableAtom {\n  constructor(len, token) {\n    this.len = len;\n    this.token = token;\n  }\n  get(buf, off) {\n    const nrOfEntries = Token.INT32_BE.get(buf, off + 4);\n    return {\n      version: Token.INT8.get(buf, off + 0),\n      flags: Token.INT24_BE.get(buf, off + 1),\n      numberOfEntries: nrOfEntries,\n      entries: readTokenTable(buf, this.token, off + 8, this.len - 8, nrOfEntries)\n    };\n  }\n}\nexport const TimeToSampleToken = {\n  len: 8,\n  get(buf, off) {\n    return {\n      count: Token.INT32_BE.get(buf, off + 0),\n      duration: Token.INT32_BE.get(buf, off + 4)\n    };\n  }\n};\n/**\r\n * Time-to-sample('stts') atom.\r\n * Store duration information for a media’s samples.\r\n * Ref: https://developer.apple.com/library/archive/documentation/QuickTime/QTFF/QTFFChap2/qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25696\r\n */\nexport class SttsAtom extends SimpleTableAtom {\n  constructor(len) {\n    super(len, TimeToSampleToken);\n  }\n}\nexport const SampleToChunkToken = {\n  len: 12,\n  get(buf, off) {\n    return {\n      firstChunk: Token.INT32_BE.get(buf, off),\n      samplesPerChunk: Token.INT32_BE.get(buf, off + 4),\n      sampleDescriptionId: Token.INT32_BE.get(buf, off + 8)\n    };\n  }\n};\n/**\r\n * Sample-to-Chunk ('stsc') atom interface\r\n * Ref: https://developer.apple.com/library/archive/documentation/QuickTime/QTFF/QTFFChap2/qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25706\r\n */\nexport class StscAtom extends SimpleTableAtom {\n  constructor(len) {\n    super(len, SampleToChunkToken);\n  }\n}\n/**\r\n * Sample-size ('stsz') atom\r\n * Ref: https://developer.apple.com/library/archive/documentation/QuickTime/QTFF/QTFFChap2/qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25710\r\n */\nexport class StszAtom {\n  constructor(len) {\n    this.len = len;\n  }\n  get(buf, off) {\n    const nrOfEntries = Token.INT32_BE.get(buf, off + 8);\n    return {\n      version: Token.INT8.get(buf, off),\n      flags: Token.INT24_BE.get(buf, off + 1),\n      sampleSize: Token.INT32_BE.get(buf, off + 4),\n      numberOfEntries: nrOfEntries,\n      entries: readTokenTable(buf, Token.INT32_BE, off + 12, this.len - 12, nrOfEntries)\n    };\n  }\n}\n/**\r\n * Chunk offset atom, 'stco'\r\n * Ref: https://developer.apple.com/library/archive/documentation/QuickTime/QTFF/QTFFChap2/qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25715\r\n */\nexport class StcoAtom extends SimpleTableAtom {\n  constructor(len) {\n    super(len, Token.INT32_BE);\n    this.len = len;\n  }\n}\n/**\r\n * Token used to decode text-track from 'mdat' atom (raw data stream)\r\n */\nexport class ChapterText {\n  constructor(len) {\n    this.len = len;\n  }\n  get(buf, off) {\n    const titleLen = Token.INT16_BE.get(buf, off + 0);\n    const str = new Token.StringType(titleLen, 'utf-8');\n    return str.get(buf, off + 2);\n  }\n}\nfunction readTokenTable(buf, token, off, remainingLen, numberOfEntries) {\n  debug(`remainingLen=${remainingLen}, numberOfEntries=${numberOfEntries} * token-len=${token.len}`);\n  if (remainingLen === 0) return [];\n  if (remainingLen !== numberOfEntries * token.len) throw new Mp4ContentError('mismatch number-of-entries with remaining atom-length');\n  const entries = [];\n  // parse offset-table\n  for (let n = 0; n < numberOfEntries; ++n) {\n    entries.push(token.get(buf, off));\n    off += token.len;\n  }\n  return entries;\n}\n/**\r\n * Sample-size ('tfhd') TrackFragmentHeaderBox\r\n */\nexport class TrackFragmentHeaderBox {\n  constructor(len) {\n    this.len = len;\n  }\n  get(buf, off) {\n    const flagOffset = off + 1;\n    const header = {\n      version: Token.INT8.get(buf, off),\n      flags: {\n        baseDataOffsetPresent: util.getBit(buf, flagOffset + 2, 0),\n        sampleDescriptionIndexPresent: util.getBit(buf, flagOffset + 2, 1),\n        defaultSampleDurationPresent: util.getBit(buf, flagOffset + 2, 3),\n        defaultSampleSizePresent: util.getBit(buf, flagOffset + 2, 4),\n        defaultSampleFlagsPresent: util.getBit(buf, flagOffset + 2, 5),\n        defaultDurationIsEmpty: util.getBit(buf, flagOffset, 0),\n        defaultBaseIsMoof: util.getBit(buf, flagOffset, 1)\n      },\n      trackId: Token.UINT32_BE.get(buf, 4)\n    };\n    let dynOffset = 8;\n    if (header.flags.baseDataOffsetPresent) {\n      header.baseDataOffset = Token.UINT64_BE.get(buf, dynOffset);\n      dynOffset += 8;\n    }\n    if (header.flags.sampleDescriptionIndexPresent) {\n      header.sampleDescriptionIndex = Token.UINT32_BE.get(buf, dynOffset);\n      dynOffset += 4;\n    }\n    if (header.flags.defaultSampleDurationPresent) {\n      header.defaultSampleDuration = Token.UINT32_BE.get(buf, dynOffset);\n      dynOffset += 4;\n    }\n    if (header.flags.defaultSampleSizePresent) {\n      header.defaultSampleSize = Token.UINT32_BE.get(buf, dynOffset);\n      dynOffset += 4;\n    }\n    if (header.flags.defaultSampleFlagsPresent) {\n      header.defaultSampleFlags = Token.UINT32_BE.get(buf, dynOffset);\n    }\n    return header;\n  }\n}\n/**\r\n * Sample-size ('trun') TrackRunBox\r\n */\nexport class TrackRunBox {\n  constructor(len) {\n    this.len = len;\n  }\n  get(buf, off) {\n    const flagOffset = off + 1;\n    const trun = {\n      version: Token.INT8.get(buf, off),\n      flags: {\n        dataOffsetPresent: util.getBit(buf, flagOffset + 2, 0),\n        firstSampleFlagsPresent: util.getBit(buf, flagOffset + 2, 2),\n        sampleDurationPresent: util.getBit(buf, flagOffset + 1, 0),\n        sampleSizePresent: util.getBit(buf, flagOffset + 1, 1),\n        sampleFlagsPresent: util.getBit(buf, flagOffset + 1, 2),\n        sampleCompositionTimeOffsetsPresent: util.getBit(buf, flagOffset + 1, 3)\n      },\n      sampleCount: Token.UINT32_BE.get(buf, off + 4),\n      samples: []\n    };\n    let dynOffset = off + 8;\n    if (trun.flags.dataOffsetPresent) {\n      trun.dataOffset = Token.UINT32_BE.get(buf, dynOffset);\n      dynOffset += 4;\n    }\n    if (trun.flags.firstSampleFlagsPresent) {\n      trun.firstSampleFlags = Token.UINT32_BE.get(buf, dynOffset);\n      dynOffset += 4;\n    }\n    for (let n = 0; n < trun.sampleCount; ++n) {\n      if (dynOffset >= this.len) {\n        debug(\"TrackRunBox size mismatch\");\n        break;\n      }\n      const sample = {};\n      if (trun.flags.sampleDurationPresent) {\n        sample.sampleDuration = Token.UINT32_BE.get(buf, dynOffset);\n        dynOffset += 4;\n      }\n      if (trun.flags.sampleSizePresent) {\n        sample.sampleSize = Token.UINT32_BE.get(buf, dynOffset);\n        dynOffset += 4;\n      }\n      if (trun.flags.sampleFlagsPresent) {\n        sample.sampleFlags = Token.UINT32_BE.get(buf, dynOffset);\n        dynOffset += 4;\n      }\n      if (trun.flags.sampleCompositionTimeOffsetsPresent) {\n        sample.sampleCompositionTimeOffset = Token.UINT32_BE.get(buf, dynOffset);\n        dynOffset += 4;\n      }\n      trun.samples.push(sample);\n    }\n    return trun;\n  }\n}\n/**\r\n * HandlerBox (`hdlr`)\r\n */\nexport class HandlerBox {\n  constructor(len) {\n    this.len = len;\n  }\n  get(buf, off) {\n    const _flagOffset = off + 1;\n    const charTypeToken = new Token.StringType(4, 'utf-8');\n    return {\n      version: Token.INT8.get(buf, off),\n      flags: Token.UINT24_BE.get(buf, off + 1),\n      componentType: charTypeToken.get(buf, off + 4),\n      handlerType: charTypeToken.get(buf, off + 8),\n      componentName: new Token.StringType(this.len - 28, 'utf-8').get(buf, off + 28)\n    };\n  }\n}\n/**\r\n * Chapter Track Reference Box (`chap`)\r\n */\nexport class ChapterTrackReferenceBox {\n  constructor(len) {\n    this.len = len;\n  }\n  get(buf, off) {\n    let dynOffset = 0;\n    const trackIds = [];\n    while (dynOffset < this.len) {\n      trackIds.push(Token.UINT32_BE.get(buf, off + dynOffset));\n      dynOffset += 4;\n    }\n    return trackIds;\n  }\n}","map":{"version":3,"names":["Token","initDebug","FourCcToken","makeUnexpectedFileContentError","util","debug","Mp4ContentError","Header","len","get","buf","off","length","UINT32_BE","BigInt","name","StringType","put","hdr","Number","ExtendedSize","UINT64_BE","ftyp","type","mhdr","version","UINT8","flags","UINT24_BE","nextItemID","FixedLengthAtom","constructor","expLen","atomId","SecondsSinceMacEpoch","secondsSinceUnixEpoch","Date","MdhdAtom","creationTime","modificationTime","timeScale","duration","language","UINT16_BE","quality","MvhdAtom","preferredRate","preferredVolume","previewTime","previewDuration","posterTime","selectionTime","selectionDuration","currentTime","nextTrackID","DataAtom","set","locale","value","Uint8ArrayType","NameAtom","TrackHeaderAtom","trackId","layer","alternateGroup","volume","stsdHeader","numberOfEntries","SampleDescriptionTable","descrLen","dataFormat","dataReferenceIndex","description","undefined","StsdAtom","header","table","n","size","push","SoundSampleDescriptionVersion","INT16_BE","revision","vendor","INT32_BE","SoundSampleDescriptionV0","numAudioChannels","sampleSize","compressionId","packetSize","sampleRate","SimpleTableAtom","token","nrOfEntries","INT8","INT24_BE","entries","readTokenTable","TimeToSampleToken","count","SttsAtom","SampleToChunkToken","firstChunk","samplesPerChunk","sampleDescriptionId","StscAtom","StszAtom","StcoAtom","ChapterText","titleLen","str","remainingLen","TrackFragmentHeaderBox","flagOffset","baseDataOffsetPresent","getBit","sampleDescriptionIndexPresent","defaultSampleDurationPresent","defaultSampleSizePresent","defaultSampleFlagsPresent","defaultDurationIsEmpty","defaultBaseIsMoof","dynOffset","baseDataOffset","sampleDescriptionIndex","defaultSampleDuration","defaultSampleSize","defaultSampleFlags","TrackRunBox","trun","dataOffsetPresent","firstSampleFlagsPresent","sampleDurationPresent","sampleSizePresent","sampleFlagsPresent","sampleCompositionTimeOffsetsPresent","sampleCount","samples","dataOffset","firstSampleFlags","sample","sampleDuration","sampleFlags","sampleCompositionTimeOffset","HandlerBox","_flagOffset","charTypeToken","componentType","handlerType","componentName","ChapterTrackReferenceBox","trackIds"],"sources":["C:/projects/My projects/Vue/osi/node_modules/music-metadata/lib/mp4/AtomToken.js"],"sourcesContent":["import * as Token from 'token-types';\r\nimport initDebug from 'debug';\r\nimport { FourCcToken } from '../common/FourCC.js';\r\nimport { makeUnexpectedFileContentError } from '../ParseError.js';\r\nimport * as util from '../common/Util.js';\r\nconst debug = initDebug('music-metadata:parser:MP4:atom');\r\nexport class Mp4ContentError extends makeUnexpectedFileContentError('MP4') {\r\n}\r\nexport const Header = {\r\n    len: 8,\r\n    get: (buf, off) => {\r\n        const length = Token.UINT32_BE.get(buf, off);\r\n        if (length < 0)\r\n            throw new Mp4ContentError('Invalid atom header length');\r\n        return {\r\n            length: BigInt(length),\r\n            name: new Token.StringType(4, 'latin1').get(buf, off + 4)\r\n        };\r\n    },\r\n    put: (buf, off, hdr) => {\r\n        Token.UINT32_BE.put(buf, off, Number(hdr.length));\r\n        return FourCcToken.put(buf, off + 4, hdr.name);\r\n    }\r\n};\r\n/**\r\n * Ref: https://developer.apple.com/library/archive/documentation/QuickTime/QTFF/QTFFChap1/qtff1.html#//apple_ref/doc/uid/TP40000939-CH203-38190\r\n */\r\nexport const ExtendedSize = Token.UINT64_BE;\r\nexport const ftyp = {\r\n    len: 4,\r\n    get: (buf, off) => {\r\n        return {\r\n            type: new Token.StringType(4, 'ascii').get(buf, off)\r\n        };\r\n    }\r\n};\r\n/**\r\n * Token: Movie Header Atom\r\n */\r\nexport const mhdr = {\r\n    len: 8,\r\n    get: (buf, off) => {\r\n        return {\r\n            version: Token.UINT8.get(buf, off),\r\n            flags: Token.UINT24_BE.get(buf, off + 1),\r\n            nextItemID: Token.UINT32_BE.get(buf, off + 4)\r\n        };\r\n    }\r\n};\r\n/**\r\n * Base class for 'fixed' length atoms.\r\n * In some cases these atoms are longer then the sum of the described fields.\r\n * Issue: https://github.com/Borewit/music-metadata/issues/120\r\n */\r\nexport class FixedLengthAtom {\r\n    /**\r\n     *\r\n     * @param {number} len Length as specified in the size field\r\n     * @param {number} expLen Total length of sum of specified fields in the standard\r\n     * @param atomId Atom ID\r\n     */\r\n    constructor(len, expLen, atomId) {\r\n        if (len < expLen) {\r\n            throw new Mp4ContentError(`Atom ${atomId} expected to be ${expLen}, but specifies ${len} bytes long.`);\r\n        }\r\n        if (len > expLen) {\r\n            debug(`Warning: atom ${atomId} expected to be ${expLen}, but was actually ${len} bytes long.`);\r\n        }\r\n        this.len = len;\r\n    }\r\n}\r\n/**\r\n * Timestamp stored in seconds since Mac Epoch (1 January 1904)\r\n */\r\nconst SecondsSinceMacEpoch = {\r\n    len: 4,\r\n    get: (buf, off) => {\r\n        const secondsSinceUnixEpoch = Token.UINT32_BE.get(buf, off) - 2082844800;\r\n        return new Date(secondsSinceUnixEpoch * 1000);\r\n    }\r\n};\r\n/**\r\n * Token: Media Header Atom\r\n * Ref:\r\n * - https://developer.apple.com/library/archive/documentation/QuickTime/QTFF/QTFFChap2/qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-SW34\r\n * - https://wiki.multimedia.cx/index.php/QuickTime_container#mdhd\r\n */\r\nexport class MdhdAtom extends FixedLengthAtom {\r\n    constructor(len) {\r\n        super(len, 24, 'mdhd');\r\n    }\r\n    get(buf, off) {\r\n        return {\r\n            version: Token.UINT8.get(buf, off + 0),\r\n            flags: Token.UINT24_BE.get(buf, off + 1),\r\n            creationTime: SecondsSinceMacEpoch.get(buf, off + 4),\r\n            modificationTime: SecondsSinceMacEpoch.get(buf, off + 8),\r\n            timeScale: Token.UINT32_BE.get(buf, off + 12),\r\n            duration: Token.UINT32_BE.get(buf, off + 16),\r\n            language: Token.UINT16_BE.get(buf, off + 20),\r\n            quality: Token.UINT16_BE.get(buf, off + 22)\r\n        };\r\n    }\r\n}\r\n/**\r\n * Token: Movie Header Atom\r\n */\r\nexport class MvhdAtom extends FixedLengthAtom {\r\n    constructor(len) {\r\n        super(len, 100, 'mvhd');\r\n    }\r\n    get(buf, off) {\r\n        return {\r\n            version: Token.UINT8.get(buf, off),\r\n            flags: Token.UINT24_BE.get(buf, off + 1),\r\n            creationTime: SecondsSinceMacEpoch.get(buf, off + 4),\r\n            modificationTime: SecondsSinceMacEpoch.get(buf, off + 8),\r\n            timeScale: Token.UINT32_BE.get(buf, off + 12),\r\n            duration: Token.UINT32_BE.get(buf, off + 16),\r\n            preferredRate: Token.UINT32_BE.get(buf, off + 20),\r\n            preferredVolume: Token.UINT16_BE.get(buf, off + 24),\r\n            // ignore reserver: 10 bytes\r\n            // ignore matrix structure: 36 bytes\r\n            previewTime: Token.UINT32_BE.get(buf, off + 72),\r\n            previewDuration: Token.UINT32_BE.get(buf, off + 76),\r\n            posterTime: Token.UINT32_BE.get(buf, off + 80),\r\n            selectionTime: Token.UINT32_BE.get(buf, off + 84),\r\n            selectionDuration: Token.UINT32_BE.get(buf, off + 88),\r\n            currentTime: Token.UINT32_BE.get(buf, off + 92),\r\n            nextTrackID: Token.UINT32_BE.get(buf, off + 96)\r\n        };\r\n    }\r\n}\r\n/**\r\n * Data Atom Structure\r\n */\r\nexport class DataAtom {\r\n    constructor(len) {\r\n        this.len = len;\r\n    }\r\n    get(buf, off) {\r\n        return {\r\n            type: {\r\n                set: Token.UINT8.get(buf, off + 0),\r\n                type: Token.UINT24_BE.get(buf, off + 1)\r\n            },\r\n            locale: Token.UINT24_BE.get(buf, off + 4),\r\n            value: new Token.Uint8ArrayType(this.len - 8).get(buf, off + 8)\r\n        };\r\n    }\r\n}\r\n/**\r\n * Data Atom Structure\r\n * Ref: https://developer.apple.com/library/content/documentation/QuickTime/QTFF/Metadata/Metadata.html#//apple_ref/doc/uid/TP40000939-CH1-SW31\r\n */\r\nexport class NameAtom {\r\n    constructor(len) {\r\n        this.len = len;\r\n    }\r\n    get(buf, off) {\r\n        return {\r\n            version: Token.UINT8.get(buf, off),\r\n            flags: Token.UINT24_BE.get(buf, off + 1),\r\n            name: new Token.StringType(this.len - 4, 'utf-8').get(buf, off + 4)\r\n        };\r\n    }\r\n}\r\n/**\r\n * Track Header Atoms structure (`tkhd`)\r\n * Ref: https://developer.apple.com/library/content/documentation/QuickTime/QTFF/QTFFChap2/qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25550\r\n */\r\nexport class TrackHeaderAtom {\r\n    constructor(len) {\r\n        this.len = len;\r\n    }\r\n    get(buf, off) {\r\n        return {\r\n            version: Token.UINT8.get(buf, off),\r\n            flags: Token.UINT24_BE.get(buf, off + 1),\r\n            creationTime: SecondsSinceMacEpoch.get(buf, off + 4),\r\n            modificationTime: SecondsSinceMacEpoch.get(buf, off + 8),\r\n            trackId: Token.UINT32_BE.get(buf, off + 12),\r\n            // reserved 4 bytes\r\n            duration: Token.UINT32_BE.get(buf, off + 20),\r\n            layer: Token.UINT16_BE.get(buf, off + 24),\r\n            alternateGroup: Token.UINT16_BE.get(buf, off + 26),\r\n            volume: Token.UINT16_BE.get(buf, off + 28) // ToDo: fixed point\r\n            // ToDo: add remaining fields\r\n        };\r\n    }\r\n}\r\n/**\r\n * Atom: Sample Description Atom ('stsd')\r\n * Ref: https://developer.apple.com/library/archive/documentation/QuickTime/QTFF/QTFFChap2/qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25691\r\n */\r\nconst stsdHeader = {\r\n    len: 8,\r\n    get: (buf, off) => {\r\n        return {\r\n            version: Token.UINT8.get(buf, off),\r\n            flags: Token.UINT24_BE.get(buf, off + 1),\r\n            numberOfEntries: Token.UINT32_BE.get(buf, off + 4)\r\n        };\r\n    }\r\n};\r\n/**\r\n * Atom: Sample Description Atom ('stsd')\r\n * Ref: https://developer.apple.com/documentation/quicktime-file-format/sample_description_atom\r\n */\r\nclass SampleDescriptionTable {\r\n    constructor(len) {\r\n        this.len = len;\r\n    }\r\n    get(buf, off) {\r\n        const descrLen = this.len - 12;\r\n        return {\r\n            dataFormat: FourCcToken.get(buf, off),\r\n            dataReferenceIndex: Token.UINT16_BE.get(buf, off + 10),\r\n            description: descrLen > 0 ? new Token.Uint8ArrayType(descrLen).get(buf, off + 12) : undefined\r\n        };\r\n    }\r\n}\r\n/**\r\n * Atom: Sample-description Atom ('stsd')\r\n * Ref: https://developer.apple.com/library/archive/documentation/QuickTime/QTFF/QTFFChap2/qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25691\r\n */\r\nexport class StsdAtom {\r\n    constructor(len) {\r\n        this.len = len;\r\n    }\r\n    get(buf, off) {\r\n        const header = stsdHeader.get(buf, off);\r\n        off += stsdHeader.len;\r\n        const table = [];\r\n        for (let n = 0; n < header.numberOfEntries; ++n) {\r\n            const size = Token.UINT32_BE.get(buf, off); // Sample description size\r\n            off += Token.UINT32_BE.len;\r\n            table.push(new SampleDescriptionTable(size - Token.UINT32_BE.len).get(buf, off));\r\n            off += size;\r\n        }\r\n        return {\r\n            header,\r\n            table\r\n        };\r\n    }\r\n}\r\n/**\r\n * Common Sound Sample Description (version & revision)\r\n * Ref: https://developer.apple.com/library/archive/documentation/QuickTime/QTFF/QTFFChap3/qtff3.html#//apple_ref/doc/uid/TP40000939-CH205-57317\r\n */\r\nexport const SoundSampleDescriptionVersion = {\r\n    len: 8,\r\n    get(buf, off) {\r\n        return {\r\n            version: Token.INT16_BE.get(buf, off),\r\n            revision: Token.INT16_BE.get(buf, off + 2),\r\n            vendor: Token.INT32_BE.get(buf, off + 4)\r\n        };\r\n    }\r\n};\r\n/**\r\n * Sound Sample Description (Version 0)\r\n * Ref: https://developer.apple.com/library/archive/documentation/QuickTime/QTFF/QTFFChap3/qtff3.html#//apple_ref/doc/uid/TP40000939-CH205-130736\r\n */\r\nexport const SoundSampleDescriptionV0 = {\r\n    len: 12,\r\n    get(buf, off) {\r\n        return {\r\n            numAudioChannels: Token.INT16_BE.get(buf, off + 0),\r\n            sampleSize: Token.INT16_BE.get(buf, off + 2),\r\n            compressionId: Token.INT16_BE.get(buf, off + 4),\r\n            packetSize: Token.INT16_BE.get(buf, off + 6),\r\n            sampleRate: Token.UINT16_BE.get(buf, off + 8) + Token.UINT16_BE.get(buf, off + 10) / 10000\r\n        };\r\n    }\r\n};\r\nclass SimpleTableAtom {\r\n    constructor(len, token) {\r\n        this.len = len;\r\n        this.token = token;\r\n    }\r\n    get(buf, off) {\r\n        const nrOfEntries = Token.INT32_BE.get(buf, off + 4);\r\n        return {\r\n            version: Token.INT8.get(buf, off + 0),\r\n            flags: Token.INT24_BE.get(buf, off + 1),\r\n            numberOfEntries: nrOfEntries,\r\n            entries: readTokenTable(buf, this.token, off + 8, this.len - 8, nrOfEntries)\r\n        };\r\n    }\r\n}\r\nexport const TimeToSampleToken = {\r\n    len: 8,\r\n    get(buf, off) {\r\n        return {\r\n            count: Token.INT32_BE.get(buf, off + 0),\r\n            duration: Token.INT32_BE.get(buf, off + 4)\r\n        };\r\n    }\r\n};\r\n/**\r\n * Time-to-sample('stts') atom.\r\n * Store duration information for a media’s samples.\r\n * Ref: https://developer.apple.com/library/archive/documentation/QuickTime/QTFF/QTFFChap2/qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25696\r\n */\r\nexport class SttsAtom extends SimpleTableAtom {\r\n    constructor(len) {\r\n        super(len, TimeToSampleToken);\r\n    }\r\n}\r\nexport const SampleToChunkToken = {\r\n    len: 12,\r\n    get(buf, off) {\r\n        return {\r\n            firstChunk: Token.INT32_BE.get(buf, off),\r\n            samplesPerChunk: Token.INT32_BE.get(buf, off + 4),\r\n            sampleDescriptionId: Token.INT32_BE.get(buf, off + 8)\r\n        };\r\n    }\r\n};\r\n/**\r\n * Sample-to-Chunk ('stsc') atom interface\r\n * Ref: https://developer.apple.com/library/archive/documentation/QuickTime/QTFF/QTFFChap2/qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25706\r\n */\r\nexport class StscAtom extends SimpleTableAtom {\r\n    constructor(len) {\r\n        super(len, SampleToChunkToken);\r\n    }\r\n}\r\n/**\r\n * Sample-size ('stsz') atom\r\n * Ref: https://developer.apple.com/library/archive/documentation/QuickTime/QTFF/QTFFChap2/qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25710\r\n */\r\nexport class StszAtom {\r\n    constructor(len) {\r\n        this.len = len;\r\n    }\r\n    get(buf, off) {\r\n        const nrOfEntries = Token.INT32_BE.get(buf, off + 8);\r\n        return {\r\n            version: Token.INT8.get(buf, off),\r\n            flags: Token.INT24_BE.get(buf, off + 1),\r\n            sampleSize: Token.INT32_BE.get(buf, off + 4),\r\n            numberOfEntries: nrOfEntries,\r\n            entries: readTokenTable(buf, Token.INT32_BE, off + 12, this.len - 12, nrOfEntries)\r\n        };\r\n    }\r\n}\r\n/**\r\n * Chunk offset atom, 'stco'\r\n * Ref: https://developer.apple.com/library/archive/documentation/QuickTime/QTFF/QTFFChap2/qtff2.html#//apple_ref/doc/uid/TP40000939-CH204-25715\r\n */\r\nexport class StcoAtom extends SimpleTableAtom {\r\n    constructor(len) {\r\n        super(len, Token.INT32_BE);\r\n        this.len = len;\r\n    }\r\n}\r\n/**\r\n * Token used to decode text-track from 'mdat' atom (raw data stream)\r\n */\r\nexport class ChapterText {\r\n    constructor(len) {\r\n        this.len = len;\r\n    }\r\n    get(buf, off) {\r\n        const titleLen = Token.INT16_BE.get(buf, off + 0);\r\n        const str = new Token.StringType(titleLen, 'utf-8');\r\n        return str.get(buf, off + 2);\r\n    }\r\n}\r\nfunction readTokenTable(buf, token, off, remainingLen, numberOfEntries) {\r\n    debug(`remainingLen=${remainingLen}, numberOfEntries=${numberOfEntries} * token-len=${token.len}`);\r\n    if (remainingLen === 0)\r\n        return [];\r\n    if (remainingLen !== numberOfEntries * token.len)\r\n        throw new Mp4ContentError('mismatch number-of-entries with remaining atom-length');\r\n    const entries = [];\r\n    // parse offset-table\r\n    for (let n = 0; n < numberOfEntries; ++n) {\r\n        entries.push(token.get(buf, off));\r\n        off += token.len;\r\n    }\r\n    return entries;\r\n}\r\n/**\r\n * Sample-size ('tfhd') TrackFragmentHeaderBox\r\n */\r\nexport class TrackFragmentHeaderBox {\r\n    constructor(len) {\r\n        this.len = len;\r\n    }\r\n    get(buf, off) {\r\n        const flagOffset = off + 1;\r\n        const header = {\r\n            version: Token.INT8.get(buf, off),\r\n            flags: {\r\n                baseDataOffsetPresent: util.getBit(buf, flagOffset + 2, 0),\r\n                sampleDescriptionIndexPresent: util.getBit(buf, flagOffset + 2, 1),\r\n                defaultSampleDurationPresent: util.getBit(buf, flagOffset + 2, 3),\r\n                defaultSampleSizePresent: util.getBit(buf, flagOffset + 2, 4),\r\n                defaultSampleFlagsPresent: util.getBit(buf, flagOffset + 2, 5),\r\n                defaultDurationIsEmpty: util.getBit(buf, flagOffset, 0),\r\n                defaultBaseIsMoof: util.getBit(buf, flagOffset, 1)\r\n            },\r\n            trackId: Token.UINT32_BE.get(buf, 4)\r\n        };\r\n        let dynOffset = 8;\r\n        if (header.flags.baseDataOffsetPresent) {\r\n            header.baseDataOffset = Token.UINT64_BE.get(buf, dynOffset);\r\n            dynOffset += 8;\r\n        }\r\n        if (header.flags.sampleDescriptionIndexPresent) {\r\n            header.sampleDescriptionIndex = Token.UINT32_BE.get(buf, dynOffset);\r\n            dynOffset += 4;\r\n        }\r\n        if (header.flags.defaultSampleDurationPresent) {\r\n            header.defaultSampleDuration = Token.UINT32_BE.get(buf, dynOffset);\r\n            dynOffset += 4;\r\n        }\r\n        if (header.flags.defaultSampleSizePresent) {\r\n            header.defaultSampleSize = Token.UINT32_BE.get(buf, dynOffset);\r\n            dynOffset += 4;\r\n        }\r\n        if (header.flags.defaultSampleFlagsPresent) {\r\n            header.defaultSampleFlags = Token.UINT32_BE.get(buf, dynOffset);\r\n        }\r\n        return header;\r\n    }\r\n}\r\n/**\r\n * Sample-size ('trun') TrackRunBox\r\n */\r\nexport class TrackRunBox {\r\n    constructor(len) {\r\n        this.len = len;\r\n    }\r\n    get(buf, off) {\r\n        const flagOffset = off + 1;\r\n        const trun = {\r\n            version: Token.INT8.get(buf, off),\r\n            flags: {\r\n                dataOffsetPresent: util.getBit(buf, flagOffset + 2, 0),\r\n                firstSampleFlagsPresent: util.getBit(buf, flagOffset + 2, 2),\r\n                sampleDurationPresent: util.getBit(buf, flagOffset + 1, 0),\r\n                sampleSizePresent: util.getBit(buf, flagOffset + 1, 1),\r\n                sampleFlagsPresent: util.getBit(buf, flagOffset + 1, 2),\r\n                sampleCompositionTimeOffsetsPresent: util.getBit(buf, flagOffset + 1, 3)\r\n            },\r\n            sampleCount: Token.UINT32_BE.get(buf, off + 4),\r\n            samples: []\r\n        };\r\n        let dynOffset = off + 8;\r\n        if (trun.flags.dataOffsetPresent) {\r\n            trun.dataOffset = Token.UINT32_BE.get(buf, dynOffset);\r\n            dynOffset += 4;\r\n        }\r\n        if (trun.flags.firstSampleFlagsPresent) {\r\n            trun.firstSampleFlags = Token.UINT32_BE.get(buf, dynOffset);\r\n            dynOffset += 4;\r\n        }\r\n        for (let n = 0; n < trun.sampleCount; ++n) {\r\n            if (dynOffset >= this.len) {\r\n                debug(\"TrackRunBox size mismatch\");\r\n                break;\r\n            }\r\n            const sample = {};\r\n            if (trun.flags.sampleDurationPresent) {\r\n                sample.sampleDuration = Token.UINT32_BE.get(buf, dynOffset);\r\n                dynOffset += 4;\r\n            }\r\n            if (trun.flags.sampleSizePresent) {\r\n                sample.sampleSize = Token.UINT32_BE.get(buf, dynOffset);\r\n                dynOffset += 4;\r\n            }\r\n            if (trun.flags.sampleFlagsPresent) {\r\n                sample.sampleFlags = Token.UINT32_BE.get(buf, dynOffset);\r\n                dynOffset += 4;\r\n            }\r\n            if (trun.flags.sampleCompositionTimeOffsetsPresent) {\r\n                sample.sampleCompositionTimeOffset = Token.UINT32_BE.get(buf, dynOffset);\r\n                dynOffset += 4;\r\n            }\r\n            trun.samples.push(sample);\r\n        }\r\n        return trun;\r\n    }\r\n}\r\n/**\r\n * HandlerBox (`hdlr`)\r\n */\r\nexport class HandlerBox {\r\n    constructor(len) {\r\n        this.len = len;\r\n    }\r\n    get(buf, off) {\r\n        const _flagOffset = off + 1;\r\n        const charTypeToken = new Token.StringType(4, 'utf-8');\r\n        return {\r\n            version: Token.INT8.get(buf, off),\r\n            flags: Token.UINT24_BE.get(buf, off + 1),\r\n            componentType: charTypeToken.get(buf, off + 4),\r\n            handlerType: charTypeToken.get(buf, off + 8),\r\n            componentName: new Token.StringType(this.len - 28, 'utf-8').get(buf, off + 28),\r\n        };\r\n    }\r\n}\r\n/**\r\n * Chapter Track Reference Box (`chap`)\r\n */\r\nexport class ChapterTrackReferenceBox {\r\n    constructor(len) {\r\n        this.len = len;\r\n    }\r\n    get(buf, off) {\r\n        let dynOffset = 0;\r\n        const trackIds = [];\r\n        while (dynOffset < this.len) {\r\n            trackIds.push(Token.UINT32_BE.get(buf, off + dynOffset));\r\n            dynOffset += 4;\r\n        }\r\n        return trackIds;\r\n    }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}