{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport { defineStore } from 'pinia';\nimport { ref } from 'vue';\nexport const useOsStore = defineStore('os', () => {\n  const windows = ref([]);\n  const activeWindowId = ref(null);\n  let nextZIndex = 100;\n  const activateWindow = windowId => {\n    const window = windows.value.find(w => w.id === windowId);\n    if (window) {\n      activeWindowId.value = windowId;\n      windows.value.forEach(w => {\n        if (w.id === windowId) {\n          w.zIndex = nextZIndex++;\n        }\n      });\n    }\n  };\n  const openWindow = appData => {\n    const appName = appData.name;\n\n    // Проверяем, есть ли уже открытое окно с этим приложением\n    const existingWindow = windows.value.find(w => w.appName === appName && w.contentApp === appData.contentapp && !w.isMinimized);\n    if (existingWindow) {\n      activateWindow(existingWindow.id);\n      return existingWindow.id;\n    }\n\n    // Проверяем, есть ли свёрнутое окно с этим приложением\n    const existingMinimizedWindow = windows.value.find(w => w.appName === appName && w.contentApp === appData.contentapp && w.isMinimized);\n    if (existingMinimizedWindow) {\n      restoreWindow(existingMinimizedWindow.id);\n      return existingMinimizedWindow.id;\n    }\n\n    // Создаём новое окно с возможным начальным состоянием\n    const newWindow = {\n      ...appData,\n      id: 'window_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),\n      appName: appName,\n      contentApp: appData.contentapp,\n      title: appData.label || appData.name,\n      isMinimized: appData.isMinimized || false,\n      isMaximized: appData.isMaximized || false,\n      zIndex: nextZIndex++,\n      state: appData.state || {},\n      // Сохраняем начальное состояние\n      initialState: appData.state || {} // Дублируем для передачи в компонент\n    };\n    windows.value.push(newWindow);\n    activateWindow(newWindow.id);\n    return newWindow.id;\n  };\n  const closeWindow = windowId => {\n    const index = windows.value.findIndex(w => w.id === windowId);\n    if (index !== -1) {\n      windows.value.splice(index, 1);\n    }\n  };\n  const minimizeWindow = windowId => {\n    const window = windows.value.find(w => w.id === windowId);\n    if (window) {\n      window.isMinimized = true;\n    }\n  };\n  const restoreWindow = windowId => {\n    const window = windows.value.find(w => w.id === windowId);\n    if (window) {\n      window.isMinimized = false;\n      activateWindow(windowId);\n    }\n  };\n  const toggleMaximizeWindow = windowId => {\n    const window = windows.value.find(w => w.id === windowId);\n    if (window) {\n      window.isMaximized = !window.isMaximized;\n      activateWindow(windowId);\n    }\n  };\n\n  // Новый метод для обновления состояния окна\n  const updateWindowState = (windowId, state) => {\n    const window = windows.value.find(w => w.id === windowId);\n    if (window) {\n      window.state = {\n        ...window.state,\n        ...state\n      };\n    }\n  };\n\n  // Получение состояния окна\n  const getWindowState = windowId => {\n    const window = windows.value.find(w => w.id === windowId);\n    return window ? window.state : null;\n  };\n  return {\n    windows,\n    activeWindowId,\n    openWindow,\n    closeWindow,\n    minimizeWindow,\n    restoreWindow,\n    toggleMaximizeWindow,\n    activateWindow,\n    updateWindowState,\n    // Добавляем экспорт\n    getWindowState // Добавляем экспорт\n  };\n});","map":{"version":3,"names":["defineStore","ref","useOsStore","windows","activeWindowId","nextZIndex","activateWindow","windowId","window","value","find","w","id","forEach","zIndex","openWindow","appData","appName","name","existingWindow","contentApp","contentapp","isMinimized","existingMinimizedWindow","restoreWindow","newWindow","Date","now","Math","random","toString","substr","title","label","isMaximized","state","initialState","push","closeWindow","index","findIndex","splice","minimizeWindow","toggleMaximizeWindow","updateWindowState","getWindowState"],"sources":["/home/kup/my_projects/vue/osi/src/stores/os.store.js"],"sourcesContent":["import { defineStore } from 'pinia'\nimport { ref } from 'vue'\n\nexport const useOsStore = defineStore('os', () => {\n    const windows = ref([]);\n    const activeWindowId = ref(null);\n    \n    let nextZIndex = 100;\n  \n    const activateWindow = (windowId) => {\n        const window = windows.value.find(w => w.id === windowId);\n        \n        if (window) {\n            activeWindowId.value = windowId;\n            windows.value.forEach(w => {\n                if (w.id === windowId) {\n                    w.zIndex = nextZIndex++;\n                }\n            });\n        }\n    };\n  \n    const openWindow = (appData) => {\n        const appName = appData.name;\n        \n        // Проверяем, есть ли уже открытое окно с этим приложением\n        const existingWindow = windows.value.find(w => \n            w.appName === appName && \n            w.contentApp === appData.contentapp &&\n            !w.isMinimized\n        );\n        \n        if (existingWindow) {\n            activateWindow(existingWindow.id);\n            return existingWindow.id;\n        }\n        \n        // Проверяем, есть ли свёрнутое окно с этим приложением\n        const existingMinimizedWindow = windows.value.find(w => \n            w.appName === appName && \n            w.contentApp === appData.contentapp &&\n            w.isMinimized\n        );\n        \n        if (existingMinimizedWindow) {\n            restoreWindow(existingMinimizedWindow.id);\n            return existingMinimizedWindow.id;\n        }\n        \n        // Создаём новое окно с возможным начальным состоянием\n        const newWindow = {\n            ...appData,\n            id: 'window_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9),\n            appName: appName,\n            contentApp: appData.contentapp,\n            title: appData.label || appData.name,\n            isMinimized: appData.isMinimized || false,\n            isMaximized: appData.isMaximized || false,            \n            zIndex: nextZIndex++,\n            state: appData.state || {}, // Сохраняем начальное состояние\n            initialState: appData.state || {} // Дублируем для передачи в компонент\n        };\n    \n        windows.value.push(newWindow);\n        activateWindow(newWindow.id);\n    \n        return newWindow.id;\n    };\n  \n    const closeWindow = (windowId) => {\n        const index = windows.value.findIndex(w => w.id === windowId);\n        \n        if (index !== -1) {\n            windows.value.splice(index, 1);\n        }\n    };\n  \n    const minimizeWindow = (windowId) => {\n        const window = windows.value.find(w => w.id === windowId);\n        \n        if (window) {\n            window.isMinimized = true;\n        }\n    };\n  \n    const restoreWindow = (windowId) => {\n        const window = windows.value.find(w => w.id === windowId);\n    \n        if (window) {\n            window.isMinimized = false;\n            activateWindow(windowId);\n        }\n    };\n  \n    const toggleMaximizeWindow = (windowId) => {\n        const window = windows.value.find(w => w.id === windowId);\n\n        if (window) {\n            window.isMaximized = !window.isMaximized;\n            activateWindow(windowId);\n        }\n    };\n    \n    // Новый метод для обновления состояния окна\n    const updateWindowState = (windowId, state) => {\n        const window = windows.value.find(w => w.id === windowId);\n        \n        if (window) {\n            window.state = { ...window.state, ...state };\n        }\n    };\n    \n    // Получение состояния окна\n    const getWindowState = (windowId) => {\n        const window = windows.value.find(w => w.id === windowId);\n        return window ? window.state : null;\n    };\n  \n    return {\n        windows,\n        activeWindowId,\n        openWindow,\n        closeWindow,\n        minimizeWindow,\n        restoreWindow,\n        toggleMaximizeWindow,\n        activateWindow,\n        updateWindowState, // Добавляем экспорт\n        getWindowState     // Добавляем экспорт\n    };\n});"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}