{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/esnext.json.parse.js\";\n// os.store.js - обновленная версия\nimport { defineStore } from 'pinia';\nimport { ref } from 'vue';\nexport const useNotifStore = defineStore('os', () => {\n  const LOCALSTORAGE_KEY = \"osi_notifs\";\n  const notifs = ref([]);\n\n  // Загружаем сохраненные уведомления из localStorage при инициализации\n  const loadNotifsFromStorage = () => {\n    try {\n      const saved = localStorage.getItem(LOCALSTORAGE_KEY);\n      if (saved) {\n        const parsed = JSON.parse(saved);\n        if (parsed && Array.isArray(parsed)) {\n          notifs.value = parsed;\n          console.log('Loaded notifs from storage:', notifs.value.length);\n        }\n      }\n    } catch (error) {\n      console.error('Failed to load notifs from storage:', error);\n    }\n  };\n\n  // Сохраняем уведомления в localStorage\n  const saveNotifsToStorage = () => {\n    try {\n      const state = notifs.value.map(w => ({\n        appId: w.appId,\n        content: w.content,\n        header: w.header\n      }));\n      localStorage.setItem(LOCALSTORAGE_KEY, JSON.stringify(state));\n    } catch (error) {\n      console.error('Failed to save notifs to storage:', error);\n    }\n  };\n\n  // Добавляем новое уведомление\n  const addNotification = (appId, header, content) => {\n    const newNotif = {\n      id: Date.now().toString(),\n      appId,\n      header,\n      content,\n      timestamp: Date.now()\n    };\n    notifs.value.unshift(newNotif); // Добавляем в начало\n\n    // Ограничиваем количество уведомлений (например, последние 10)\n    if (notifs.value.length > 10) {\n      notifs.value = notifs.value.slice(0, 10);\n    }\n    saveNotifsToStorage();\n\n    // Автоматически удаляем уведомление через 5 секунд\n    setTimeout(() => {\n      removeNotification(newNotif.id);\n    }, 5000);\n    return newNotif;\n  };\n\n  // Инициализация\n  loadNotifsFromStorage();\n\n  // Метод для очистки всех уведомлений\n  const clearAllNotifs = () => {\n    notifs.value = [];\n    localStorage.removeItem(LOCALSTORAGE_KEY);\n  };\n  return {\n    notifs,\n    addNotification,\n    clearAllNotifs,\n    saveNotifsToStorage\n  };\n});","map":{"version":3,"names":["defineStore","ref","useNotifStore","LOCALSTORAGE_KEY","notifs","loadNotifsFromStorage","saved","localStorage","getItem","parsed","JSON","parse","Array","isArray","value","console","log","length","error","saveNotifsToStorage","state","map","w","appId","content","header","setItem","stringify","addNotification","newNotif","id","Date","now","toString","timestamp","unshift","slice","setTimeout","removeNotification","clearAllNotifs","removeItem"],"sources":["/home/kup/my_projects/vue/osi/src/stores/notif.store.js"],"sourcesContent":["// os.store.js - обновленная версия\nimport { defineStore } from 'pinia'\nimport { ref } from 'vue'\n\nexport const useNotifStore = defineStore('os', () => {\n    const LOCALSTORAGE_KEY = \"osi_notifs\";\n    const notifs = ref([]);\n\n    // Загружаем сохраненные уведомления из localStorage при инициализации\n    const loadNotifsFromStorage = () => {\n        try {\n            const saved = localStorage.getItem(LOCALSTORAGE_KEY);\n\n            if (saved) {\n                const parsed = JSON.parse(saved);\n\n                if (parsed && Array.isArray(parsed)) {\n                    notifs.value = parsed;\n                    console.log('Loaded notifs from storage:', notifs.value.length);\n                }\n            }\n        } catch (error) {\n            console.error('Failed to load notifs from storage:', error);\n        }\n    };\n    \n    // Сохраняем уведомления в localStorage\n    const saveNotifsToStorage = () => {\n        try {\n            const state = notifs.value.map(w => ({\n                    appId: w.appId,\n                    content: w.content,\n                    header: w.header,\n                }));\n            \n            localStorage.setItem(LOCALSTORAGE_KEY, JSON.stringify(state));\n        } catch (error) {\n            console.error('Failed to save notifs to storage:', error);\n        }\n    };\n    \n     // Добавляем новое уведомление\n    const addNotification = (appId, header, content) => {\n        const newNotif = {\n            id: Date.now().toString(),\n            appId,\n            header,\n            content,\n            timestamp: Date.now()\n        };\n        \n        notifs.value.unshift(newNotif); // Добавляем в начало\n        \n        // Ограничиваем количество уведомлений (например, последние 10)\n        if (notifs.value.length > 10) {\n            notifs.value = notifs.value.slice(0, 10);\n        }\n        \n        saveNotifsToStorage();\n        \n        // Автоматически удаляем уведомление через 5 секунд\n        setTimeout(() => {\n            removeNotification(newNotif.id);\n        }, 5000);\n        \n        return newNotif;\n    };\n\n    // Инициализация\n    loadNotifsFromStorage();\n\n    // Метод для очистки всех уведомлений\n    const clearAllNotifs = () => {\n        notifs.value = [];\n        localStorage.removeItem(LOCALSTORAGE_KEY);\n    };\n\n    return {\n        notifs,\n        addNotification,\n        clearAllNotifs,\n        saveNotifsToStorage\n    };\n});"],"mappings":";;;;AAAA;AACA,SAASA,WAAW,QAAQ,OAAO;AACnC,SAASC,GAAG,QAAQ,KAAK;AAEzB,OAAO,MAAMC,aAAa,GAAGF,WAAW,CAAC,IAAI,EAAE,MAAM;EACjD,MAAMG,gBAAgB,GAAG,YAAY;EACrC,MAAMC,MAAM,GAAGH,GAAG,CAAC,EAAE,CAAC;;EAEtB;EACA,MAAMI,qBAAqB,GAAGA,CAAA,KAAM;IAChC,IAAI;MACA,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAACL,gBAAgB,CAAC;MAEpD,IAAIG,KAAK,EAAE;QACP,MAAMG,MAAM,GAAGC,IAAI,CAACC,KAAK,CAACL,KAAK,CAAC;QAEhC,IAAIG,MAAM,IAAIG,KAAK,CAACC,OAAO,CAACJ,MAAM,CAAC,EAAE;UACjCL,MAAM,CAACU,KAAK,GAAGL,MAAM;UACrBM,OAAO,CAACC,GAAG,CAAC,6BAA6B,EAAEZ,MAAM,CAACU,KAAK,CAACG,MAAM,CAAC;QACnE;MACJ;IACJ,CAAC,CAAC,OAAOC,KAAK,EAAE;MACZH,OAAO,CAACG,KAAK,CAAC,qCAAqC,EAAEA,KAAK,CAAC;IAC/D;EACJ,CAAC;;EAED;EACA,MAAMC,mBAAmB,GAAGA,CAAA,KAAM;IAC9B,IAAI;MACA,MAAMC,KAAK,GAAGhB,MAAM,CAACU,KAAK,CAACO,GAAG,CAACC,CAAC,KAAK;QAC7BC,KAAK,EAAED,CAAC,CAACC,KAAK;QACdC,OAAO,EAAEF,CAAC,CAACE,OAAO;QAClBC,MAAM,EAAEH,CAAC,CAACG;MACd,CAAC,CAAC,CAAC;MAEPlB,YAAY,CAACmB,OAAO,CAACvB,gBAAgB,EAAEO,IAAI,CAACiB,SAAS,CAACP,KAAK,CAAC,CAAC;IACjE,CAAC,CAAC,OAAOF,KAAK,EAAE;MACZH,OAAO,CAACG,KAAK,CAAC,mCAAmC,EAAEA,KAAK,CAAC;IAC7D;EACJ,CAAC;;EAEA;EACD,MAAMU,eAAe,GAAGA,CAACL,KAAK,EAAEE,MAAM,EAAED,OAAO,KAAK;IAChD,MAAMK,QAAQ,GAAG;MACbC,EAAE,EAAEC,IAAI,CAACC,GAAG,CAAC,CAAC,CAACC,QAAQ,CAAC,CAAC;MACzBV,KAAK;MACLE,MAAM;MACND,OAAO;MACPU,SAAS,EAAEH,IAAI,CAACC,GAAG,CAAC;IACxB,CAAC;IAED5B,MAAM,CAACU,KAAK,CAACqB,OAAO,CAACN,QAAQ,CAAC,CAAC,CAAC;;IAEhC;IACA,IAAIzB,MAAM,CAACU,KAAK,CAACG,MAAM,GAAG,EAAE,EAAE;MAC1Bb,MAAM,CAACU,KAAK,GAAGV,MAAM,CAACU,KAAK,CAACsB,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC;IAC5C;IAEAjB,mBAAmB,CAAC,CAAC;;IAErB;IACAkB,UAAU,CAAC,MAAM;MACbC,kBAAkB,CAACT,QAAQ,CAACC,EAAE,CAAC;IACnC,CAAC,EAAE,IAAI,CAAC;IAER,OAAOD,QAAQ;EACnB,CAAC;;EAED;EACAxB,qBAAqB,CAAC,CAAC;;EAEvB;EACA,MAAMkC,cAAc,GAAGA,CAAA,KAAM;IACzBnC,MAAM,CAACU,KAAK,GAAG,EAAE;IACjBP,YAAY,CAACiC,UAAU,CAACrC,gBAAgB,CAAC;EAC7C,CAAC;EAED,OAAO;IACHC,MAAM;IACNwB,eAAe;IACfW,cAAc;IACdpB;EACJ,CAAC;AACL,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}