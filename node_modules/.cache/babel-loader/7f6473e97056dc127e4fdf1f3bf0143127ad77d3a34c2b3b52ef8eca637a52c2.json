{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/es.json.stringify.js\";\nimport \"core-js/modules/esnext.json.parse.js\";\n// os.app.state.js\nconst appStates = new Map();\nexport const appState = {\n  saveState(windowId, state) {\n    appStates.set(windowId, state);\n    // Дублируем в localStorage для persistence\n    try {\n      localStorage.setItem(`app_state_${windowId}`, JSON.stringify(state));\n    } catch (e) {\n      console.warn('Failed to save to localStorage:', e);\n    }\n  },\n  getState(windowId) {\n    // Сначала проверяем memory cache\n    if (appStates.has(windowId)) {\n      return appStates.get(windowId);\n    }\n\n    // Потом localStorage\n    try {\n      const saved = localStorage.getItem(`app_state_${windowId}`);\n      if (saved) {\n        const state = JSON.parse(saved);\n        appStates.set(windowId, state); // Кэшируем\n        return state;\n      }\n    } catch (e) {\n      console.warn('Failed to load from localStorage:', e);\n    }\n    return null;\n  },\n  delState(windowId) {\n    appStates.delete(windowId);\n    try {\n      localStorage.removeItem(`app_state_${windowId}`);\n    } catch (e) {\n      console.warn('Failed to remove from localStorage:', e);\n    }\n  },\n  clearStates() {\n    appStates.clear();\n    // Очищаем только наши ключи\n    Object.keys(localStorage).forEach(key => {\n      if (key.startsWith('app_state_')) {\n        localStorage.removeItem(key);\n      }\n    });\n  }\n};","map":{"version":3,"names":["appStates","Map","appState","saveState","windowId","state","set","localStorage","setItem","JSON","stringify","e","console","warn","getState","has","get","saved","getItem","parse","delState","delete","removeItem","clearStates","clear","Object","keys","forEach","key","startsWith"],"sources":["/home/kup/my_projects/vue/osi/src/stores/os.app.state.js"],"sourcesContent":["// os.app.state.js\nconst appStates = new Map();\n\nexport const appState = {\n    saveState(windowId, state) {\n        appStates.set(windowId, state);\n        // Дублируем в localStorage для persistence\n        try {\n            localStorage.setItem(`app_state_${windowId}`, JSON.stringify(state));\n        } catch (e) {\n            console.warn('Failed to save to localStorage:', e);\n        }\n    },\n\n    getState(windowId) {\n        // Сначала проверяем memory cache\n        if (appStates.has(windowId)) {\n            return appStates.get(windowId);\n        }\n        \n        // Потом localStorage\n        try {\n            const saved = localStorage.getItem(`app_state_${windowId}`);\n            if (saved) {\n                const state = JSON.parse(saved);\n                appStates.set(windowId, state); // Кэшируем\n                return state;\n            }\n        } catch (e) {\n            console.warn('Failed to load from localStorage:', e);\n        }\n        \n        return null;\n    },\n\n    delState(windowId) {\n        appStates.delete(windowId);\n        try {\n            localStorage.removeItem(`app_state_${windowId}`);\n        } catch (e) {\n            console.warn('Failed to remove from localStorage:', e);\n        }\n    },\n\n    clearStates() {\n        appStates.clear();\n        // Очищаем только наши ключи\n        Object.keys(localStorage).forEach(key => {\n            if (key.startsWith('app_state_')) {\n                localStorage.removeItem(key);\n            }\n        });\n    }\n}"],"mappings":";;;;AAAA;AACA,MAAMA,SAAS,GAAG,IAAIC,GAAG,CAAC,CAAC;AAE3B,OAAO,MAAMC,QAAQ,GAAG;EACpBC,SAASA,CAACC,QAAQ,EAAEC,KAAK,EAAE;IACvBL,SAAS,CAACM,GAAG,CAACF,QAAQ,EAAEC,KAAK,CAAC;IAC9B;IACA,IAAI;MACAE,YAAY,CAACC,OAAO,CAAC,aAAaJ,QAAQ,EAAE,EAAEK,IAAI,CAACC,SAAS,CAACL,KAAK,CAAC,CAAC;IACxE,CAAC,CAAC,OAAOM,CAAC,EAAE;MACRC,OAAO,CAACC,IAAI,CAAC,iCAAiC,EAAEF,CAAC,CAAC;IACtD;EACJ,CAAC;EAEDG,QAAQA,CAACV,QAAQ,EAAE;IACf;IACA,IAAIJ,SAAS,CAACe,GAAG,CAACX,QAAQ,CAAC,EAAE;MACzB,OAAOJ,SAAS,CAACgB,GAAG,CAACZ,QAAQ,CAAC;IAClC;;IAEA;IACA,IAAI;MACA,MAAMa,KAAK,GAAGV,YAAY,CAACW,OAAO,CAAC,aAAad,QAAQ,EAAE,CAAC;MAC3D,IAAIa,KAAK,EAAE;QACP,MAAMZ,KAAK,GAAGI,IAAI,CAACU,KAAK,CAACF,KAAK,CAAC;QAC/BjB,SAAS,CAACM,GAAG,CAACF,QAAQ,EAAEC,KAAK,CAAC,CAAC,CAAC;QAChC,OAAOA,KAAK;MAChB;IACJ,CAAC,CAAC,OAAOM,CAAC,EAAE;MACRC,OAAO,CAACC,IAAI,CAAC,mCAAmC,EAAEF,CAAC,CAAC;IACxD;IAEA,OAAO,IAAI;EACf,CAAC;EAEDS,QAAQA,CAAChB,QAAQ,EAAE;IACfJ,SAAS,CAACqB,MAAM,CAACjB,QAAQ,CAAC;IAC1B,IAAI;MACAG,YAAY,CAACe,UAAU,CAAC,aAAalB,QAAQ,EAAE,CAAC;IACpD,CAAC,CAAC,OAAOO,CAAC,EAAE;MACRC,OAAO,CAACC,IAAI,CAAC,qCAAqC,EAAEF,CAAC,CAAC;IAC1D;EACJ,CAAC;EAEDY,WAAWA,CAAA,EAAG;IACVvB,SAAS,CAACwB,KAAK,CAAC,CAAC;IACjB;IACAC,MAAM,CAACC,IAAI,CAACnB,YAAY,CAAC,CAACoB,OAAO,CAACC,GAAG,IAAI;MACrC,IAAIA,GAAG,CAACC,UAAU,CAAC,YAAY,CAAC,EAAE;QAC9BtB,YAAY,CAACe,UAAU,CAACM,GAAG,CAAC;MAChC;IACJ,CAAC,CAAC;EACN;AACJ,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}