{"ast":null,"code":"import * as Token from 'token-types';\nimport { FourCcToken } from '../common/FourCC.js';\nimport { makeUnexpectedFileContentError } from '../ParseError.js';\nexport const compressionTypes = {\n  NONE: 'not compressed\tPCM\tApple Computer',\n  sowt: 'PCM (byte swapped)',\n  fl32: '32-bit floating point IEEE 32-bit float',\n  fl64: '64-bit floating point IEEE 64-bit float\tApple Computer',\n  alaw: 'ALaw 2:1\t8-bit ITU-T G.711 A-law',\n  ulaw: 'µLaw 2:1\t8-bit ITU-T G.711 µ-law\tApple Computer',\n  ULAW: 'CCITT G.711 u-law 8-bit ITU-T G.711 µ-law',\n  ALAW: 'CCITT G.711 A-law 8-bit ITU-T G.711 A-law',\n  FL32: 'Float 32\tIEEE 32-bit float '\n};\nexport class AiffContentError extends makeUnexpectedFileContentError('AIFF') {}\nexport class Common {\n  constructor(header, isAifc) {\n    this.isAifc = isAifc;\n    const minimumChunkSize = isAifc ? 22 : 18;\n    if (header.chunkSize < minimumChunkSize) throw new AiffContentError(`COMMON CHUNK size should always be at least ${minimumChunkSize}`);\n    this.len = header.chunkSize;\n  }\n  get(buf, off) {\n    // see: https://cycling74.com/forums/aiffs-80-bit-sample-rate-value\n    const shift = Token.UINT16_BE.get(buf, off + 8) - 16398;\n    const baseSampleRate = Token.UINT16_BE.get(buf, off + 8 + 2);\n    const res = {\n      numChannels: Token.UINT16_BE.get(buf, off),\n      numSampleFrames: Token.UINT32_BE.get(buf, off + 2),\n      sampleSize: Token.UINT16_BE.get(buf, off + 6),\n      sampleRate: shift < 0 ? baseSampleRate >> Math.abs(shift) : baseSampleRate << shift\n    };\n    if (this.isAifc) {\n      res.compressionType = FourCcToken.get(buf, off + 18);\n      if (this.len > 22) {\n        const strLen = Token.UINT8.get(buf, off + 22);\n        if (strLen > 0) {\n          const padding = (strLen + 1) % 2;\n          if (23 + strLen + padding === this.len) {\n            res.compressionName = new Token.StringType(strLen, 'latin1').get(buf, off + 23);\n          } else {\n            throw new AiffContentError('Illegal pstring length');\n          }\n        } else {\n          res.compressionName = undefined;\n        }\n      }\n    } else {\n      res.compressionName = 'PCM';\n    }\n    return res;\n  }\n}","map":{"version":3,"names":["Token","FourCcToken","makeUnexpectedFileContentError","compressionTypes","NONE","sowt","fl32","fl64","alaw","ulaw","ULAW","ALAW","FL32","AiffContentError","Common","constructor","header","isAifc","minimumChunkSize","chunkSize","len","get","buf","off","shift","UINT16_BE","baseSampleRate","res","numChannels","numSampleFrames","UINT32_BE","sampleSize","sampleRate","Math","abs","compressionType","strLen","UINT8","padding","compressionName","StringType","undefined"],"sources":["C:/projects/My projects/Vue/osi/node_modules/music-metadata/lib/aiff/AiffToken.js"],"sourcesContent":["import * as Token from 'token-types';\r\nimport { FourCcToken } from '../common/FourCC.js';\r\nimport { makeUnexpectedFileContentError } from '../ParseError.js';\r\nexport const compressionTypes = {\r\n    NONE: 'not compressed\tPCM\tApple Computer',\r\n    sowt: 'PCM (byte swapped)',\r\n    fl32: '32-bit floating point IEEE 32-bit float',\r\n    fl64: '64-bit floating point IEEE 64-bit float\tApple Computer',\r\n    alaw: 'ALaw 2:1\t8-bit ITU-T G.711 A-law',\r\n    ulaw: 'µLaw 2:1\t8-bit ITU-T G.711 µ-law\tApple Computer',\r\n    ULAW: 'CCITT G.711 u-law 8-bit ITU-T G.711 µ-law',\r\n    ALAW: 'CCITT G.711 A-law 8-bit ITU-T G.711 A-law',\r\n    FL32: 'Float 32\tIEEE 32-bit float '\r\n};\r\nexport class AiffContentError extends makeUnexpectedFileContentError('AIFF') {\r\n}\r\nexport class Common {\r\n    constructor(header, isAifc) {\r\n        this.isAifc = isAifc;\r\n        const minimumChunkSize = isAifc ? 22 : 18;\r\n        if (header.chunkSize < minimumChunkSize)\r\n            throw new AiffContentError(`COMMON CHUNK size should always be at least ${minimumChunkSize}`);\r\n        this.len = header.chunkSize;\r\n    }\r\n    get(buf, off) {\r\n        // see: https://cycling74.com/forums/aiffs-80-bit-sample-rate-value\r\n        const shift = Token.UINT16_BE.get(buf, off + 8) - 16398;\r\n        const baseSampleRate = Token.UINT16_BE.get(buf, off + 8 + 2);\r\n        const res = {\r\n            numChannels: Token.UINT16_BE.get(buf, off),\r\n            numSampleFrames: Token.UINT32_BE.get(buf, off + 2),\r\n            sampleSize: Token.UINT16_BE.get(buf, off + 6),\r\n            sampleRate: shift < 0 ? baseSampleRate >> Math.abs(shift) : baseSampleRate << shift\r\n        };\r\n        if (this.isAifc) {\r\n            res.compressionType = FourCcToken.get(buf, off + 18);\r\n            if (this.len > 22) {\r\n                const strLen = Token.UINT8.get(buf, off + 22);\r\n                if (strLen > 0) {\r\n                    const padding = (strLen + 1) % 2;\r\n                    if (23 + strLen + padding === this.len) {\r\n                        res.compressionName = new Token.StringType(strLen, 'latin1').get(buf, off + 23);\r\n                    }\r\n                    else {\r\n                        throw new AiffContentError('Illegal pstring length');\r\n                    }\r\n                }\r\n                else {\r\n                    res.compressionName = undefined;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            res.compressionName = 'PCM';\r\n        }\r\n        return res;\r\n    }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}