{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.find.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport { computed, ref, onMounted, onUnmounted } from 'vue';\nimport { useOsStore } from '../../stores/os.store';\nexport default {\n  __name: 'OsWindow',\n  props: {\n    windowId: {\n      type: String,\n      required: true\n    },\n    title: {\n      type: String,\n      default: 'Окно'\n    },\n    initialWidth: {\n      type: Number,\n      default: 600\n    },\n    initialHeight: {\n      type: Number,\n      default: 400\n    }\n  },\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const props = __props;\n    const osStore = useOsStore();\n\n    // Локальное состояние для перетаскивания\n    const isDragging = ref(false);\n    const dragOffset = ref({\n      x: 0,\n      y: 0\n    });\n\n    // Находим состояние окна в хранилище\n    const windowState = computed(() => osStore.windows.find(w => w.id === props.windowId) || {});\n    const isActive = computed(() => osStore.activeWindowId === props.windowId);\n    const isMinimized = computed(() => windowState.value.isMinimized || false);\n    const windowStyles = computed(() => ({\n      left: `${windowState.value.position?.x || 100}px`,\n      top: `${windowState.value.position?.y || 100}px`,\n      width: `${windowState.value.size?.width || props.initialWidth}px`,\n      height: `${windowState.value.size?.height || props.initialHeight}px`,\n      zIndex: windowState.value.zIndex || 1\n    }));\n\n    // Обработчики событий окна\n    const minimize = () => {\n      // Пока просто скрываем, позже добавим в osStore\n      osStore.windows = osStore.windows.map(w => w.id === props.windowId ? {\n        ...w,\n        isMinimized: true\n      } : w);\n    };\n    const toggleMaximize = () => {\n      osStore.windows = osStore.windows.map(w => w.id === props.windowId ? {\n        ...w,\n        isMaximized: !w.isMaximized\n      } : w);\n    };\n    const close = () => {\n      osStore.closeWindow(props.windowId);\n    };\n\n    // Логика перетаскивания окна\n    const startDrag = e => {\n      osStore.bringToFront(props.windowId);\n      const rect = e.currentTarget.getBoundingClientRect();\n      dragOffset.value = {\n        x: e.clientX - rect.left,\n        y: e.clientY - rect.top\n      };\n      isDragging.value = true;\n      e.preventDefault();\n    };\n    const onWindowMouseDown = () => {\n      osStore.bringToFront(props.windowId);\n    };\n\n    // Глобальные обработчики мыши для перетаскивания\n    onMounted(() => {\n      const handleMouseMove = e => {\n        if (!isDragging.value) return;\n        const window = osStore.windows.find(w => w.id === props.windowId);\n        if (window) {\n          window.position = {\n            x: e.clientX - dragOffset.value.x,\n            y: e.clientY - dragOffset.value.y\n          };\n        }\n      };\n      const handleMouseUp = () => {\n        isDragging.value = false;\n      };\n      document.addEventListener('mousemove', handleMouseMove);\n      document.addEventListener('mouseup', handleMouseUp);\n      onUnmounted(() => {\n        document.removeEventListener('mousemove', handleMouseMove);\n        document.removeEventListener('mouseup', handleMouseUp);\n      });\n    });\n    const __returned__ = {\n      props,\n      osStore,\n      isDragging,\n      dragOffset,\n      windowState,\n      isActive,\n      isMinimized,\n      windowStyles,\n      minimize,\n      toggleMaximize,\n      close,\n      startDrag,\n      onWindowMouseDown,\n      computed,\n      ref,\n      onMounted,\n      onUnmounted,\n      get useOsStore() {\n        return useOsStore;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["computed","ref","onMounted","onUnmounted","useOsStore","props","__props","osStore","isDragging","dragOffset","x","y","windowState","windows","find","w","id","windowId","isActive","activeWindowId","isMinimized","value","windowStyles","left","position","top","width","size","initialWidth","height","initialHeight","zIndex","minimize","map","toggleMaximize","isMaximized","close","closeWindow","startDrag","e","bringToFront","rect","currentTarget","getBoundingClientRect","clientX","clientY","preventDefault","onWindowMouseDown","handleMouseMove","window","handleMouseUp","document","addEventListener","removeEventListener"],"sources":["/home/kup/my_projects/vue/osi/src/components/os/OsWindow.vue"],"sourcesContent":["<template>\n  <div \n    class=\"window\" \n    :class=\"{ 'active': isActive }\"\n    :style=\"windowStyles\"\n    v-show=\"!isMinimized\"\n    @mousedown=\"onWindowMouseDown\"\n  >\n    <div class=\"title-bar\" @mousedown=\"startDrag\">\n      <span class=\"title\">{{ title }}</span>\n      <div class=\"window-controls\">\n        <button class=\"minimize-btn\" @click=\"minimize\">_</button>\n        <button class=\"maximize-btn\" @click=\"toggleMaximize\">□</button>\n        <button class=\"close-btn\" @click=\"close\">✕</button>\n      </div>\n    </div>\n    <div class=\"window-content\">\n      <slot></slot>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { computed, ref, onMounted, onUnmounted } from 'vue'\nimport { useOsStore } from '../../stores/os.store'\n\nconst props = defineProps({\n  windowId: {\n    type: String,\n    required: true\n  },\n  title: {\n    type: String,\n    default: 'Окно'\n  },\n  initialWidth: {\n    type: Number,\n    default: 600\n  },\n  initialHeight: {\n    type: Number,\n    default: 400\n  }\n})\n\nconst osStore = useOsStore()\n\n// Локальное состояние для перетаскивания\nconst isDragging = ref(false)\nconst dragOffset = ref({ x: 0, y: 0 })\n\n// Находим состояние окна в хранилище\nconst windowState = computed(() => \n  osStore.windows.find(w => w.id === props.windowId) || {}\n)\n\nconst isActive = computed(() => osStore.activeWindowId === props.windowId)\nconst isMinimized = computed(() => windowState.value.isMinimized || false)\n\nconst windowStyles = computed(() => ({\n  left: `${windowState.value.position?.x || 100}px`,\n  top: `${windowState.value.position?.y || 100}px`,\n  width: `${windowState.value.size?.width || props.initialWidth}px`,\n  height: `${windowState.value.size?.height || props.initialHeight}px`,\n  zIndex: windowState.value.zIndex || 1\n}))\n\n// Обработчики событий окна\nconst minimize = () => {\n  // Пока просто скрываем, позже добавим в osStore\n  osStore.windows = osStore.windows.map(w => \n    w.id === props.windowId ? { ...w, isMinimized: true } : w\n  )\n}\n\nconst toggleMaximize = () => {\n  osStore.windows = osStore.windows.map(w => \n    w.id === props.windowId ? { ...w, isMaximized: !w.isMaximized } : w\n  )\n}\n\nconst close = () => {\n  osStore.closeWindow(props.windowId)\n}\n\n// Логика перетаскивания окна\nconst startDrag = (e) => {\n  osStore.bringToFront(props.windowId)\n  \n  const rect = e.currentTarget.getBoundingClientRect()\n  dragOffset.value = {\n    x: e.clientX - rect.left,\n    y: e.clientY - rect.top\n  }\n  isDragging.value = true\n  \n  e.preventDefault()\n}\n\nconst onWindowMouseDown = () => {\n  osStore.bringToFront(props.windowId)\n}\n\n// Глобальные обработчики мыши для перетаскивания\nonMounted(() => {\n  const handleMouseMove = (e) => {\n    if (!isDragging.value) return\n    \n    const window = osStore.windows.find(w => w.id === props.windowId)\n    if (window) {\n      window.position = {\n        x: e.clientX - dragOffset.value.x,\n        y: e.clientY - dragOffset.value.y\n      }\n    }\n  }\n  \n  const handleMouseUp = () => {\n    isDragging.value = false\n  }\n  \n  document.addEventListener('mousemove', handleMouseMove)\n  document.addEventListener('mouseup', handleMouseUp)\n  \n  onUnmounted(() => {\n    document.removeEventListener('mousemove', handleMouseMove)\n    document.removeEventListener('mouseup', handleMouseUp)\n  })\n})\n</script>\n\n<style scoped>\n.window {\n  position: absolute;\n  background: white;\n  border: 1px solid #ccc;\n  border-radius: 8px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n  min-width: 200px;\n  min-height: 150px;\n}\n\n.window.active {\n  border-color: #0078d4;\n}\n\n.title-bar {\n  background: linear-gradient(to bottom, #f0f0f0, #e0e0e0);\n  padding: 8px 12px;\n  cursor: move;\n  user-select: none;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  border-bottom: 1px solid #ccc;\n}\n\n.title {\n  font-weight: bold;\n  font-size: 14px;\n}\n\n.window-controls {\n  display: flex;\n  gap: 4px;\n}\n\n.window-controls button {\n  width: 24px;\n  height: 24px;\n  border: 1px solid #aaa;\n  background: #f9f9f9;\n  border-radius: 3px;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 12px;\n}\n\n.window-controls button:hover {\n  background: #e9e9e9;\n}\n\n.close-btn:hover {\n  background: #e81123 !important;\n  color: white;\n  border-color: #e81123;\n}\n\n.window-content {\n  flex: 1;\n  padding: 12px;\n  overflow: auto;\n  background: white;\n}\n</style>"],"mappings":";;;AAuBA,SAASA,QAAQ,EAAEC,GAAG,EAAEC,SAAS,EAAEC,WAAW,QAAQ,KAAI;AAC1D,SAASC,UAAU,QAAQ,uBAAsB;;;;;;;;;;;;;;;;;;;;;;;;;IAEjD,MAAMC,KAAK,GAAGC,OAAA;IAmBd,MAAMC,OAAO,GAAGH,UAAU,CAAC;;IAE3B;IACA,MAAMI,UAAU,GAAGP,GAAG,CAAC,KAAK;IAC5B,MAAMQ,UAAU,GAAGR,GAAG,CAAC;MAAES,CAAC,EAAE,CAAC;MAAEC,CAAC,EAAE;IAAE,CAAC;;IAErC;IACA,MAAMC,WAAW,GAAGZ,QAAQ,CAAC,MAC3BO,OAAO,CAACM,OAAO,CAACC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,EAAE,KAAKX,KAAK,CAACY,QAAQ,CAAC,IAAI,CAAC,CACzD;IAEA,MAAMC,QAAQ,GAAGlB,QAAQ,CAAC,MAAMO,OAAO,CAACY,cAAc,KAAKd,KAAK,CAACY,QAAQ;IACzE,MAAMG,WAAW,GAAGpB,QAAQ,CAAC,MAAMY,WAAW,CAACS,KAAK,CAACD,WAAW,IAAI,KAAK;IAEzE,MAAME,YAAY,GAAGtB,QAAQ,CAAC,OAAO;MACnCuB,IAAI,EAAE,GAAGX,WAAW,CAACS,KAAK,CAACG,QAAQ,EAAEd,CAAC,IAAI,GAAG,IAAI;MACjDe,GAAG,EAAE,GAAGb,WAAW,CAACS,KAAK,CAACG,QAAQ,EAAEb,CAAC,IAAI,GAAG,IAAI;MAChDe,KAAK,EAAE,GAAGd,WAAW,CAACS,KAAK,CAACM,IAAI,EAAED,KAAK,IAAIrB,KAAK,CAACuB,YAAY,IAAI;MACjEC,MAAM,EAAE,GAAGjB,WAAW,CAACS,KAAK,CAACM,IAAI,EAAEE,MAAM,IAAIxB,KAAK,CAACyB,aAAa,IAAI;MACpEC,MAAM,EAAEnB,WAAW,CAACS,KAAK,CAACU,MAAM,IAAI;IACtC,CAAC,CAAC;;IAEF;IACA,MAAMC,QAAQ,GAAGA,CAAA,KAAM;MACrB;MACAzB,OAAO,CAACM,OAAO,GAAGN,OAAO,CAACM,OAAO,CAACoB,GAAG,CAAClB,CAAC,IACrCA,CAAC,CAACC,EAAE,KAAKX,KAAK,CAACY,QAAQ,GAAG;QAAE,GAAGF,CAAC;QAAEK,WAAW,EAAE;MAAK,CAAC,GAAGL,CAC1D;IACF;IAEA,MAAMmB,cAAc,GAAGA,CAAA,KAAM;MAC3B3B,OAAO,CAACM,OAAO,GAAGN,OAAO,CAACM,OAAO,CAACoB,GAAG,CAAClB,CAAC,IACrCA,CAAC,CAACC,EAAE,KAAKX,KAAK,CAACY,QAAQ,GAAG;QAAE,GAAGF,CAAC;QAAEoB,WAAW,EAAE,CAACpB,CAAC,CAACoB;MAAY,CAAC,GAAGpB,CACpE;IACF;IAEA,MAAMqB,KAAK,GAAGA,CAAA,KAAM;MAClB7B,OAAO,CAAC8B,WAAW,CAAChC,KAAK,CAACY,QAAQ;IACpC;;IAEA;IACA,MAAMqB,SAAS,GAAIC,CAAC,IAAK;MACvBhC,OAAO,CAACiC,YAAY,CAACnC,KAAK,CAACY,QAAQ;MAEnC,MAAMwB,IAAI,GAAGF,CAAC,CAACG,aAAa,CAACC,qBAAqB,CAAC;MACnDlC,UAAU,CAACY,KAAK,GAAG;QACjBX,CAAC,EAAE6B,CAAC,CAACK,OAAO,GAAGH,IAAI,CAAClB,IAAI;QACxBZ,CAAC,EAAE4B,CAAC,CAACM,OAAO,GAAGJ,IAAI,CAAChB;MACtB;MACAjB,UAAU,CAACa,KAAK,GAAG,IAAG;MAEtBkB,CAAC,CAACO,cAAc,CAAC;IACnB;IAEA,MAAMC,iBAAiB,GAAGA,CAAA,KAAM;MAC9BxC,OAAO,CAACiC,YAAY,CAACnC,KAAK,CAACY,QAAQ;IACrC;;IAEA;IACAf,SAAS,CAAC,MAAM;MACd,MAAM8C,eAAe,GAAIT,CAAC,IAAK;QAC7B,IAAI,CAAC/B,UAAU,CAACa,KAAK,EAAE;QAEvB,MAAM4B,MAAM,GAAG1C,OAAO,CAACM,OAAO,CAACC,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACC,EAAE,KAAKX,KAAK,CAACY,QAAQ;QAChE,IAAIgC,MAAM,EAAE;UACVA,MAAM,CAACzB,QAAQ,GAAG;YAChBd,CAAC,EAAE6B,CAAC,CAACK,OAAO,GAAGnC,UAAU,CAACY,KAAK,CAACX,CAAC;YACjCC,CAAC,EAAE4B,CAAC,CAACM,OAAO,GAAGpC,UAAU,CAACY,KAAK,CAACV;UAClC;QACF;MACF;MAEA,MAAMuC,aAAa,GAAGA,CAAA,KAAM;QAC1B1C,UAAU,CAACa,KAAK,GAAG,KAAI;MACzB;MAEA8B,QAAQ,CAACC,gBAAgB,CAAC,WAAW,EAAEJ,eAAe;MACtDG,QAAQ,CAACC,gBAAgB,CAAC,SAAS,EAAEF,aAAa;MAElD/C,WAAW,CAAC,MAAM;QAChBgD,QAAQ,CAACE,mBAAmB,CAAC,WAAW,EAAEL,eAAe;QACzDG,QAAQ,CAACE,mBAAmB,CAAC,SAAS,EAAEH,aAAa;MACvD,CAAC;IACH,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}