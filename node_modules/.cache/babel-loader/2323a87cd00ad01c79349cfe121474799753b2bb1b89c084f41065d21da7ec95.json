{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array-buffer.detached.js\";\nimport \"core-js/modules/es.array-buffer.transfer.js\";\nimport \"core-js/modules/es.array-buffer.transfer-to-fixed-length.js\";\nimport \"core-js/modules/es.typed-array.with.js\";\nimport \"core-js/modules/esnext.uint8-array.set-from-base64.js\";\nimport \"core-js/modules/esnext.uint8-array.set-from-hex.js\";\nimport \"core-js/modules/esnext.uint8-array.to-base64.js\";\nimport \"core-js/modules/esnext.uint8-array.to-hex.js\";\n// ASF Objects\nimport * as Token from 'token-types';\nimport * as util from '../common/Util.js';\nimport GUID from './GUID.js';\nimport { getParserForAttr, parseUnicodeAttr } from './AsfUtil.js';\nimport { AttachedPictureType } from '../id3v2/ID3v2Token.js';\nimport { makeUnexpectedFileContentError } from '../ParseError.js';\nexport class AsfContentParseError extends makeUnexpectedFileContentError('ASF') {}\n/**\r\n * Data Type: Specifies the type of information being stored. The following values are recognized.\r\n */\nexport const DataType = {\n  /**\r\n   * Unicode string. The data consists of a sequence of Unicode characters.\r\n   */\n  UnicodeString: 0,\n  /**\r\n   * BYTE array. The type of data is implementation-specific.\r\n   */\n  ByteArray: 1,\n  /**\r\n   * BOOL. The data is 2 bytes long and should be interpreted as a 16-bit unsigned integer. Only 0x0000 or 0x0001 are permitted values.\r\n   */\n  Bool: 2,\n  /**\r\n   * DWORD. The data is 4 bytes long and should be interpreted as a 32-bit unsigned integer.\r\n   */\n  DWord: 3,\n  /**\r\n   * QWORD. The data is 8 bytes long and should be interpreted as a 64-bit unsigned integer.\r\n   */\n  QWord: 4,\n  /**\r\n   * WORD. The data is 2 bytes long and should be interpreted as a 16-bit unsigned integer.\r\n   */\n  Word: 5\n};\n/**\r\n * Token for: 3. ASF top-level Header Object\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/03_asf_top_level_header_object.html#3\r\n */\nexport const TopLevelHeaderObjectToken = {\n  len: 30,\n  get: (buf, off) => {\n    return {\n      objectId: GUID.fromBin(buf, off),\n      objectSize: Number(Token.UINT64_LE.get(buf, off + 16)),\n      numberOfHeaderObjects: Token.UINT32_LE.get(buf, off + 24)\n      // Reserved: 2 bytes\n    };\n  }\n};\n/**\r\n * Token for: 3.1 Header Object (mandatory, one only)\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/03_asf_top_level_header_object.html#3_1\r\n */\nexport const HeaderObjectToken = {\n  len: 24,\n  get: (buf, off) => {\n    return {\n      objectId: GUID.fromBin(buf, off),\n      objectSize: Number(Token.UINT64_LE.get(buf, off + 16))\n    };\n  }\n};\nexport class State {\n  constructor(header) {\n    this.len = Number(header.objectSize) - HeaderObjectToken.len;\n  }\n  postProcessTag(tags, name, valueType, data) {\n    if (name === 'WM/Picture') {\n      tags.push({\n        id: name,\n        value: WmPictureToken.fromBuffer(data)\n      });\n    } else {\n      const parseAttr = getParserForAttr(valueType);\n      if (!parseAttr) {\n        throw new AsfContentParseError(`unexpected value headerType: ${valueType}`);\n      }\n      tags.push({\n        id: name,\n        value: parseAttr(data)\n      });\n    }\n  }\n}\n// ToDo: use ignore type\nexport class IgnoreObjectState extends State {\n  get(_buf, _off) {\n    return null;\n  }\n}\n/**\r\n * Token for: 3.2: File Properties Object (mandatory, one only)\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/03_asf_top_level_header_object.html#3_2\r\n */\nexport class FilePropertiesObject extends State {\n  get(buf, off) {\n    return {\n      fileId: GUID.fromBin(buf, off),\n      fileSize: Token.UINT64_LE.get(buf, off + 16),\n      creationDate: Token.UINT64_LE.get(buf, off + 24),\n      dataPacketsCount: Token.UINT64_LE.get(buf, off + 32),\n      playDuration: Token.UINT64_LE.get(buf, off + 40),\n      sendDuration: Token.UINT64_LE.get(buf, off + 48),\n      preroll: Token.UINT64_LE.get(buf, off + 56),\n      flags: {\n        broadcast: util.getBit(buf, off + 64, 24),\n        seekable: util.getBit(buf, off + 64, 25)\n      },\n      // flagsNumeric: Token.UINT32_LE.get(buf, off + 64),\n      minimumDataPacketSize: Token.UINT32_LE.get(buf, off + 68),\n      maximumDataPacketSize: Token.UINT32_LE.get(buf, off + 72),\n      maximumBitrate: Token.UINT32_LE.get(buf, off + 76)\n    };\n  }\n}\nFilePropertiesObject.guid = GUID.FilePropertiesObject;\n/**\r\n * Token for: 3.3 Stream Properties Object (mandatory, one per stream)\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/03_asf_top_level_header_object.html#3_3\r\n */\nexport class StreamPropertiesObject extends State {\n  get(buf, off) {\n    return {\n      streamType: GUID.decodeMediaType(GUID.fromBin(buf, off)),\n      errorCorrectionType: GUID.fromBin(buf, off + 8)\n      // ToDo\n    };\n  }\n}\nStreamPropertiesObject.guid = GUID.StreamPropertiesObject;\n/**\r\n * 3.4: Header Extension Object (mandatory, one only)\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/03_asf_top_level_header_object.html#3_4\r\n */\nexport class HeaderExtensionObject {\n  constructor() {\n    this.len = 22;\n  }\n  get(buf, off) {\n    const view = new DataView(buf.buffer, off);\n    return {\n      reserved1: GUID.fromBin(buf, off),\n      reserved2: view.getUint16(16, true),\n      extensionDataSize: view.getUint16(18, true)\n    };\n  }\n}\nHeaderExtensionObject.guid = GUID.HeaderExtensionObject;\n/**\r\n * 3.5: The Codec List Object provides user-friendly information about the codecs and formats used to encode the content found in the ASF file.\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/03_asf_top_level_header_object.html#3_5\r\n */\nconst CodecListObjectHeader = {\n  len: 20,\n  get: (buf, off) => {\n    const view = new DataView(buf.buffer, off);\n    return {\n      entryCount: view.getUint16(16, true)\n    };\n  }\n};\nasync function readString(tokenizer) {\n  const length = await tokenizer.readNumber(Token.UINT16_LE);\n  return (await tokenizer.readToken(new Token.StringType(length * 2, 'utf-16le'))).replace('\\0', '');\n}\n/**\r\n * 3.5: Read the Codec-List-Object, which provides user-friendly information about the codecs and formats used to encode the content found in the ASF file.\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/03_asf_top_level_header_object.html#3_5\r\n */\nexport async function readCodecEntries(tokenizer) {\n  const codecHeader = await tokenizer.readToken(CodecListObjectHeader);\n  const entries = [];\n  for (let i = 0; i < codecHeader.entryCount; ++i) {\n    entries.push(await readCodecEntry(tokenizer));\n  }\n  return entries;\n}\nasync function readInformation(tokenizer) {\n  const length = await tokenizer.readNumber(Token.UINT16_LE);\n  const buf = new Uint8Array(length);\n  await tokenizer.readBuffer(buf);\n  return buf;\n}\n/**\r\n * Read Codec-Entries\r\n * @param tokenizer\r\n */\nasync function readCodecEntry(tokenizer) {\n  const type = await tokenizer.readNumber(Token.UINT16_LE);\n  return {\n    type: {\n      videoCodec: (type & 0x0001) === 0x0001,\n      audioCodec: (type & 0x0002) === 0x0002\n    },\n    codecName: await readString(tokenizer),\n    description: await readString(tokenizer),\n    information: await readInformation(tokenizer)\n  };\n}\n/**\r\n * 3.10 Content Description Object (optional, one only)\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/03_asf_top_level_header_object.html#3_10\r\n */\nexport class ContentDescriptionObjectState extends State {\n  get(buf, off) {\n    const tags = [];\n    const view = new DataView(buf.buffer, off);\n    let pos = 10;\n    for (let i = 0; i < ContentDescriptionObjectState.contentDescTags.length; ++i) {\n      const length = view.getUint16(i * 2, true);\n      if (length > 0) {\n        const tagName = ContentDescriptionObjectState.contentDescTags[i];\n        const end = pos + length;\n        tags.push({\n          id: tagName,\n          value: parseUnicodeAttr(buf.subarray(off + pos, off + end))\n        });\n        pos = end;\n      }\n    }\n    return tags;\n  }\n}\nContentDescriptionObjectState.guid = GUID.ContentDescriptionObject;\nContentDescriptionObjectState.contentDescTags = ['Title', 'Author', 'Copyright', 'Description', 'Rating'];\n/**\r\n * 3.11 Extended Content Description Object (optional, one only)\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/03_asf_top_level_header_object.html#3_11\r\n */\nexport class ExtendedContentDescriptionObjectState extends State {\n  get(buf, off) {\n    const tags = [];\n    const view = new DataView(buf.buffer, off);\n    const attrCount = view.getUint16(0, true);\n    let pos = 2;\n    for (let i = 0; i < attrCount; i += 1) {\n      const nameLen = view.getUint16(pos, true);\n      pos += 2;\n      const name = parseUnicodeAttr(buf.subarray(off + pos, off + pos + nameLen));\n      pos += nameLen;\n      const valueType = view.getUint16(pos, true);\n      pos += 2;\n      const valueLen = view.getUint16(pos, true);\n      pos += 2;\n      const value = buf.subarray(off + pos, off + pos + valueLen);\n      pos += valueLen;\n      this.postProcessTag(tags, name, valueType, value);\n    }\n    return tags;\n  }\n}\nExtendedContentDescriptionObjectState.guid = GUID.ExtendedContentDescriptionObject;\n/**\r\n * 4.1 Extended Stream Properties Object (optional, 1 per media stream)\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/04_objects_in_the_asf_header_extension_object.html#4_1\r\n */\nexport class ExtendedStreamPropertiesObjectState extends State {\n  get(buf, off) {\n    const view = new DataView(buf.buffer, off);\n    return {\n      startTime: Token.UINT64_LE.get(buf, off),\n      endTime: Token.UINT64_LE.get(buf, off + 8),\n      dataBitrate: view.getInt32(12, true),\n      bufferSize: view.getInt32(16, true),\n      initialBufferFullness: view.getInt32(20, true),\n      alternateDataBitrate: view.getInt32(24, true),\n      alternateBufferSize: view.getInt32(28, true),\n      alternateInitialBufferFullness: view.getInt32(32, true),\n      maximumObjectSize: view.getInt32(36, true),\n      flags: {\n        reliableFlag: util.getBit(buf, off + 40, 0),\n        seekableFlag: util.getBit(buf, off + 40, 1),\n        resendLiveCleanpointsFlag: util.getBit(buf, off + 40, 2)\n      },\n      // flagsNumeric: Token.UINT32_LE.get(buf, off + 64),\n      streamNumber: view.getInt16(42, true),\n      streamLanguageId: view.getInt16(44, true),\n      averageTimePerFrame: view.getInt32(52, true),\n      streamNameCount: view.getInt32(54, true),\n      payloadExtensionSystems: view.getInt32(56, true),\n      streamNames: [],\n      // ToDo\n      streamPropertiesObject: null\n    };\n  }\n}\nExtendedStreamPropertiesObjectState.guid = GUID.ExtendedStreamPropertiesObject;\n/**\r\n * 4.7  Metadata Object (optional, 0 or 1)\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/04_objects_in_the_asf_header_extension_object.html#4_7\r\n */\nexport class MetadataObjectState extends State {\n  get(uint8Array, off) {\n    const tags = [];\n    const view = new DataView(uint8Array.buffer, off);\n    const descriptionRecordsCount = view.getUint16(0, true);\n    let pos = 2;\n    for (let i = 0; i < descriptionRecordsCount; i += 1) {\n      pos += 4;\n      const nameLen = view.getUint16(pos, true);\n      pos += 2;\n      const dataType = view.getUint16(pos, true);\n      pos += 2;\n      const dataLen = view.getUint32(pos, true);\n      pos += 4;\n      const name = parseUnicodeAttr(uint8Array.subarray(off + pos, off + pos + nameLen));\n      pos += nameLen;\n      const data = uint8Array.subarray(off + pos, off + pos + dataLen);\n      pos += dataLen;\n      this.postProcessTag(tags, name, dataType, data);\n    }\n    return tags;\n  }\n}\nMetadataObjectState.guid = GUID.MetadataObject;\n// 4.8\tMetadata Library Object (optional, 0 or 1)\nexport class MetadataLibraryObjectState extends MetadataObjectState {}\nMetadataLibraryObjectState.guid = GUID.MetadataLibraryObject;\n/**\r\n * Ref: https://msdn.microsoft.com/en-us/library/windows/desktop/dd757977(v=vs.85).aspx\r\n */\nexport class WmPictureToken {\n  static fromBuffer(buffer) {\n    const pic = new WmPictureToken(buffer.length);\n    return pic.get(buffer, 0);\n  }\n  constructor(len) {\n    this.len = len;\n  }\n  get(buffer, offset) {\n    const view = new DataView(buffer.buffer, offset);\n    const typeId = view.getUint8(0);\n    const size = view.getInt32(1, true);\n    let index = 5;\n    while (view.getUint16(index) !== 0) {\n      index += 2;\n    }\n    const format = new Token.StringType(index - 5, 'utf-16le').get(buffer, 5);\n    while (view.getUint16(index) !== 0) {\n      index += 2;\n    }\n    const description = new Token.StringType(index - 5, 'utf-16le').get(buffer, 5);\n    return {\n      type: AttachedPictureType[typeId],\n      format,\n      description,\n      size,\n      data: buffer.slice(index + 4)\n    };\n  }\n}","map":{"version":3,"names":["Token","util","GUID","getParserForAttr","parseUnicodeAttr","AttachedPictureType","makeUnexpectedFileContentError","AsfContentParseError","DataType","UnicodeString","ByteArray","Bool","DWord","QWord","Word","TopLevelHeaderObjectToken","len","get","buf","off","objectId","fromBin","objectSize","Number","UINT64_LE","numberOfHeaderObjects","UINT32_LE","HeaderObjectToken","State","constructor","header","postProcessTag","tags","name","valueType","data","push","id","value","WmPictureToken","fromBuffer","parseAttr","IgnoreObjectState","_buf","_off","FilePropertiesObject","fileId","fileSize","creationDate","dataPacketsCount","playDuration","sendDuration","preroll","flags","broadcast","getBit","seekable","minimumDataPacketSize","maximumDataPacketSize","maximumBitrate","guid","StreamPropertiesObject","streamType","decodeMediaType","errorCorrectionType","HeaderExtensionObject","view","DataView","buffer","reserved1","reserved2","getUint16","extensionDataSize","CodecListObjectHeader","entryCount","readString","tokenizer","length","readNumber","UINT16_LE","readToken","StringType","replace","readCodecEntries","codecHeader","entries","i","readCodecEntry","readInformation","Uint8Array","readBuffer","type","videoCodec","audioCodec","codecName","description","information","ContentDescriptionObjectState","pos","contentDescTags","tagName","end","subarray","ContentDescriptionObject","ExtendedContentDescriptionObjectState","attrCount","nameLen","valueLen","ExtendedContentDescriptionObject","ExtendedStreamPropertiesObjectState","startTime","endTime","dataBitrate","getInt32","bufferSize","initialBufferFullness","alternateDataBitrate","alternateBufferSize","alternateInitialBufferFullness","maximumObjectSize","reliableFlag","seekableFlag","resendLiveCleanpointsFlag","streamNumber","getInt16","streamLanguageId","averageTimePerFrame","streamNameCount","payloadExtensionSystems","streamNames","streamPropertiesObject","ExtendedStreamPropertiesObject","MetadataObjectState","uint8Array","descriptionRecordsCount","dataType","dataLen","getUint32","MetadataObject","MetadataLibraryObjectState","MetadataLibraryObject","pic","offset","typeId","getUint8","size","index","format","slice"],"sources":["C:/projects/My projects/Vue/osi/node_modules/music-metadata/lib/asf/AsfObject.js"],"sourcesContent":["// ASF Objects\r\nimport * as Token from 'token-types';\r\nimport * as util from '../common/Util.js';\r\nimport GUID from './GUID.js';\r\nimport { getParserForAttr, parseUnicodeAttr } from './AsfUtil.js';\r\nimport { AttachedPictureType } from '../id3v2/ID3v2Token.js';\r\nimport { makeUnexpectedFileContentError } from '../ParseError.js';\r\nexport class AsfContentParseError extends makeUnexpectedFileContentError('ASF') {\r\n}\r\n/**\r\n * Data Type: Specifies the type of information being stored. The following values are recognized.\r\n */\r\nexport const DataType = {\r\n    /**\r\n     * Unicode string. The data consists of a sequence of Unicode characters.\r\n     */\r\n    UnicodeString: 0,\r\n    /**\r\n     * BYTE array. The type of data is implementation-specific.\r\n     */\r\n    ByteArray: 1,\r\n    /**\r\n     * BOOL. The data is 2 bytes long and should be interpreted as a 16-bit unsigned integer. Only 0x0000 or 0x0001 are permitted values.\r\n     */\r\n    Bool: 2,\r\n    /**\r\n     * DWORD. The data is 4 bytes long and should be interpreted as a 32-bit unsigned integer.\r\n     */\r\n    DWord: 3,\r\n    /**\r\n     * QWORD. The data is 8 bytes long and should be interpreted as a 64-bit unsigned integer.\r\n     */\r\n    QWord: 4,\r\n    /**\r\n     * WORD. The data is 2 bytes long and should be interpreted as a 16-bit unsigned integer.\r\n     */\r\n    Word: 5\r\n};\r\n/**\r\n * Token for: 3. ASF top-level Header Object\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/03_asf_top_level_header_object.html#3\r\n */\r\nexport const TopLevelHeaderObjectToken = {\r\n    len: 30,\r\n    get: (buf, off) => {\r\n        return {\r\n            objectId: GUID.fromBin(buf, off),\r\n            objectSize: Number(Token.UINT64_LE.get(buf, off + 16)),\r\n            numberOfHeaderObjects: Token.UINT32_LE.get(buf, off + 24)\r\n            // Reserved: 2 bytes\r\n        };\r\n    }\r\n};\r\n/**\r\n * Token for: 3.1 Header Object (mandatory, one only)\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/03_asf_top_level_header_object.html#3_1\r\n */\r\nexport const HeaderObjectToken = {\r\n    len: 24,\r\n    get: (buf, off) => {\r\n        return {\r\n            objectId: GUID.fromBin(buf, off),\r\n            objectSize: Number(Token.UINT64_LE.get(buf, off + 16))\r\n        };\r\n    }\r\n};\r\nexport class State {\r\n    constructor(header) {\r\n        this.len = Number(header.objectSize) - HeaderObjectToken.len;\r\n    }\r\n    postProcessTag(tags, name, valueType, data) {\r\n        if (name === 'WM/Picture') {\r\n            tags.push({ id: name, value: WmPictureToken.fromBuffer(data) });\r\n        }\r\n        else {\r\n            const parseAttr = getParserForAttr(valueType);\r\n            if (!parseAttr) {\r\n                throw new AsfContentParseError(`unexpected value headerType: ${valueType}`);\r\n            }\r\n            tags.push({ id: name, value: parseAttr(data) });\r\n        }\r\n    }\r\n}\r\n// ToDo: use ignore type\r\nexport class IgnoreObjectState extends State {\r\n    get(_buf, _off) {\r\n        return null;\r\n    }\r\n}\r\n/**\r\n * Token for: 3.2: File Properties Object (mandatory, one only)\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/03_asf_top_level_header_object.html#3_2\r\n */\r\nexport class FilePropertiesObject extends State {\r\n    get(buf, off) {\r\n        return {\r\n            fileId: GUID.fromBin(buf, off),\r\n            fileSize: Token.UINT64_LE.get(buf, off + 16),\r\n            creationDate: Token.UINT64_LE.get(buf, off + 24),\r\n            dataPacketsCount: Token.UINT64_LE.get(buf, off + 32),\r\n            playDuration: Token.UINT64_LE.get(buf, off + 40),\r\n            sendDuration: Token.UINT64_LE.get(buf, off + 48),\r\n            preroll: Token.UINT64_LE.get(buf, off + 56),\r\n            flags: {\r\n                broadcast: util.getBit(buf, off + 64, 24),\r\n                seekable: util.getBit(buf, off + 64, 25)\r\n            },\r\n            // flagsNumeric: Token.UINT32_LE.get(buf, off + 64),\r\n            minimumDataPacketSize: Token.UINT32_LE.get(buf, off + 68),\r\n            maximumDataPacketSize: Token.UINT32_LE.get(buf, off + 72),\r\n            maximumBitrate: Token.UINT32_LE.get(buf, off + 76)\r\n        };\r\n    }\r\n}\r\nFilePropertiesObject.guid = GUID.FilePropertiesObject;\r\n/**\r\n * Token for: 3.3 Stream Properties Object (mandatory, one per stream)\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/03_asf_top_level_header_object.html#3_3\r\n */\r\nexport class StreamPropertiesObject extends State {\r\n    get(buf, off) {\r\n        return {\r\n            streamType: GUID.decodeMediaType(GUID.fromBin(buf, off)),\r\n            errorCorrectionType: GUID.fromBin(buf, off + 8)\r\n            // ToDo\r\n        };\r\n    }\r\n}\r\nStreamPropertiesObject.guid = GUID.StreamPropertiesObject;\r\n/**\r\n * 3.4: Header Extension Object (mandatory, one only)\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/03_asf_top_level_header_object.html#3_4\r\n */\r\nexport class HeaderExtensionObject {\r\n    constructor() {\r\n        this.len = 22;\r\n    }\r\n    get(buf, off) {\r\n        const view = new DataView(buf.buffer, off);\r\n        return {\r\n            reserved1: GUID.fromBin(buf, off),\r\n            reserved2: view.getUint16(16, true),\r\n            extensionDataSize: view.getUint16(18, true)\r\n        };\r\n    }\r\n}\r\nHeaderExtensionObject.guid = GUID.HeaderExtensionObject;\r\n/**\r\n * 3.5: The Codec List Object provides user-friendly information about the codecs and formats used to encode the content found in the ASF file.\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/03_asf_top_level_header_object.html#3_5\r\n */\r\nconst CodecListObjectHeader = {\r\n    len: 20,\r\n    get: (buf, off) => {\r\n        const view = new DataView(buf.buffer, off);\r\n        return {\r\n            entryCount: view.getUint16(16, true)\r\n        };\r\n    }\r\n};\r\nasync function readString(tokenizer) {\r\n    const length = await tokenizer.readNumber(Token.UINT16_LE);\r\n    return (await tokenizer.readToken(new Token.StringType(length * 2, 'utf-16le'))).replace('\\0', '');\r\n}\r\n/**\r\n * 3.5: Read the Codec-List-Object, which provides user-friendly information about the codecs and formats used to encode the content found in the ASF file.\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/03_asf_top_level_header_object.html#3_5\r\n */\r\nexport async function readCodecEntries(tokenizer) {\r\n    const codecHeader = await tokenizer.readToken(CodecListObjectHeader);\r\n    const entries = [];\r\n    for (let i = 0; i < codecHeader.entryCount; ++i) {\r\n        entries.push(await readCodecEntry(tokenizer));\r\n    }\r\n    return entries;\r\n}\r\nasync function readInformation(tokenizer) {\r\n    const length = await tokenizer.readNumber(Token.UINT16_LE);\r\n    const buf = new Uint8Array(length);\r\n    await tokenizer.readBuffer(buf);\r\n    return buf;\r\n}\r\n/**\r\n * Read Codec-Entries\r\n * @param tokenizer\r\n */\r\nasync function readCodecEntry(tokenizer) {\r\n    const type = await tokenizer.readNumber(Token.UINT16_LE);\r\n    return {\r\n        type: {\r\n            videoCodec: (type & 0x0001) === 0x0001,\r\n            audioCodec: (type & 0x0002) === 0x0002\r\n        },\r\n        codecName: await readString(tokenizer),\r\n        description: await readString(tokenizer),\r\n        information: await readInformation(tokenizer)\r\n    };\r\n}\r\n/**\r\n * 3.10 Content Description Object (optional, one only)\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/03_asf_top_level_header_object.html#3_10\r\n */\r\nexport class ContentDescriptionObjectState extends State {\r\n    get(buf, off) {\r\n        const tags = [];\r\n        const view = new DataView(buf.buffer, off);\r\n        let pos = 10;\r\n        for (let i = 0; i < ContentDescriptionObjectState.contentDescTags.length; ++i) {\r\n            const length = view.getUint16(i * 2, true);\r\n            if (length > 0) {\r\n                const tagName = ContentDescriptionObjectState.contentDescTags[i];\r\n                const end = pos + length;\r\n                tags.push({ id: tagName, value: parseUnicodeAttr(buf.subarray(off + pos, off + end)) });\r\n                pos = end;\r\n            }\r\n        }\r\n        return tags;\r\n    }\r\n}\r\nContentDescriptionObjectState.guid = GUID.ContentDescriptionObject;\r\nContentDescriptionObjectState.contentDescTags = ['Title', 'Author', 'Copyright', 'Description', 'Rating'];\r\n/**\r\n * 3.11 Extended Content Description Object (optional, one only)\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/03_asf_top_level_header_object.html#3_11\r\n */\r\nexport class ExtendedContentDescriptionObjectState extends State {\r\n    get(buf, off) {\r\n        const tags = [];\r\n        const view = new DataView(buf.buffer, off);\r\n        const attrCount = view.getUint16(0, true);\r\n        let pos = 2;\r\n        for (let i = 0; i < attrCount; i += 1) {\r\n            const nameLen = view.getUint16(pos, true);\r\n            pos += 2;\r\n            const name = parseUnicodeAttr(buf.subarray(off + pos, off + pos + nameLen));\r\n            pos += nameLen;\r\n            const valueType = view.getUint16(pos, true);\r\n            pos += 2;\r\n            const valueLen = view.getUint16(pos, true);\r\n            pos += 2;\r\n            const value = buf.subarray(off + pos, off + pos + valueLen);\r\n            pos += valueLen;\r\n            this.postProcessTag(tags, name, valueType, value);\r\n        }\r\n        return tags;\r\n    }\r\n}\r\nExtendedContentDescriptionObjectState.guid = GUID.ExtendedContentDescriptionObject;\r\n/**\r\n * 4.1 Extended Stream Properties Object (optional, 1 per media stream)\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/04_objects_in_the_asf_header_extension_object.html#4_1\r\n */\r\nexport class ExtendedStreamPropertiesObjectState extends State {\r\n    get(buf, off) {\r\n        const view = new DataView(buf.buffer, off);\r\n        return {\r\n            startTime: Token.UINT64_LE.get(buf, off),\r\n            endTime: Token.UINT64_LE.get(buf, off + 8),\r\n            dataBitrate: view.getInt32(12, true),\r\n            bufferSize: view.getInt32(16, true),\r\n            initialBufferFullness: view.getInt32(20, true),\r\n            alternateDataBitrate: view.getInt32(24, true),\r\n            alternateBufferSize: view.getInt32(28, true),\r\n            alternateInitialBufferFullness: view.getInt32(32, true),\r\n            maximumObjectSize: view.getInt32(36, true),\r\n            flags: {\r\n                reliableFlag: util.getBit(buf, off + 40, 0),\r\n                seekableFlag: util.getBit(buf, off + 40, 1),\r\n                resendLiveCleanpointsFlag: util.getBit(buf, off + 40, 2)\r\n            },\r\n            // flagsNumeric: Token.UINT32_LE.get(buf, off + 64),\r\n            streamNumber: view.getInt16(42, true),\r\n            streamLanguageId: view.getInt16(44, true),\r\n            averageTimePerFrame: view.getInt32(52, true),\r\n            streamNameCount: view.getInt32(54, true),\r\n            payloadExtensionSystems: view.getInt32(56, true),\r\n            streamNames: [], // ToDo\r\n            streamPropertiesObject: null\r\n        };\r\n    }\r\n}\r\nExtendedStreamPropertiesObjectState.guid = GUID.ExtendedStreamPropertiesObject;\r\n/**\r\n * 4.7  Metadata Object (optional, 0 or 1)\r\n * Ref: http://drang.s4.xrea.com/program/tips/id3tag/wmp/04_objects_in_the_asf_header_extension_object.html#4_7\r\n */\r\nexport class MetadataObjectState extends State {\r\n    get(uint8Array, off) {\r\n        const tags = [];\r\n        const view = new DataView(uint8Array.buffer, off);\r\n        const descriptionRecordsCount = view.getUint16(0, true);\r\n        let pos = 2;\r\n        for (let i = 0; i < descriptionRecordsCount; i += 1) {\r\n            pos += 4;\r\n            const nameLen = view.getUint16(pos, true);\r\n            pos += 2;\r\n            const dataType = view.getUint16(pos, true);\r\n            pos += 2;\r\n            const dataLen = view.getUint32(pos, true);\r\n            pos += 4;\r\n            const name = parseUnicodeAttr(uint8Array.subarray(off + pos, off + pos + nameLen));\r\n            pos += nameLen;\r\n            const data = uint8Array.subarray(off + pos, off + pos + dataLen);\r\n            pos += dataLen;\r\n            this.postProcessTag(tags, name, dataType, data);\r\n        }\r\n        return tags;\r\n    }\r\n}\r\nMetadataObjectState.guid = GUID.MetadataObject;\r\n// 4.8\tMetadata Library Object (optional, 0 or 1)\r\nexport class MetadataLibraryObjectState extends MetadataObjectState {\r\n}\r\nMetadataLibraryObjectState.guid = GUID.MetadataLibraryObject;\r\n/**\r\n * Ref: https://msdn.microsoft.com/en-us/library/windows/desktop/dd757977(v=vs.85).aspx\r\n */\r\nexport class WmPictureToken {\r\n    static fromBuffer(buffer) {\r\n        const pic = new WmPictureToken(buffer.length);\r\n        return pic.get(buffer, 0);\r\n    }\r\n    constructor(len) {\r\n        this.len = len;\r\n    }\r\n    get(buffer, offset) {\r\n        const view = new DataView(buffer.buffer, offset);\r\n        const typeId = view.getUint8(0);\r\n        const size = view.getInt32(1, true);\r\n        let index = 5;\r\n        while (view.getUint16(index) !== 0) {\r\n            index += 2;\r\n        }\r\n        const format = new Token.StringType(index - 5, 'utf-16le').get(buffer, 5);\r\n        while (view.getUint16(index) !== 0) {\r\n            index += 2;\r\n        }\r\n        const description = new Token.StringType(index - 5, 'utf-16le').get(buffer, 5);\r\n        return {\r\n            type: AttachedPictureType[typeId],\r\n            format,\r\n            description,\r\n            size,\r\n            data: buffer.slice(index + 4)\r\n        };\r\n    }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}