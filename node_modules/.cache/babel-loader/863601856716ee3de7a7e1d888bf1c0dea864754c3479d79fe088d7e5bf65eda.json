{"ast":null,"code":"import \"core-js/modules/es.array-buffer.detached.js\";\nimport \"core-js/modules/es.array-buffer.transfer.js\";\nimport \"core-js/modules/es.array-buffer.transfer-to-fixed-length.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/es.typed-array.with.js\";\nimport \"core-js/modules/esnext.uint8-array.set-from-base64.js\";\nimport \"core-js/modules/esnext.uint8-array.set-from-hex.js\";\nimport \"core-js/modules/esnext.uint8-array.to-base64.js\";\nimport \"core-js/modules/esnext.uint8-array.to-hex.js\";\nimport * as Token from 'token-types';\nimport * as util from '../common/Util.js';\nimport { ExtendedLameHeader } from './ExtendedLameHeader.js';\n/**\n * Info Tag: Xing, LAME\n */\nexport const InfoTagHeaderTag = new Token.StringType(4, 'ascii');\n/**\n * LAME TAG value\n * Did not find any official documentation for this\n * Value e.g.: \"3.98.4\"\n */\nexport const LameEncoderVersion = new Token.StringType(6, 'ascii');\n/**\n * Info Tag\n * Ref: http://gabriel.mp3-tech.org/mp3infotag.html\n */\nexport const XingHeaderFlags = {\n  len: 4,\n  get: (buf, off) => {\n    return {\n      frames: util.isBitSet(buf, off, 31),\n      bytes: util.isBitSet(buf, off, 30),\n      toc: util.isBitSet(buf, off, 29),\n      vbrScale: util.isBitSet(buf, off, 28)\n    };\n  }\n};\n// /**\n//  * XING Header Tag\n//  * Ref: http://gabriel.mp3-tech.org/mp3infotag.html\n//  */\nexport async function readXingHeader(tokenizer) {\n  const flags = await tokenizer.readToken(XingHeaderFlags);\n  const xingInfoTag = {\n    numFrames: null,\n    streamSize: null,\n    vbrScale: null\n  };\n  if (flags.frames) {\n    xingInfoTag.numFrames = await tokenizer.readToken(Token.UINT32_BE);\n  }\n  if (flags.bytes) {\n    xingInfoTag.streamSize = await tokenizer.readToken(Token.UINT32_BE);\n  }\n  if (flags.toc) {\n    xingInfoTag.toc = new Uint8Array(100);\n    await tokenizer.readBuffer(xingInfoTag.toc);\n  }\n  if (flags.vbrScale) {\n    xingInfoTag.vbrScale = await tokenizer.readToken(Token.UINT32_BE);\n  }\n  const lameTag = await tokenizer.peekToken(new Token.StringType(4, 'ascii'));\n  if (lameTag === 'LAME') {\n    await tokenizer.ignore(4);\n    xingInfoTag.lame = {\n      version: await tokenizer.readToken(new Token.StringType(5, 'ascii'))\n    };\n    const match = xingInfoTag.lame.version.match(/\\d+.\\d+/g);\n    if (match !== null) {\n      const majorMinorVersion = match[0]; // e.g. 3.97\n      const version = majorMinorVersion.split('.').map(n => Number.parseInt(n, 10));\n      if (version[0] >= 3 && version[1] >= 90) {\n        xingInfoTag.lame.extended = await tokenizer.readToken(ExtendedLameHeader);\n      }\n    }\n  }\n  return xingInfoTag;\n}","map":{"version":3,"names":["Token","util","ExtendedLameHeader","InfoTagHeaderTag","StringType","LameEncoderVersion","XingHeaderFlags","len","get","buf","off","frames","isBitSet","bytes","toc","vbrScale","readXingHeader","tokenizer","flags","readToken","xingInfoTag","numFrames","streamSize","UINT32_BE","Uint8Array","readBuffer","lameTag","peekToken","ignore","lame","version","match","majorMinorVersion","split","map","n","Number","parseInt","extended"],"sources":["/home/kup/my_projects/vue/osi/node_modules/music-metadata/lib/mpeg/XingTag.js"],"sourcesContent":["import * as Token from 'token-types';\nimport * as util from '../common/Util.js';\nimport { ExtendedLameHeader } from './ExtendedLameHeader.js';\n/**\n * Info Tag: Xing, LAME\n */\nexport const InfoTagHeaderTag = new Token.StringType(4, 'ascii');\n/**\n * LAME TAG value\n * Did not find any official documentation for this\n * Value e.g.: \"3.98.4\"\n */\nexport const LameEncoderVersion = new Token.StringType(6, 'ascii');\n/**\n * Info Tag\n * Ref: http://gabriel.mp3-tech.org/mp3infotag.html\n */\nexport const XingHeaderFlags = {\n    len: 4,\n    get: (buf, off) => {\n        return {\n            frames: util.isBitSet(buf, off, 31),\n            bytes: util.isBitSet(buf, off, 30),\n            toc: util.isBitSet(buf, off, 29),\n            vbrScale: util.isBitSet(buf, off, 28)\n        };\n    }\n};\n// /**\n//  * XING Header Tag\n//  * Ref: http://gabriel.mp3-tech.org/mp3infotag.html\n//  */\nexport async function readXingHeader(tokenizer) {\n    const flags = await tokenizer.readToken(XingHeaderFlags);\n    const xingInfoTag = { numFrames: null, streamSize: null, vbrScale: null };\n    if (flags.frames) {\n        xingInfoTag.numFrames = await tokenizer.readToken(Token.UINT32_BE);\n    }\n    if (flags.bytes) {\n        xingInfoTag.streamSize = await tokenizer.readToken(Token.UINT32_BE);\n    }\n    if (flags.toc) {\n        xingInfoTag.toc = new Uint8Array(100);\n        await tokenizer.readBuffer(xingInfoTag.toc);\n    }\n    if (flags.vbrScale) {\n        xingInfoTag.vbrScale = await tokenizer.readToken(Token.UINT32_BE);\n    }\n    const lameTag = await tokenizer.peekToken(new Token.StringType(4, 'ascii'));\n    if (lameTag === 'LAME') {\n        await tokenizer.ignore(4);\n        xingInfoTag.lame = {\n            version: await tokenizer.readToken(new Token.StringType(5, 'ascii'))\n        };\n        const match = xingInfoTag.lame.version.match(/\\d+.\\d+/g);\n        if (match !== null) {\n            const majorMinorVersion = match[0]; // e.g. 3.97\n            const version = majorMinorVersion.split('.').map(n => Number.parseInt(n, 10));\n            if (version[0] >= 3 && version[1] >= 90) {\n                xingInfoTag.lame.extended = await tokenizer.readToken(ExtendedLameHeader);\n            }\n        }\n    }\n    return xingInfoTag;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}